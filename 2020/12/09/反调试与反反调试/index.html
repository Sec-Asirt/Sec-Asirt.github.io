<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>反调试&amp;反反调试 | Mr.Hu</title><meta name="description" content="概览反调试属于高级逆向技术范畴，并且涉及面异常广泛，几乎任何技术在经过精心构造后都可以变成反调试技术 反调试的核心思想就是阻拦逆向工作者分析自己的代码，如果不能从技术上彻底阻拦住分析者，也会想办法在精神层面击垮分析者 因此对于初学者，最有效的办法是使用其不了解的技术做反调试，进而拦住他。开发这种反调试的技巧的核心思想就是找调试状态与正常状态的不同点，并加以利用 而对于逆向分析的老手，则只能消耗其意"><meta name="keywords" content="反调试"><meta name="author" content="胡先森"><meta name="copyright" content="胡先森"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://yoursite.com/2020/12/09/%E5%8F%8D%E8%B0%83%E8%AF%95%E4%B8%8E%E5%8F%8D%E5%8F%8D%E8%B0%83%E8%AF%95/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="yandex-verification" content="{&quot;theme_color&quot;:{&quot;enable&quot;:true,&quot;main&quot;:&quot;#49B1F5&quot;,&quot;paginator&quot;:&quot;#00c4b6&quot;,&quot;button_hover&quot;:&quot;#FF7242&quot;,&quot;text_selection&quot;:&quot;#00c4b6&quot;,&quot;link_color&quot;:&quot;#99a9bf&quot;,&quot;meta_color&quot;:&quot;#858585&quot;,&quot;hr_color&quot;:&quot;#A4D8FA&quot;,&quot;code_foreground&quot;:&quot;#F47466&quot;,&quot;code_background&quot;:&quot;rgba(27, 31, 35, .05)&quot;,&quot;toc_color&quot;:&quot;#00c4b6&quot;,&quot;blockquote_padding_color&quot;:&quot;#49b1f5&quot;,&quot;blockquote_background_color&quot;:&quot;#49b1f5&quot;}}"/><meta property="og:type" content="article"><meta property="og:title" content="反调试&amp;反反调试"><meta property="og:url" content="http://yoursite.com/2020/12/09/%E5%8F%8D%E8%B0%83%E8%AF%95%E4%B8%8E%E5%8F%8D%E5%8F%8D%E8%B0%83%E8%AF%95/"><meta property="og:site_name" content="Mr.Hu"><meta property="og:description" content="概览反调试属于高级逆向技术范畴，并且涉及面异常广泛，几乎任何技术在经过精心构造后都可以变成反调试技术 反调试的核心思想就是阻拦逆向工作者分析自己的代码，如果不能从技术上彻底阻拦住分析者，也会想办法在精神层面击垮分析者 因此对于初学者，最有效的办法是使用其不了解的技术做反调试，进而拦住他。开发这种反调试的技巧的核心思想就是找调试状态与正常状态的不同点，并加以利用 而对于逆向分析的老手，则只能消耗其意"><meta property="og:image" content="http://yoursite.com/img/Debug2.01.jpg"><meta property="article:published_time" content="2020-12-09T11:00:02.857Z"><meta property="article:modified_time" content="2021-04-04T06:12:44.197Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: {"text":"❤富强❤,❤民主❤,❤和谐❤,❤友善❤,❤敬业❤,❤文明❤,❤自由❤,❤平等❤,❤公正❤,❤法治❤,❤爱国❤,❤诚信❤","fontSize":"15px"},
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2021-04-04 14:12:44'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img {
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 5.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" data-lazy-src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">38</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">34</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">11</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/projects/clock/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-bookmark"></i><span> 时光轴</span></a></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fas fa-archive"></i><span> 工具</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 放松</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 学习</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/projects/photo/"><i class="fa-fw fas fa-images"></i><span> 照片墙</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-film"></i><span> 游戏</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/projects/game1/"><i class="fa-fw fas fa-heart"></i><span> 保卫星球</span></a></li><li><a class="site-page" href="/projects/game2/"><i class="fa-fw fas fa-heart"></i><span> 飞字快打</span></a></li><li><a class="site-page" href="/projects/game3/"><i class="fa-fw fas fa-heart"></i><span> 俄罗斯方块</span></a></li><li><a class="site-page" href="/projects/game4/"><i class="fa-fw fas fa-heart"></i><span> 特效画笔</span></a></li><li><a class="site-page" href="/projects/game5/"><i class="fa-fw fas fa-heart"></i><span> 音速小子</span></a></li><li><a class="site-page" href="/projects/game6/"><i class="fa-fw fas fa-heart"></i><span> 植物大战僵尸</span></a></li><li><a class="site-page" href="/projects/zifuyu/"><i class="fa-fw fas fa-heart"></i><span> 字符雨</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-link"></i><span> 链接</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page" href="/projects/link/"><i class="fa-fw fas fa-link"></i><span> 网站导航</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user-circle"></i><span> 留言板</span></a></div></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A6%82%E8%A7%88"><span class="toc-number">1.</span> <span class="toc-text">概览</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E5%8F%8D%E8%B0%83%E8%AF%95"><span class="toc-number">2.</span> <span class="toc-text">静态反调试</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#PEB"><span class="toc-number">2.1.</span> <span class="toc-text">PEB</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TEB"><span class="toc-number">2.2.</span> <span class="toc-text">TEB</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%8E%9F%E5%A7%8BAPI"><span class="toc-number">2.3.</span> <span class="toc-text">使用原始API</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E8%B0%83%E8%AF%95%E5%99%A8"><span class="toc-number">2.4.</span> <span class="toc-text">攻击调试器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%93%E5%BC%80%E8%BF%9B%E7%A8%8B%E6%A3%80%E6%9F%A5"><span class="toc-number">2.5.</span> <span class="toc-text">打开进程检查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8TLS%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0"><span class="toc-number">2.6.</span> <span class="toc-text">利用TLS回调函数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E5%8F%8D%E8%B0%83%E8%AF%95"><span class="toc-number">3.</span> <span class="toc-text">动态反调试</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8SEH"><span class="toc-number">3.1.</span> <span class="toc-text">使用SEH</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E6%A3%80%E6%9F%A5"><span class="toc-number">3.2.</span> <span class="toc-text">时间检查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E6%AD%A5%E6%A3%80%E6%9F%A5"><span class="toc-number">3.3.</span> <span class="toc-text">单步检查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A5%E4%B8%81%E6%A3%80%E6%9F%A5"><span class="toc-number">3.4.</span> <span class="toc-text">补丁检查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PEB%E7%9B%B8%E5%85%B3"><span class="toc-number">3.5.</span> <span class="toc-text">PEB相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PEB-BeginDebuged"><span class="toc-number">3.5.1.</span> <span class="toc-text">PEB_BeginDebuged</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PEB-ProcessHeap"><span class="toc-number">3.5.2.</span> <span class="toc-text">PEB_ProcessHeap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PEB-NtGlobalFlag"><span class="toc-number">3.5.3.</span> <span class="toc-text">PEB_NtGlobalFlag</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NtQueryInformationProcess%E7%9B%B8%E5%85%B3"><span class="toc-number">3.6.</span> <span class="toc-text">NtQueryInformationProcess相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8TLS%E5%87%BD%E6%95%B0%E4%B8%AD%E5%8F%AF%E4%BB%A5%E5%81%9A%E5%8F%8D%E8%B0%83%E8%AF%95"><span class="toc-number">3.6.1.</span> <span class="toc-text">在TLS函数中可以做反调试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ProcessDebugPort"><span class="toc-number">3.6.2.</span> <span class="toc-text">ProcessDebugPort</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ProcessDebugObjectHandle"><span class="toc-number">3.6.3.</span> <span class="toc-text">ProcessDebugObjectHandle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ProcessDebugFlag"><span class="toc-number">3.6.4.</span> <span class="toc-text">ProcessDebugFlag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ProcessBasicInformation"><span class="toc-number">3.6.5.</span> <span class="toc-text">ProcessBasicInformation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">3.6.6.</span> <span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NtQuerySystemInformation"><span class="toc-number">3.7.</span> <span class="toc-text">NtQuerySystemInformation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E8%B0%83%E8%AF%95%E5%99%A8-1"><span class="toc-number">3.8.</span> <span class="toc-text">攻击调试器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AA%97%E5%8F%A3%E5%90%8D%E6%A3%80%E6%B5%8B"><span class="toc-number">3.9.</span> <span class="toc-text">窗口名检测</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8E%BB%E9%99%A4%E8%8A%B1%E6%8C%87%E4%BB%A4"><span class="toc-number">4.</span> <span class="toc-text">去除花指令</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%98%93%E8%AF%AD%E8%A8%80%E7%89%B9%E5%BE%81%E7%A0%81"><span class="toc-number">5.</span> <span class="toc-text">易语言特征码</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8F%92%E4%BB%B6"><span class="toc-number">6.</span> <span class="toc-text">插件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">6.1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E6%8F%92%E4%BB%B6%E7%9A%84%E7%BC%96%E5%86%99"><span class="toc-number">6.2.</span> <span class="toc-text">简单插件的编写</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OD%E6%8F%92%E4%BB%B6%E7%9A%84%E7%BC%96%E5%86%99"><span class="toc-number">6.3.</span> <span class="toc-text">OD插件的编写</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#h%E6%96%87%E4%BB%B6"><span class="toc-number">6.3.1.</span> <span class="toc-text">.h文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cpp%E6%96%87%E4%BB%B6"><span class="toc-number">6.3.2.</span> <span class="toc-text">.cpp文件</span></a></li></ol></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(/img/Debug2.01.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">Mr.Hu</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/projects/clock/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-bookmark"></i><span> 时光轴</span></a></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fas fa-archive"></i><span> 工具</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 放松</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 学习</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/projects/photo/"><i class="fa-fw fas fa-images"></i><span> 照片墙</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-film"></i><span> 游戏</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/projects/game1/"><i class="fa-fw fas fa-heart"></i><span> 保卫星球</span></a></li><li><a class="site-page" href="/projects/game2/"><i class="fa-fw fas fa-heart"></i><span> 飞字快打</span></a></li><li><a class="site-page" href="/projects/game3/"><i class="fa-fw fas fa-heart"></i><span> 俄罗斯方块</span></a></li><li><a class="site-page" href="/projects/game4/"><i class="fa-fw fas fa-heart"></i><span> 特效画笔</span></a></li><li><a class="site-page" href="/projects/game5/"><i class="fa-fw fas fa-heart"></i><span> 音速小子</span></a></li><li><a class="site-page" href="/projects/game6/"><i class="fa-fw fas fa-heart"></i><span> 植物大战僵尸</span></a></li><li><a class="site-page" href="/projects/zifuyu/"><i class="fa-fw fas fa-heart"></i><span> 字符雨</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-link"></i><span> 链接</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page" href="/projects/link/"><i class="fa-fw fas fa-link"></i><span> 网站导航</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user-circle"></i><span> 留言板</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">反调试&amp;反反调试</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-12-09T11:00:02.857Z" title="发表于 2020-12-09 19:00:02">2020-12-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-04-04T06:12:44.197Z" title="更新于 2021-04-04 14:12:44">2021-04-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%80%86%E5%90%91%E5%BC%80%E5%8F%91/">逆向开发</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">33.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>197分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="概览"><a href="#概览" class="headerlink" title="概览"></a>概览</h1><p>反调试属于高级逆向技术范畴，并且涉及面异常广泛，几乎任何技术在经过精心构造后都可以变成反调试技术</p>
<p>反调试的核心思想就是阻拦逆向工作者分析自己的代码，如果不能从技术上彻底阻拦住分析者，也会想办法在精神层面击垮分析者</p>
<p>因此对于初学者，最有效的办法是使用其不了解的技术做反调试，进而拦住他。开发这种反调试的技巧的核心思想就是找调试状态与正常状态的不同点，并加以利用</p>
<p>而对于逆向分析的老手，则只能消耗其意志，增加其逆向分析的复杂性入手，开发这种反调试技巧的核心思想就是找到完成一件事的多种方法，然后随机堆叠使用，进而增加分析成本</p>
<h1 id="静态反调试"><a href="#静态反调试" class="headerlink" title="静态反调试"></a>静态反调试</h1><p>特点：一般在调试开始时阻拦调试者，调试者只需找到原因后可一次性突破</p>
<h2 id="PEB"><a href="#PEB" class="headerlink" title="PEB"></a>PEB</h2><ul>
<li>BeginDebug：调试标记位</li>
<li>Ldr：内存状态</li>
<li>Heap(Flags,Force Flags)：堆状态</li>
<li>NtGlobalFlag：内核全局标记</li>
</ul>
<h2 id="TEB"><a href="#TEB" class="headerlink" title="TEB"></a>TEB</h2><ul>
<li>StaticUnicodeString：静态缓冲区</li>
</ul>
<h2 id="使用原始API"><a href="#使用原始API" class="headerlink" title="使用原始API"></a>使用原始API</h2><ul>
<li><p>NtQueryInformationProcess()</p>
</li>
<li><ul>
<li>ProcessDebugPort(0x07):获取调试端口</li>
<li>ProcessDebugObjectHandle(0x1E):获取调试句柄</li>
<li>ProcessDebugFlag(0x1F):获取调试标记</li>
</ul>
<p>NtQuerySystemInformation()</p>
<ul>
<li>SystemKenelDebuggerInformation(0x23):获取系统调试状态（双机）</li>
</ul>
<p>NtQueryObject():遍历内核对象</p>
</li>
</ul>
<h2 id="攻击调试器"><a href="#攻击调试器" class="headerlink" title="攻击调试器"></a>攻击调试器</h2><ul>
<li>NtSetInformationThread()</li>
<li><ul>
<li>ThreadHideFormDebugger(0x11)</li>
</ul>
</li>
</ul>
<h2 id="打开进程检查"><a href="#打开进程检查" class="headerlink" title="打开进程检查"></a>打开进程检查</h2><ul>
<li>SeDebugPrivilege：检查进程是否具有调试权限</li>
</ul>
<h2 id="利用TLS回调函数"><a href="#利用TLS回调函数" class="headerlink" title="利用TLS回调函数"></a>利用TLS回调函数</h2><ul>
<li>使用普通API</li>
<li><ul>
<li>父进程检查</li>
<li>窗口名检查</li>
<li>进程名遍历</li>
<li>文件名及文件路劲检查</li>
<li>注册表检查</li>
<li>……</li>
</ul>
</li>
</ul>
<h1 id="动态反调试"><a href="#动态反调试" class="headerlink" title="动态反调试"></a>动态反调试</h1><p>特点：一般在调试过程中阻拦调试者，可以在调试过程中被频繁触发，因此需要调试者随时关注</p>
<h2 id="使用SEH"><a href="#使用SEH" class="headerlink" title="使用SEH"></a>使用SEH</h2><ul>
<li>异常</li>
<li>断点</li>
<li>SetUnhandleedExceptionFilter()</li>
</ul>
<h2 id="时间检查"><a href="#时间检查" class="headerlink" title="时间检查"></a>时间检查</h2><p>RDTSC：汇编指令，读取时间戳计数器的内容</p>
<h2 id="单步检查"><a href="#单步检查" class="headerlink" title="单步检查"></a>单步检查</h2><h2 id="补丁检查"><a href="#补丁检查" class="headerlink" title="补丁检查"></a>补丁检查</h2><p>0xCC扫描：根据规则扫描程序内0xCC，如果发现则有可能被下了断点。</p>
<p>Hash扫描：扫描关键代码段Hash值，如不对则证明在运行时被修改/调试</p>
<h2 id="PEB相关"><a href="#PEB相关" class="headerlink" title="PEB相关"></a>PEB相关</h2><h3 id="PEB-BeginDebuged"><a href="#PEB-BeginDebuged" class="headerlink" title="PEB_BeginDebuged"></a>PEB_BeginDebuged</h3><p>如果其值为1则证明本进程处于被调试状态</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">PEB_BeginDebuged</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> bRet = TRUE;</span><br><span class="line">	_asm</span><br><span class="line">	&#123;</span><br><span class="line">	mov eax, fs: [<span class="number">0x30</span>] ;<span class="comment">//找到PEB</span></span><br><span class="line">	mov al, byte ptr ds:[eax + <span class="number">0x2</span>]; <span class="comment">// 取出一个字节</span></span><br><span class="line">	mov bRet, al;					<span class="comment">//这个字节为1时（存在调试器）</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> bRet;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (PEB_BeginDebuged())</span><br><span class="line">	&#123;</span><br><span class="line">		MessageBox(<span class="number">0</span>, <span class="string">L&quot;有调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		MessageBox(<span class="number">0</span>, <span class="string">L&quot;无调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="PEB-ProcessHeap"><a href="#PEB-ProcessHeap" class="headerlink" title="PEB_ProcessHeap"></a>PEB_ProcessHeap</h3><p>ProcessHeap的Flags与ForceFlags在正常情况下应为2与0，处于调试状态时值会发生改变，此方法在NT 5.x版本以上无效</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">PEB_ProcessHeap</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> Flags = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> ForceFlags = <span class="number">0</span>;</span><br><span class="line">    __asm</span><br><span class="line">    &#123;</span><br><span class="line">        PUSHAD;</span><br><span class="line">        MOV EAX, DWORD PTR FS : [<span class="number">0x30</span>] ;          <span class="comment">// 获取PEB地址</span></span><br><span class="line">        MOV EAX, DWORD PTR DS : [eax + <span class="number">0x18</span>] ; <span class="comment">// 获取PEB.ProcessHeap</span></span><br><span class="line">        MOV EBX, DWORD PTR DS : [eax + <span class="number">0x40</span>] ; <span class="comment">// 获取PEB.Pro...p.Flags</span></span><br><span class="line">        MOV ECX, DWORD PTR DS : [eax + <span class="number">0x44</span>] ; <span class="comment">// 获取PEB.Pro...p.Forc...</span></span><br><span class="line">        MOV Flags, EBX;</span><br><span class="line">        MOV ForceFlags, ECX;</span><br><span class="line">        POPAD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (Flags == <span class="number">2</span> &amp;&amp; ForceFlags == <span class="number">0</span>) ? <span class="literal">false</span> : <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (PEB_ProcessHeap())</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox(<span class="number">0</span>, <span class="string">L&quot;有调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox(<span class="number">0</span>, <span class="string">L&quot;无调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="PEB-NtGlobalFlag"><a href="#PEB-NtGlobalFlag" class="headerlink" title="PEB_NtGlobalFlag"></a>PEB_NtGlobalFlag</h3><p>在当前进程处于调试状态时值为0x70，我们可以通过判定此值来确定是否被调试</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">PEB_NtGlobalFlag</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> NtGlobalFlag = <span class="number">0</span>;</span><br><span class="line">    __asm</span><br><span class="line">    &#123;</span><br><span class="line">        mov eax, dword ptr fs : [<span class="number">0x30</span>] ;          <span class="comment">// 获取PEB地址</span></span><br><span class="line">        mov eax, dword ptr ds : [eax + <span class="number">0x68</span>] ; <span class="comment">// 获取PEB.NtGloba...</span></span><br><span class="line">        mov NtGlobalFlag, eax;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> NtGlobalFlag == <span class="number">0x70</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (PEB_NtGlobalFlag())</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox(<span class="number">0</span>, <span class="string">L&quot;有调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox(<span class="number">0</span>, <span class="string">L&quot;无调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="NtQueryInformationProcess相关"><a href="#NtQueryInformationProcess相关" class="headerlink" title="NtQueryInformationProcess相关"></a>NtQueryInformationProcess相关</h2><p>NtQueryInformationProcess是一个可以同时在R0及R3运行的函数，它的主要作用是查看进程相关的各种信息</p>
<p>根据想要看的信息类别不同，我们给其第二个参数ProcessInformationClass传的值也不同，可以得知此函数大概能够查看60余种进程相关的信息</p>
<h3 id="在TLS函数中可以做反调试"><a href="#在TLS函数中可以做反调试" class="headerlink" title="在TLS函数中可以做反调试"></a>在TLS函数中可以做反调试</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ntdll.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//_IMAGE_TLSDIRECTORY32</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(linker, <span class="meta-string">&quot;/INCLUDE:__tls_used&quot;</span>)</span></span><br><span class="line"></span><br><span class="line">DWORD isDebug = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> NTAPI <span class="title">TLS_CALLBACK</span><span class="params">(PVOID DllHandle, DWORD Reason, PVOID Reserved)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(Reason == DLL_PROCESS_ATTACH)</span><br><span class="line">    &#123;</span><br><span class="line">        ::MessageBOxA(<span class="number">0</span>, <span class="string">&quot;TLS函数执行&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">       <span class="comment">//不接受内核调试信息			ThreadHideFromDebugger代表中断与内核之间的调试联系		</span></span><br><span class="line">		NtSetInformationThread(GetCurrentThread(), ThreadHideFromDebugger, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="comment">//ProcessDebugPort表示查询调试端口，isDubeg是返回值，isDubeg如果返回0代表没有被调试</span></span><br><span class="line">		NtQueryInformationProcess(GetCurrentThread(), ProcessDebugPort, (PVOID)isDubeg, <span class="keyword">sizeof</span>(DWORD), <span class="literal">NULL</span>);        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> arr[] &#123;<span class="number">0xc7</span>, <span class="number">0xb2</span>, <span class="number">0xa2</span>, <span class="number">0xf1</span>, <span class="number">0xa3</span>, <span class="number">0xd9</span>, <span class="number">0xa9</span>,<span class="number">0xb6</span>, <span class="number">0x10</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">sizeof</span>(arr); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        arr[i] = arr[i] ^ <span class="number">0x10</span> ^ isDebug;<span class="comment">//如果不存在调试isBebug的值为0，否则arr输出时为乱码</span></span><br><span class="line">    &#125;</span><br><span class="line">    MessageBoxA()<span class="literal">NULL</span>, arr, <span class="string">&quot;提示&quot;</span>,MB_OK);</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//新建一段数据，放到TLS这个目录表中</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> data_seg(<span class="meta-string">&quot;.CRT$XLX&quot;</span>)</span></span><br><span class="line">PIMAGE_TLS_CALLBACK pTLS_CALLBACK[] = &#123; TLS_CALLBACK, <span class="literal">NULL</span>&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> data_seg()</span></span><br></pre></td></tr></table></figure>



<h3 id="ProcessDebugPort"><a href="#ProcessDebugPort" class="headerlink" title="ProcessDebugPort"></a>ProcessDebugPort</h3><p>ProcessDebugPort 可以获取目标进程的调试端口，如果目标未处于调试状态此端口为0，否则为0xFFFFFFFF。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;winternl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">&quot;ntdll.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//根据端口是0或0xFFFFFFFF</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">NQIP_ProcessDebugPort</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> nDebugPort = <span class="number">0</span>;</span><br><span class="line">    NtQueryInformationProcess(</span><br><span class="line">        GetCurrentProcess(), 	<span class="comment">// 目标进程句柄</span></span><br><span class="line">        ProcessDebugPort, 	<span class="comment">// 查询信息类型</span></span><br><span class="line">        &amp;nDebugPort, 		<span class="comment">// 输出查询信息</span></span><br><span class="line">        <span class="keyword">sizeof</span>(nDebugPort), 	<span class="comment">// 查询类型大小</span></span><br><span class="line">        <span class="literal">NULL</span>); 			<span class="comment">// 实际返回数据大小</span></span><br><span class="line">    <span class="keyword">return</span> nDebugPort == <span class="number">0xFFFFFFFF</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (NQIP_ProcessDebugFlag())</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox(<span class="number">0</span>, <span class="string">L&quot;有调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox(<span class="number">0</span>, <span class="string">L&quot;无调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ProcessDebugObjectHandle"><a href="#ProcessDebugObjectHandle" class="headerlink" title="ProcessDebugObjectHandle"></a>ProcessDebugObjectHandle</h3><p>ProcessDebugObjectHandle可以获取目标进程的调试对象句柄，如果未处于调试状态则获取的值为NULL</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;winternl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">&quot;ntdll.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">NQIP_ProcessDebugObjectHandle</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    HANDLE hProcessDebugObjectHandle = <span class="number">0</span>;</span><br><span class="line">    NtQueryInformationProcess(</span><br><span class="line">        GetCurrentProcess(), 			<span class="comment">// 目标进程句柄</span></span><br><span class="line">        (PROCESSINFOCLASS)<span class="number">0x1E</span>, 		<span class="comment">// 查询信息类型  ProcessDebugObjectHandle</span></span><br><span class="line">        &amp;hProcessDebugObjectHandle, 	<span class="comment">// 输出查询信息</span></span><br><span class="line">        <span class="keyword">sizeof</span>(hProcessDebugObjectHandle), <span class="comment">// 查询类型大小</span></span><br><span class="line">        <span class="literal">NULL</span>); 					<span class="comment">// 实际返回大小</span></span><br><span class="line">    <span class="keyword">return</span> hProcessDebugObjectHandle ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (NQIP_ProcessDebugObjectHandle())</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox(<span class="number">0</span>, <span class="string">L&quot;有调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox(<span class="number">0</span>, <span class="string">L&quot;无调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ProcessDebugFlag"><a href="#ProcessDebugFlag" class="headerlink" title="ProcessDebugFlag"></a>ProcessDebugFlag</h3><p>ProcessDebugFlag可以获取目标进程的调试标记，如果未处于调试状态其值为0否则为1</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;winternl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">&quot;ntdll.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">NQIP_ProcessDebugFlag</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BOOL bProcessDebugFlag = <span class="number">0</span>;</span><br><span class="line">    NtQueryInformationProcess(</span><br><span class="line">        GetCurrentProcess(), 		<span class="comment">// 目标进程句柄</span></span><br><span class="line">        (PROCESSINFOCLASS)<span class="number">0x1F</span>, 	<span class="comment">// 查询信息类型ProcessDebugFlags </span></span><br><span class="line">        &amp;bProcessDebugFlag, 		<span class="comment">// 输出查询信息</span></span><br><span class="line">        <span class="keyword">sizeof</span>(bProcessDebugFlag), 	<span class="comment">// 查询类型大小</span></span><br><span class="line">        <span class="literal">NULL</span>); 				<span class="comment">// 实际返回大小</span></span><br><span class="line">    <span class="keyword">return</span> bProcessDebugFlag ? <span class="literal">false</span> : <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (NQIP_ProcessDebugObjectHandle())</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox(<span class="number">0</span>, <span class="string">L&quot;有调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox(<span class="number">0</span>, <span class="string">L&quot;无调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ProcessBasicInformation"><a href="#ProcessBasicInformation" class="headerlink" title="ProcessBasicInformation"></a>ProcessBasicInformation</h3><p>ProcessBasicInformation 可以获取指定进程的父进程PID，我们可以将其与Explorer.exe的PID进行比对，如果不匹配则证明此进程不是被双击运行的</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;winternl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">&quot;ntdll.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">NQIP_CheckParentProcess</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">PROCESS_BASIC_INFORMATION</span> &#123;</span></span><br><span class="line">        ULONG ExitStatus; 		     <span class="comment">// 进程返回码</span></span><br><span class="line">        PPEB  PebBaseAddress; 		 <span class="comment">// PEB地址</span></span><br><span class="line">        ULONG AffinityMask; 		 <span class="comment">// CPU亲和性掩码</span></span><br><span class="line">        LONG  BasePriority; 		 <span class="comment">// 基本优先级</span></span><br><span class="line">        ULONG UniqueProcessId; 		 <span class="comment">// 本进程PID</span></span><br><span class="line">        ULONG InheritedFromUniqueProcessId; <span class="comment">// 父进程PID</span></span><br><span class="line">    &#125;stcProcInfo;</span><br><span class="line"></span><br><span class="line">    NtQueryInformationProcess(</span><br><span class="line">        GetCurrentProcess(), </span><br><span class="line">        ProcessBasicInformation, <span class="comment">// 进程基本信息</span></span><br><span class="line">        &amp;stcProcInfo,</span><br><span class="line">        <span class="keyword">sizeof</span>(stcProcInfo), </span><br><span class="line">        <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    DWORD ExplorerPID = <span class="number">0</span>;</span><br><span class="line">    DWORD CurrentPID = stcProcInfo.InheritedFromUniqueProcessId;</span><br><span class="line">    GetWindowThreadProcessId(FindWindow(<span class="string">L&quot;Progman&quot;</span>, <span class="literal">NULL</span>), &amp;ExplorerPID);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ExplorerPID == CurrentPID ? <span class="literal">false</span> : <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (NQIP_CheckParentProcess())</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox(<span class="number">0</span>, <span class="string">L&quot;有调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox(<span class="number">0</span>, <span class="string">L&quot;无调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>破解函数反调试的最有效方法就是找到具体函数调用的地点，并分析其条件跳转，然后做暴力破解，亦或是通过HOOK的方式过滤其返回信息</p>
<p>想要在调试过程中很好的做好以上工作，有必要熟记的几个功能号（第二个参数传值）的作用：</p>
<p>0x07：获取调试端口（ProcessDebugPort）</p>
<p>0x1E：获取调试句柄（ProcessDebugObjectHandle）</p>
<p>0x1F：获取调试标记（ProcessDebugFlag）</p>
<h2 id="NtQuerySystemInformation"><a href="#NtQuerySystemInformation" class="headerlink" title="NtQuerySystemInformation"></a>NtQuerySystemInformation</h2><p>NtQuerySystemInformation函数获取当前系统是否开启调试模式（注：当前系统）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;winternl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">&quot;ntdll.lib&quot;</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">NQSI_SystemKernelDebuggerInformation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">SYSTEM_KERNEL_DEBUGGER_INFORMATION</span> &#123;</span></span><br><span class="line">        BOOLEAN DebuggerEanbled;</span><br><span class="line">        BOOLEAN DebuggerNotPresent;</span><br><span class="line">    &#125;DebuggerInfo = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="comment">// 查询系统信息</span></span><br><span class="line">    NtQuerySystemInformation(</span><br><span class="line">        (SYSTEM_INFORMATION_CLASS)<span class="number">0x23</span>,  <span class="comment">// 查询信息类型 有没有内核调试器</span></span><br><span class="line">        &amp;DebuggerInfo, 			         <span class="comment">// 输出查询信息</span></span><br><span class="line">        <span class="keyword">sizeof</span>(DebuggerInfo), 			 <span class="comment">// 查询类型大小</span></span><br><span class="line">        <span class="literal">NULL</span>); 					         <span class="comment">// 实际返回大小</span></span><br><span class="line">    <span class="keyword">return</span> DebuggerInfo.DebuggerEanbled;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (NQSI_SystemKernelDebuggerInformation())</span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox(<span class="number">0</span>, <span class="string">L&quot;有内核调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        MessageBox(<span class="number">0</span>, <span class="string">L&quot;无内核调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="攻击调试器-1"><a href="#攻击调试器-1" class="headerlink" title="攻击调试器"></a>攻击调试器</h2><p>ZW_SET_INFORMATION_THREAD函数可主动脱离调试器，使自己调试器的调试关系分离，进而达到反调试的目的</p>
<p>在调试的情况下后面的代码都不执行了</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> <span class="title">THREAD_INFO_CLASS</span> &#123;</span></span><br><span class="line">    ThreadHideFromDebugger = <span class="number">17</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">NTSTATUS</span><span class="params">(NTAPI* ZW_SET_INFORMATION_THREAD)</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    IN  HANDLE 			    ThreadHandle,               <span class="comment">// 线程句柄</span></span></span></span><br><span class="line"><span class="function"><span class="params">    IN  THREAD_INFO_CLASS	ThreadInformaitonClass,     <span class="comment">// 要设置线程的信息</span></span></span></span><br><span class="line"><span class="function"><span class="params">    IN  PVOID 			    ThreadInformation,          <span class="comment">// 线程的具体信息</span></span></span></span><br><span class="line"><span class="function"><span class="params">    IN  ULONG 			    ThreadInformationLength)</span></span>;   <span class="comment">// 参数3的大小</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ZSIT_DetachDebug</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ZW_SET_INFORMATION_THREAD Func;</span><br><span class="line">    Func = (ZW_SET_INFORMATION_THREAD)GetProcAddress(</span><br><span class="line">        LoadLibrary(<span class="string">L&quot;ntdll.dll&quot;</span>), <span class="string">&quot;ZwSetInformationThread&quot;</span>);</span><br><span class="line">    Func(GetCurrentThread(), ThreadHideFromDebugger, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 攻击调试器</span></span><br><span class="line">    ZSIT_DetachDebug();</span><br><span class="line">    </span><br><span class="line">    MessageBox(<span class="number">0</span>, <span class="string">L&quot;无调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="窗口名检测"><a href="#窗口名检测" class="headerlink" title="窗口名检测"></a>窗口名检测</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//获取活动窗口的句柄</span></span><br><span class="line">	HWND hwnd = GetForegroundWindow();</span><br><span class="line">	TCHAR buf[<span class="number">100</span>] = &#123;&#125;;</span><br><span class="line">	<span class="comment">// 可以检测15pbod窗口名</span></span><br><span class="line">	GetWindowText(hwnd, buf, <span class="number">100</span>);</span><br><span class="line">	TCHAR buff[<span class="number">100</span>] = &#123;&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; <span class="keyword">sizeof</span>(buf)<span class="number">-1</span>; index++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (buf[index] == <span class="string">&#x27;O&#x27;</span> &amp;&amp; buf[index + <span class="number">1</span>] == <span class="string">&#x27;D&#x27;</span> ||</span><br><span class="line">			buf[index] == <span class="string">&#x27;o&#x27;</span> &amp;&amp; buf[index + <span class="number">1</span>] == <span class="string">&#x27;d&#x27;</span></span><br><span class="line">			)</span><br><span class="line">		&#123;</span><br><span class="line">			MessageBox(<span class="number">0</span>, <span class="string">L&quot;有调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(index &lt; <span class="keyword">sizeof</span>(buf) - <span class="number">2</span>)</span><br><span class="line">		<span class="keyword">if</span> (buf[index] == <span class="string">&#x27;D&#x27;</span> &amp;&amp; buf[index + <span class="number">1</span>] == <span class="string">&#x27;b&#x27;</span> &amp;&amp; buf[index + <span class="number">2</span>] == <span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			MessageBox(<span class="number">0</span>, <span class="string">L&quot;有调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (index &lt; <span class="keyword">sizeof</span>(buf) - <span class="number">4</span>)</span><br><span class="line">			<span class="keyword">if</span> (buf[index] == <span class="string">&#x27;D&#x27;</span> &amp;&amp; buf[index + <span class="number">1</span>] == <span class="string">&#x27;e&#x27;</span> </span><br><span class="line">				&amp;&amp; buf[index + <span class="number">2</span>] == <span class="string">&#x27;b&#x27;</span> &amp;&amp; buf[index + <span class="number">3</span>] == <span class="string">&#x27;u&#x27;</span></span><br><span class="line">				&amp;&amp; buf[index + <span class="number">4</span>] == <span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				MessageBox(<span class="number">0</span>, <span class="string">L&quot;有调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">        <span class="keyword">if</span>(index == <span class="keyword">sizeof</span>(buf) - <span class="number">2</span>)</span><br><span class="line">		MessageBox(<span class="number">0</span>, <span class="string">L&quot;无调试器&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="去除花指令"><a href="#去除花指令" class="headerlink" title="去除花指令"></a>去除花指令</h1><p>原理：</p>
<p>​    找到花指令二进制特征</p>
<p>​    找到后使用nop填充</p>
<p>使用OD脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Loop：</span><br><span class="line">&#x2F;&#x2F;从EIP处找到第一个特征码</span><br><span class="line">find eip,#xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx#</span><br><span class="line">&#x2F;&#x2F;判断是否找到</span><br><span class="line">cmp $RESULT,0</span><br><span class="line">&#x2F;&#x2F;如果没有找到就直接结束</span><br><span class="line">je Exit</span><br><span class="line">&#x2F;&#x2F;如果找到了就填充成nop</span><br><span class="line">mov [$RESULT],#90909090909090909090909090909090#</span><br><span class="line">&#x2F;&#x2F;从EIP的位置查找下一个特征码</span><br><span class="line">find eip,#xxxxxxxxxxxxxxxxxxx#</span><br><span class="line">&#x2F;&#x2F;判断是否找到</span><br><span class="line">cmp $RESULT,0</span><br><span class="line">&#x2F;&#x2F;如果没有找到就直接结束</span><br><span class="line">je Exit</span><br><span class="line">&#x2F;&#x2F;如果找到了就填充成nop</span><br><span class="line">mov [$RESULT],#9090909090909090#</span><br><span class="line">jmp Loop&#x2F;&#x2F;可能不止一处循环查找</span><br><span class="line">Exit:</span><br><span class="line">MSG &quot;花指令去除完成！&quot;</span><br></pre></td></tr></table></figure>

<h1 id="易语言特征码"><a href="#易语言特征码" class="headerlink" title="易语言特征码"></a>易语言特征码</h1><p>特征码一 字符串比较、 test edx,3</p>
<p>特征码二 按钮事件、    FF 55FC 5F 5E</p>
<p>特征码三 易语言体、    FF 25</p>
<h1 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h1><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><ol>
<li>如何找插件<pre><code>  遍历指定目下，plugin</code></pre>
</li>
<li>过滤插件名称 <pre><code>  dll后缀名</code></pre>
</li>
<li>插件是否有导出指定函数<pre><code>      init_plugin
      loadmenu_plugin
      exit_plugin</code></pre>
</li>
<li>检查插件是否符合我们的版本</li>
<li>保存插件，在程序运行中分别调用</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;list&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">list</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 插件信息</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PLUGIN_INFO</span> &#123;</span></span><br><span class="line">    HMODULE hMod;               <span class="comment">// 插件模块</span></span><br><span class="line">    <span class="keyword">char</span> plugin_name[<span class="number">200</span>];      <span class="comment">// 插件名称</span></span><br><span class="line">    <span class="keyword">char</span> plugin_version[<span class="number">200</span>];   <span class="comment">// 版本</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 保存所有插件</span></span><br><span class="line"><span class="built_in">list</span>&lt;PLUGIN_INFO&gt; g_plugin_list;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义函数指针</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span>  <span class="title">bool</span><span class="params">(*INIT_PLUGIN)</span><span class="params">(WORD, PLUGIN_INFO*)</span></span>;</span><br><span class="line"><span class="keyword">using</span> LOADMENU_PLUGIN = <span class="keyword">const</span> <span class="keyword">char</span> * (*)();</span><br><span class="line"><span class="keyword">using</span> EXIT_PLUGIN = <span class="keyword">void</span>(*)();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span>  <span class="title">OnInit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    WIN32_FIND_DATAA Data;</span><br><span class="line">    <span class="comment">// 遍历目录找到插件</span></span><br><span class="line">    HANDLE hFile = FindFirstFileA(<span class="string">&quot;.\\plugin\\*.dll&quot;</span>, &amp;Data);</span><br><span class="line">    <span class="keyword">if</span> (hFile == INVALID_HANDLE_VALUE)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="comment">// 拼接字符串，合并完成路径</span></span><br><span class="line">        <span class="keyword">char</span> szFileName[<span class="number">200</span>] = &#123;&#125;;</span><br><span class="line">        sprintf_s(szFileName, <span class="string">&quot;.\\plugin\\%s&quot;</span>, Data.cFileName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 加载dll</span></span><br><span class="line">        HMODULE hmod = LoadLibraryA(szFileName);</span><br><span class="line">        <span class="comment">// 加载成功</span></span><br><span class="line">        <span class="keyword">if</span> (hmod != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 获取指定函数</span></span><br><span class="line">          <span class="keyword">auto</span> pFnInit = (INIT_PLUGIN)GetProcAddress(hmod, <span class="string">&quot;init_plugin&quot;</span>);</span><br><span class="line">          <span class="comment">// 判断是否函数是否获取成功</span></span><br><span class="line">          <span class="keyword">if</span> (pFnInit != <span class="literal">NULL</span>)</span><br><span class="line">          &#123;</span><br><span class="line">              PLUGIN_INFO info;</span><br><span class="line">              <span class="comment">// 调用插件初始化</span></span><br><span class="line">              <span class="keyword">if</span> (pFnInit(MAKEWORD(<span class="number">2</span>, <span class="number">2</span>), &amp;info))</span><br><span class="line">              &#123;</span><br><span class="line">                  <span class="comment">// 保存模块，方便后面使用</span></span><br><span class="line">                  info.hMod = hmod;</span><br><span class="line">                  <span class="comment">// 保存到插件列表中</span></span><br><span class="line">                  g_plugin_list.push_back(info);</span><br><span class="line">                  <span class="keyword">continue</span>;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// 加载失败卸载模块</span></span><br><span class="line">          FreeLibrary(hmod);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//遍历下一个文件</span></span><br><span class="line">    &#125; <span class="keyword">while</span> (FindNextFileA(hFile, &amp;Data));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">OnLoadMenu</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 遍历所有插件，调用相应函数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; plugin : g_plugin_list)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="comment">// 获取加载菜单的函数</span></span><br><span class="line">        <span class="keyword">auto</span> FnLoadMenu = (LOADMENU_PLUGIN)GetProcAddress(plugin.hMod, <span class="string">&quot;loadmenu_plugin&quot;</span>);</span><br><span class="line">        <span class="comment">// 模仿加载到菜单中</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;菜单 ： %s 被加载了\n&quot;</span>,FnLoadMenu());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">OnExit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 遍历所有插件，调用相应函数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; plugin : g_plugin_list)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 获取加载菜单的函数</span></span><br><span class="line">        <span class="keyword">auto</span> FnExitPlugin = (EXIT_PLUGIN)GetProcAddress(plugin.hMod, <span class="string">&quot;exit_plugin&quot;</span>);</span><br><span class="line">        <span class="comment">// 模仿加载到菜单中</span></span><br><span class="line">        FnExitPlugin();</span><br><span class="line">        <span class="comment">// 释放dll</span></span><br><span class="line">        FreeLibrary(plugin.hMod);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 插件是在程序运行的个数时刻调用</span></span><br><span class="line">    <span class="comment">// 初始化</span></span><br><span class="line">    OnInit();</span><br><span class="line">    <span class="comment">// 菜单加载</span></span><br><span class="line">    OnLoadMenu();</span><br><span class="line">    <span class="comment">// 程序结束</span></span><br><span class="line">    OnExit();    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="简单插件的编写"><a href="#简单插件的编写" class="headerlink" title="简单插件的编写"></a>简单插件的编写</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 插件信息</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PLUGIN_INFO</span> &#123;</span></span><br><span class="line">    HMODULE hMod;               <span class="comment">// 插件模块</span></span><br><span class="line">    <span class="keyword">char</span> plugin_name[<span class="number">200</span>];      <span class="comment">// 插件名称</span></span><br><span class="line">    <span class="keyword">char</span> plugin_version[<span class="number">200</span>];   <span class="comment">// 版本</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 需要导这三个函数</span></span><br><span class="line"><span class="comment">// 插件初始化</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> _declspec(dllexport) <span class="function"><span class="keyword">bool</span> <span class="title">init_plugin</span><span class="params">(WORD version, PLUGIN_INFO* info)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 验证插件版本,这个插件是提供给2.2版本应用程序</span></span><br><span class="line">    <span class="keyword">if</span>(MAKEWORD(<span class="number">2</span>,<span class="number">2</span>)!= version)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 填充插件信息</span></span><br><span class="line">    strcpy_s(info-&gt;plugin_name, <span class="string">&quot;简单插件&quot;</span>);</span><br><span class="line">    strcpy_s(info-&gt;plugin_version, <span class="string">&quot;1.0&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  加载菜单的时候提供菜单名称</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> _declspec(dllexport) <span class="function"><span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">loadmenu_plugin</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;反调试&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 程序结束卸载插件</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> _declspec(dllexport) <span class="function"><span class="keyword">void</span> <span class="title">exit_plugin</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;简单插件 卸载了\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="OD插件的编写"><a href="#OD插件的编写" class="headerlink" title="OD插件的编写"></a>OD插件的编写</h2><h3 id="h文件"><a href="#h文件" class="headerlink" title=".h文件"></a>.h文件</h3><p>OD2.01头文件</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br><span class="line">2190</span><br><span class="line">2191</span><br><span class="line">2192</span><br><span class="line">2193</span><br><span class="line">2194</span><br><span class="line">2195</span><br><span class="line">2196</span><br><span class="line">2197</span><br><span class="line">2198</span><br><span class="line">2199</span><br><span class="line">2200</span><br><span class="line">2201</span><br><span class="line">2202</span><br><span class="line">2203</span><br><span class="line">2204</span><br><span class="line">2205</span><br><span class="line">2206</span><br><span class="line">2207</span><br><span class="line">2208</span><br><span class="line">2209</span><br><span class="line">2210</span><br><span class="line">2211</span><br><span class="line">2212</span><br><span class="line">2213</span><br><span class="line">2214</span><br><span class="line">2215</span><br><span class="line">2216</span><br><span class="line">2217</span><br><span class="line">2218</span><br><span class="line">2219</span><br><span class="line">2220</span><br><span class="line">2221</span><br><span class="line">2222</span><br><span class="line">2223</span><br><span class="line">2224</span><br><span class="line">2225</span><br><span class="line">2226</span><br><span class="line">2227</span><br><span class="line">2228</span><br><span class="line">2229</span><br><span class="line">2230</span><br><span class="line">2231</span><br><span class="line">2232</span><br><span class="line">2233</span><br><span class="line">2234</span><br><span class="line">2235</span><br><span class="line">2236</span><br><span class="line">2237</span><br><span class="line">2238</span><br><span class="line">2239</span><br><span class="line">2240</span><br><span class="line">2241</span><br><span class="line">2242</span><br><span class="line">2243</span><br><span class="line">2244</span><br><span class="line">2245</span><br><span class="line">2246</span><br><span class="line">2247</span><br><span class="line">2248</span><br><span class="line">2249</span><br><span class="line">2250</span><br><span class="line">2251</span><br><span class="line">2252</span><br><span class="line">2253</span><br><span class="line">2254</span><br><span class="line">2255</span><br><span class="line">2256</span><br><span class="line">2257</span><br><span class="line">2258</span><br><span class="line">2259</span><br><span class="line">2260</span><br><span class="line">2261</span><br><span class="line">2262</span><br><span class="line">2263</span><br><span class="line">2264</span><br><span class="line">2265</span><br><span class="line">2266</span><br><span class="line">2267</span><br><span class="line">2268</span><br><span class="line">2269</span><br><span class="line">2270</span><br><span class="line">2271</span><br><span class="line">2272</span><br><span class="line">2273</span><br><span class="line">2274</span><br><span class="line">2275</span><br><span class="line">2276</span><br><span class="line">2277</span><br><span class="line">2278</span><br><span class="line">2279</span><br><span class="line">2280</span><br><span class="line">2281</span><br><span class="line">2282</span><br><span class="line">2283</span><br><span class="line">2284</span><br><span class="line">2285</span><br><span class="line">2286</span><br><span class="line">2287</span><br><span class="line">2288</span><br><span class="line">2289</span><br><span class="line">2290</span><br><span class="line">2291</span><br><span class="line">2292</span><br><span class="line">2293</span><br><span class="line">2294</span><br><span class="line">2295</span><br><span class="line">2296</span><br><span class="line">2297</span><br><span class="line">2298</span><br><span class="line">2299</span><br><span class="line">2300</span><br><span class="line">2301</span><br><span class="line">2302</span><br><span class="line">2303</span><br><span class="line">2304</span><br><span class="line">2305</span><br><span class="line">2306</span><br><span class="line">2307</span><br><span class="line">2308</span><br><span class="line">2309</span><br><span class="line">2310</span><br><span class="line">2311</span><br><span class="line">2312</span><br><span class="line">2313</span><br><span class="line">2314</span><br><span class="line">2315</span><br><span class="line">2316</span><br><span class="line">2317</span><br><span class="line">2318</span><br><span class="line">2319</span><br><span class="line">2320</span><br><span class="line">2321</span><br><span class="line">2322</span><br><span class="line">2323</span><br><span class="line">2324</span><br><span class="line">2325</span><br><span class="line">2326</span><br><span class="line">2327</span><br><span class="line">2328</span><br><span class="line">2329</span><br><span class="line">2330</span><br><span class="line">2331</span><br><span class="line">2332</span><br><span class="line">2333</span><br><span class="line">2334</span><br><span class="line">2335</span><br><span class="line">2336</span><br><span class="line">2337</span><br><span class="line">2338</span><br><span class="line">2339</span><br><span class="line">2340</span><br><span class="line">2341</span><br><span class="line">2342</span><br><span class="line">2343</span><br><span class="line">2344</span><br><span class="line">2345</span><br><span class="line">2346</span><br><span class="line">2347</span><br><span class="line">2348</span><br><span class="line">2349</span><br><span class="line">2350</span><br><span class="line">2351</span><br><span class="line">2352</span><br><span class="line">2353</span><br><span class="line">2354</span><br><span class="line">2355</span><br><span class="line">2356</span><br><span class="line">2357</span><br><span class="line">2358</span><br><span class="line">2359</span><br><span class="line">2360</span><br><span class="line">2361</span><br><span class="line">2362</span><br><span class="line">2363</span><br><span class="line">2364</span><br><span class="line">2365</span><br><span class="line">2366</span><br><span class="line">2367</span><br><span class="line">2368</span><br><span class="line">2369</span><br><span class="line">2370</span><br><span class="line">2371</span><br><span class="line">2372</span><br><span class="line">2373</span><br><span class="line">2374</span><br><span class="line">2375</span><br><span class="line">2376</span><br><span class="line">2377</span><br><span class="line">2378</span><br><span class="line">2379</span><br><span class="line">2380</span><br><span class="line">2381</span><br><span class="line">2382</span><br><span class="line">2383</span><br><span class="line">2384</span><br><span class="line">2385</span><br><span class="line">2386</span><br><span class="line">2387</span><br><span class="line">2388</span><br><span class="line">2389</span><br><span class="line">2390</span><br><span class="line">2391</span><br><span class="line">2392</span><br><span class="line">2393</span><br><span class="line">2394</span><br><span class="line">2395</span><br><span class="line">2396</span><br><span class="line">2397</span><br><span class="line">2398</span><br><span class="line">2399</span><br><span class="line">2400</span><br><span class="line">2401</span><br><span class="line">2402</span><br><span class="line">2403</span><br><span class="line">2404</span><br><span class="line">2405</span><br><span class="line">2406</span><br><span class="line">2407</span><br><span class="line">2408</span><br><span class="line">2409</span><br><span class="line">2410</span><br><span class="line">2411</span><br><span class="line">2412</span><br><span class="line">2413</span><br><span class="line">2414</span><br><span class="line">2415</span><br><span class="line">2416</span><br><span class="line">2417</span><br><span class="line">2418</span><br><span class="line">2419</span><br><span class="line">2420</span><br><span class="line">2421</span><br><span class="line">2422</span><br><span class="line">2423</span><br><span class="line">2424</span><br><span class="line">2425</span><br><span class="line">2426</span><br><span class="line">2427</span><br><span class="line">2428</span><br><span class="line">2429</span><br><span class="line">2430</span><br><span class="line">2431</span><br><span class="line">2432</span><br><span class="line">2433</span><br><span class="line">2434</span><br><span class="line">2435</span><br><span class="line">2436</span><br><span class="line">2437</span><br><span class="line">2438</span><br><span class="line">2439</span><br><span class="line">2440</span><br><span class="line">2441</span><br><span class="line">2442</span><br><span class="line">2443</span><br><span class="line">2444</span><br><span class="line">2445</span><br><span class="line">2446</span><br><span class="line">2447</span><br><span class="line">2448</span><br><span class="line">2449</span><br><span class="line">2450</span><br><span class="line">2451</span><br><span class="line">2452</span><br><span class="line">2453</span><br><span class="line">2454</span><br><span class="line">2455</span><br><span class="line">2456</span><br><span class="line">2457</span><br><span class="line">2458</span><br><span class="line">2459</span><br><span class="line">2460</span><br><span class="line">2461</span><br><span class="line">2462</span><br><span class="line">2463</span><br><span class="line">2464</span><br><span class="line">2465</span><br><span class="line">2466</span><br><span class="line">2467</span><br><span class="line">2468</span><br><span class="line">2469</span><br><span class="line">2470</span><br><span class="line">2471</span><br><span class="line">2472</span><br><span class="line">2473</span><br><span class="line">2474</span><br><span class="line">2475</span><br><span class="line">2476</span><br><span class="line">2477</span><br><span class="line">2478</span><br><span class="line">2479</span><br><span class="line">2480</span><br><span class="line">2481</span><br><span class="line">2482</span><br><span class="line">2483</span><br><span class="line">2484</span><br><span class="line">2485</span><br><span class="line">2486</span><br><span class="line">2487</span><br><span class="line">2488</span><br><span class="line">2489</span><br><span class="line">2490</span><br><span class="line">2491</span><br><span class="line">2492</span><br><span class="line">2493</span><br><span class="line">2494</span><br><span class="line">2495</span><br><span class="line">2496</span><br><span class="line">2497</span><br><span class="line">2498</span><br><span class="line">2499</span><br><span class="line">2500</span><br><span class="line">2501</span><br><span class="line">2502</span><br><span class="line">2503</span><br><span class="line">2504</span><br><span class="line">2505</span><br><span class="line">2506</span><br><span class="line">2507</span><br><span class="line">2508</span><br><span class="line">2509</span><br><span class="line">2510</span><br><span class="line">2511</span><br><span class="line">2512</span><br><span class="line">2513</span><br><span class="line">2514</span><br><span class="line">2515</span><br><span class="line">2516</span><br><span class="line">2517</span><br><span class="line">2518</span><br><span class="line">2519</span><br><span class="line">2520</span><br><span class="line">2521</span><br><span class="line">2522</span><br><span class="line">2523</span><br><span class="line">2524</span><br><span class="line">2525</span><br><span class="line">2526</span><br><span class="line">2527</span><br><span class="line">2528</span><br><span class="line">2529</span><br><span class="line">2530</span><br><span class="line">2531</span><br><span class="line">2532</span><br><span class="line">2533</span><br><span class="line">2534</span><br><span class="line">2535</span><br><span class="line">2536</span><br><span class="line">2537</span><br><span class="line">2538</span><br><span class="line">2539</span><br><span class="line">2540</span><br><span class="line">2541</span><br><span class="line">2542</span><br><span class="line">2543</span><br><span class="line">2544</span><br><span class="line">2545</span><br><span class="line">2546</span><br><span class="line">2547</span><br><span class="line">2548</span><br><span class="line">2549</span><br><span class="line">2550</span><br><span class="line">2551</span><br><span class="line">2552</span><br><span class="line">2553</span><br><span class="line">2554</span><br><span class="line">2555</span><br><span class="line">2556</span><br><span class="line">2557</span><br><span class="line">2558</span><br><span class="line">2559</span><br><span class="line">2560</span><br><span class="line">2561</span><br><span class="line">2562</span><br><span class="line">2563</span><br><span class="line">2564</span><br><span class="line">2565</span><br><span class="line">2566</span><br><span class="line">2567</span><br><span class="line">2568</span><br><span class="line">2569</span><br><span class="line">2570</span><br><span class="line">2571</span><br><span class="line">2572</span><br><span class="line">2573</span><br><span class="line">2574</span><br><span class="line">2575</span><br><span class="line">2576</span><br><span class="line">2577</span><br><span class="line">2578</span><br><span class="line">2579</span><br><span class="line">2580</span><br><span class="line">2581</span><br><span class="line">2582</span><br><span class="line">2583</span><br><span class="line">2584</span><br><span class="line">2585</span><br><span class="line">2586</span><br><span class="line">2587</span><br><span class="line">2588</span><br><span class="line">2589</span><br><span class="line">2590</span><br><span class="line">2591</span><br><span class="line">2592</span><br><span class="line">2593</span><br><span class="line">2594</span><br><span class="line">2595</span><br><span class="line">2596</span><br><span class="line">2597</span><br><span class="line">2598</span><br><span class="line">2599</span><br><span class="line">2600</span><br><span class="line">2601</span><br><span class="line">2602</span><br><span class="line">2603</span><br><span class="line">2604</span><br><span class="line">2605</span><br><span class="line">2606</span><br><span class="line">2607</span><br><span class="line">2608</span><br><span class="line">2609</span><br><span class="line">2610</span><br><span class="line">2611</span><br><span class="line">2612</span><br><span class="line">2613</span><br><span class="line">2614</span><br><span class="line">2615</span><br><span class="line">2616</span><br><span class="line">2617</span><br><span class="line">2618</span><br><span class="line">2619</span><br><span class="line">2620</span><br><span class="line">2621</span><br><span class="line">2622</span><br><span class="line">2623</span><br><span class="line">2624</span><br><span class="line">2625</span><br><span class="line">2626</span><br><span class="line">2627</span><br><span class="line">2628</span><br><span class="line">2629</span><br><span class="line">2630</span><br><span class="line">2631</span><br><span class="line">2632</span><br><span class="line">2633</span><br><span class="line">2634</span><br><span class="line">2635</span><br><span class="line">2636</span><br><span class="line">2637</span><br><span class="line">2638</span><br><span class="line">2639</span><br><span class="line">2640</span><br><span class="line">2641</span><br><span class="line">2642</span><br><span class="line">2643</span><br><span class="line">2644</span><br><span class="line">2645</span><br><span class="line">2646</span><br><span class="line">2647</span><br><span class="line">2648</span><br><span class="line">2649</span><br><span class="line">2650</span><br><span class="line">2651</span><br><span class="line">2652</span><br><span class="line">2653</span><br><span class="line">2654</span><br><span class="line">2655</span><br><span class="line">2656</span><br><span class="line">2657</span><br><span class="line">2658</span><br><span class="line">2659</span><br><span class="line">2660</span><br><span class="line">2661</span><br><span class="line">2662</span><br><span class="line">2663</span><br><span class="line">2664</span><br><span class="line">2665</span><br><span class="line">2666</span><br><span class="line">2667</span><br><span class="line">2668</span><br><span class="line">2669</span><br><span class="line">2670</span><br><span class="line">2671</span><br><span class="line">2672</span><br><span class="line">2673</span><br><span class="line">2674</span><br><span class="line">2675</span><br><span class="line">2676</span><br><span class="line">2677</span><br><span class="line">2678</span><br><span class="line">2679</span><br><span class="line">2680</span><br><span class="line">2681</span><br><span class="line">2682</span><br><span class="line">2683</span><br><span class="line">2684</span><br><span class="line">2685</span><br><span class="line">2686</span><br><span class="line">2687</span><br><span class="line">2688</span><br><span class="line">2689</span><br><span class="line">2690</span><br><span class="line">2691</span><br><span class="line">2692</span><br><span class="line">2693</span><br><span class="line">2694</span><br><span class="line">2695</span><br><span class="line">2696</span><br><span class="line">2697</span><br><span class="line">2698</span><br><span class="line">2699</span><br><span class="line">2700</span><br><span class="line">2701</span><br><span class="line">2702</span><br><span class="line">2703</span><br><span class="line">2704</span><br><span class="line">2705</span><br><span class="line">2706</span><br><span class="line">2707</span><br><span class="line">2708</span><br><span class="line">2709</span><br><span class="line">2710</span><br><span class="line">2711</span><br><span class="line">2712</span><br><span class="line">2713</span><br><span class="line">2714</span><br><span class="line">2715</span><br><span class="line">2716</span><br><span class="line">2717</span><br><span class="line">2718</span><br><span class="line">2719</span><br><span class="line">2720</span><br><span class="line">2721</span><br><span class="line">2722</span><br><span class="line">2723</span><br><span class="line">2724</span><br><span class="line">2725</span><br><span class="line">2726</span><br><span class="line">2727</span><br><span class="line">2728</span><br><span class="line">2729</span><br><span class="line">2730</span><br><span class="line">2731</span><br><span class="line">2732</span><br><span class="line">2733</span><br><span class="line">2734</span><br><span class="line">2735</span><br><span class="line">2736</span><br><span class="line">2737</span><br><span class="line">2738</span><br><span class="line">2739</span><br><span class="line">2740</span><br><span class="line">2741</span><br><span class="line">2742</span><br><span class="line">2743</span><br><span class="line">2744</span><br><span class="line">2745</span><br><span class="line">2746</span><br><span class="line">2747</span><br><span class="line">2748</span><br><span class="line">2749</span><br><span class="line">2750</span><br><span class="line">2751</span><br><span class="line">2752</span><br><span class="line">2753</span><br><span class="line">2754</span><br><span class="line">2755</span><br><span class="line">2756</span><br><span class="line">2757</span><br><span class="line">2758</span><br><span class="line">2759</span><br><span class="line">2760</span><br><span class="line">2761</span><br><span class="line">2762</span><br><span class="line">2763</span><br><span class="line">2764</span><br><span class="line">2765</span><br><span class="line">2766</span><br><span class="line">2767</span><br><span class="line">2768</span><br><span class="line">2769</span><br><span class="line">2770</span><br><span class="line">2771</span><br><span class="line">2772</span><br><span class="line">2773</span><br><span class="line">2774</span><br><span class="line">2775</span><br><span class="line">2776</span><br><span class="line">2777</span><br><span class="line">2778</span><br><span class="line">2779</span><br><span class="line">2780</span><br><span class="line">2781</span><br><span class="line">2782</span><br><span class="line">2783</span><br><span class="line">2784</span><br><span class="line">2785</span><br><span class="line">2786</span><br><span class="line">2787</span><br><span class="line">2788</span><br><span class="line">2789</span><br><span class="line">2790</span><br><span class="line">2791</span><br><span class="line">2792</span><br><span class="line">2793</span><br><span class="line">2794</span><br><span class="line">2795</span><br><span class="line">2796</span><br><span class="line">2797</span><br><span class="line">2798</span><br><span class="line">2799</span><br><span class="line">2800</span><br><span class="line">2801</span><br><span class="line">2802</span><br><span class="line">2803</span><br><span class="line">2804</span><br><span class="line">2805</span><br><span class="line">2806</span><br><span class="line">2807</span><br><span class="line">2808</span><br><span class="line">2809</span><br><span class="line">2810</span><br><span class="line">2811</span><br><span class="line">2812</span><br><span class="line">2813</span><br><span class="line">2814</span><br><span class="line">2815</span><br><span class="line">2816</span><br><span class="line">2817</span><br><span class="line">2818</span><br><span class="line">2819</span><br><span class="line">2820</span><br><span class="line">2821</span><br><span class="line">2822</span><br><span class="line">2823</span><br><span class="line">2824</span><br><span class="line">2825</span><br><span class="line">2826</span><br><span class="line">2827</span><br><span class="line">2828</span><br><span class="line">2829</span><br><span class="line">2830</span><br><span class="line">2831</span><br><span class="line">2832</span><br><span class="line">2833</span><br><span class="line">2834</span><br><span class="line">2835</span><br><span class="line">2836</span><br><span class="line">2837</span><br><span class="line">2838</span><br><span class="line">2839</span><br><span class="line">2840</span><br><span class="line">2841</span><br><span class="line">2842</span><br><span class="line">2843</span><br><span class="line">2844</span><br><span class="line">2845</span><br><span class="line">2846</span><br><span class="line">2847</span><br><span class="line">2848</span><br><span class="line">2849</span><br><span class="line">2850</span><br><span class="line">2851</span><br><span class="line">2852</span><br><span class="line">2853</span><br><span class="line">2854</span><br><span class="line">2855</span><br><span class="line">2856</span><br><span class="line">2857</span><br><span class="line">2858</span><br><span class="line">2859</span><br><span class="line">2860</span><br><span class="line">2861</span><br><span class="line">2862</span><br><span class="line">2863</span><br><span class="line">2864</span><br><span class="line">2865</span><br><span class="line">2866</span><br><span class="line">2867</span><br><span class="line">2868</span><br><span class="line">2869</span><br><span class="line">2870</span><br><span class="line">2871</span><br><span class="line">2872</span><br><span class="line">2873</span><br><span class="line">2874</span><br><span class="line">2875</span><br><span class="line">2876</span><br><span class="line">2877</span><br><span class="line">2878</span><br><span class="line">2879</span><br><span class="line">2880</span><br><span class="line">2881</span><br><span class="line">2882</span><br><span class="line">2883</span><br><span class="line">2884</span><br><span class="line">2885</span><br><span class="line">2886</span><br><span class="line">2887</span><br><span class="line">2888</span><br><span class="line">2889</span><br><span class="line">2890</span><br><span class="line">2891</span><br><span class="line">2892</span><br><span class="line">2893</span><br><span class="line">2894</span><br><span class="line">2895</span><br><span class="line">2896</span><br><span class="line">2897</span><br><span class="line">2898</span><br><span class="line">2899</span><br><span class="line">2900</span><br><span class="line">2901</span><br><span class="line">2902</span><br><span class="line">2903</span><br><span class="line">2904</span><br><span class="line">2905</span><br><span class="line">2906</span><br><span class="line">2907</span><br><span class="line">2908</span><br><span class="line">2909</span><br><span class="line">2910</span><br><span class="line">2911</span><br><span class="line">2912</span><br><span class="line">2913</span><br><span class="line">2914</span><br><span class="line">2915</span><br><span class="line">2916</span><br><span class="line">2917</span><br><span class="line">2918</span><br><span class="line">2919</span><br><span class="line">2920</span><br><span class="line">2921</span><br><span class="line">2922</span><br><span class="line">2923</span><br><span class="line">2924</span><br><span class="line">2925</span><br><span class="line">2926</span><br><span class="line">2927</span><br><span class="line">2928</span><br><span class="line">2929</span><br><span class="line">2930</span><br><span class="line">2931</span><br><span class="line">2932</span><br><span class="line">2933</span><br><span class="line">2934</span><br><span class="line">2935</span><br><span class="line">2936</span><br><span class="line">2937</span><br><span class="line">2938</span><br><span class="line">2939</span><br><span class="line">2940</span><br><span class="line">2941</span><br><span class="line">2942</span><br><span class="line">2943</span><br><span class="line">2944</span><br><span class="line">2945</span><br><span class="line">2946</span><br><span class="line">2947</span><br><span class="line">2948</span><br><span class="line">2949</span><br><span class="line">2950</span><br><span class="line">2951</span><br><span class="line">2952</span><br><span class="line">2953</span><br><span class="line">2954</span><br><span class="line">2955</span><br><span class="line">2956</span><br><span class="line">2957</span><br><span class="line">2958</span><br><span class="line">2959</span><br><span class="line">2960</span><br><span class="line">2961</span><br><span class="line">2962</span><br><span class="line">2963</span><br><span class="line">2964</span><br><span class="line">2965</span><br><span class="line">2966</span><br><span class="line">2967</span><br><span class="line">2968</span><br><span class="line">2969</span><br><span class="line">2970</span><br><span class="line">2971</span><br><span class="line">2972</span><br><span class="line">2973</span><br><span class="line">2974</span><br><span class="line">2975</span><br><span class="line">2976</span><br><span class="line">2977</span><br><span class="line">2978</span><br><span class="line">2979</span><br><span class="line">2980</span><br><span class="line">2981</span><br><span class="line">2982</span><br><span class="line">2983</span><br><span class="line">2984</span><br><span class="line">2985</span><br><span class="line">2986</span><br><span class="line">2987</span><br><span class="line">2988</span><br><span class="line">2989</span><br><span class="line">2990</span><br><span class="line">2991</span><br><span class="line">2992</span><br><span class="line">2993</span><br><span class="line">2994</span><br><span class="line">2995</span><br><span class="line">2996</span><br><span class="line">2997</span><br><span class="line">2998</span><br><span class="line">2999</span><br><span class="line">3000</span><br><span class="line">3001</span><br><span class="line">3002</span><br><span class="line">3003</span><br><span class="line">3004</span><br><span class="line">3005</span><br><span class="line">3006</span><br><span class="line">3007</span><br><span class="line">3008</span><br><span class="line">3009</span><br><span class="line">3010</span><br><span class="line">3011</span><br><span class="line">3012</span><br><span class="line">3013</span><br><span class="line">3014</span><br><span class="line">3015</span><br><span class="line">3016</span><br><span class="line">3017</span><br><span class="line">3018</span><br><span class="line">3019</span><br><span class="line">3020</span><br><span class="line">3021</span><br><span class="line">3022</span><br><span class="line">3023</span><br><span class="line">3024</span><br><span class="line">3025</span><br><span class="line">3026</span><br><span class="line">3027</span><br><span class="line">3028</span><br><span class="line">3029</span><br><span class="line">3030</span><br><span class="line">3031</span><br><span class="line">3032</span><br><span class="line">3033</span><br><span class="line">3034</span><br><span class="line">3035</span><br><span class="line">3036</span><br><span class="line">3037</span><br><span class="line">3038</span><br><span class="line">3039</span><br><span class="line">3040</span><br><span class="line">3041</span><br><span class="line">3042</span><br><span class="line">3043</span><br><span class="line">3044</span><br><span class="line">3045</span><br><span class="line">3046</span><br><span class="line">3047</span><br><span class="line">3048</span><br><span class="line">3049</span><br><span class="line">3050</span><br><span class="line">3051</span><br><span class="line">3052</span><br><span class="line">3053</span><br><span class="line">3054</span><br><span class="line">3055</span><br><span class="line">3056</span><br><span class="line">3057</span><br><span class="line">3058</span><br><span class="line">3059</span><br><span class="line">3060</span><br><span class="line">3061</span><br><span class="line">3062</span><br><span class="line">3063</span><br><span class="line">3064</span><br><span class="line">3065</span><br><span class="line">3066</span><br><span class="line">3067</span><br><span class="line">3068</span><br><span class="line">3069</span><br><span class="line">3070</span><br><span class="line">3071</span><br><span class="line">3072</span><br><span class="line">3073</span><br><span class="line">3074</span><br><span class="line">3075</span><br><span class="line">3076</span><br><span class="line">3077</span><br><span class="line">3078</span><br><span class="line">3079</span><br><span class="line">3080</span><br><span class="line">3081</span><br><span class="line">3082</span><br><span class="line">3083</span><br><span class="line">3084</span><br><span class="line">3085</span><br><span class="line">3086</span><br><span class="line">3087</span><br><span class="line">3088</span><br><span class="line">3089</span><br><span class="line">3090</span><br><span class="line">3091</span><br><span class="line">3092</span><br><span class="line">3093</span><br><span class="line">3094</span><br><span class="line">3095</span><br><span class="line">3096</span><br><span class="line">3097</span><br><span class="line">3098</span><br><span class="line">3099</span><br><span class="line">3100</span><br><span class="line">3101</span><br><span class="line">3102</span><br><span class="line">3103</span><br><span class="line">3104</span><br><span class="line">3105</span><br><span class="line">3106</span><br><span class="line">3107</span><br><span class="line">3108</span><br><span class="line">3109</span><br><span class="line">3110</span><br><span class="line">3111</span><br><span class="line">3112</span><br><span class="line">3113</span><br><span class="line">3114</span><br><span class="line">3115</span><br><span class="line">3116</span><br><span class="line">3117</span><br><span class="line">3118</span><br><span class="line">3119</span><br><span class="line">3120</span><br><span class="line">3121</span><br><span class="line">3122</span><br><span class="line">3123</span><br><span class="line">3124</span><br><span class="line">3125</span><br><span class="line">3126</span><br><span class="line">3127</span><br><span class="line">3128</span><br><span class="line">3129</span><br><span class="line">3130</span><br><span class="line">3131</span><br><span class="line">3132</span><br><span class="line">3133</span><br><span class="line">3134</span><br><span class="line">3135</span><br><span class="line">3136</span><br><span class="line">3137</span><br><span class="line">3138</span><br><span class="line">3139</span><br><span class="line">3140</span><br><span class="line">3141</span><br><span class="line">3142</span><br><span class="line">3143</span><br><span class="line">3144</span><br><span class="line">3145</span><br><span class="line">3146</span><br><span class="line">3147</span><br><span class="line">3148</span><br><span class="line">3149</span><br><span class="line">3150</span><br><span class="line">3151</span><br><span class="line">3152</span><br><span class="line">3153</span><br><span class="line">3154</span><br><span class="line">3155</span><br><span class="line">3156</span><br><span class="line">3157</span><br><span class="line">3158</span><br><span class="line">3159</span><br><span class="line">3160</span><br><span class="line">3161</span><br><span class="line">3162</span><br><span class="line">3163</span><br><span class="line">3164</span><br><span class="line">3165</span><br><span class="line">3166</span><br><span class="line">3167</span><br><span class="line">3168</span><br><span class="line">3169</span><br><span class="line">3170</span><br><span class="line">3171</span><br><span class="line">3172</span><br><span class="line">3173</span><br><span class="line">3174</span><br><span class="line">3175</span><br><span class="line">3176</span><br><span class="line">3177</span><br><span class="line">3178</span><br><span class="line">3179</span><br><span class="line">3180</span><br><span class="line">3181</span><br><span class="line">3182</span><br><span class="line">3183</span><br><span class="line">3184</span><br><span class="line">3185</span><br><span class="line">3186</span><br><span class="line">3187</span><br><span class="line">3188</span><br><span class="line">3189</span><br><span class="line">3190</span><br><span class="line">3191</span><br><span class="line">3192</span><br><span class="line">3193</span><br><span class="line">3194</span><br><span class="line">3195</span><br><span class="line">3196</span><br><span class="line">3197</span><br><span class="line">3198</span><br><span class="line">3199</span><br><span class="line">3200</span><br><span class="line">3201</span><br><span class="line">3202</span><br><span class="line">3203</span><br><span class="line">3204</span><br><span class="line">3205</span><br><span class="line">3206</span><br><span class="line">3207</span><br><span class="line">3208</span><br><span class="line">3209</span><br><span class="line">3210</span><br><span class="line">3211</span><br><span class="line">3212</span><br><span class="line">3213</span><br><span class="line">3214</span><br><span class="line">3215</span><br><span class="line">3216</span><br><span class="line">3217</span><br><span class="line">3218</span><br><span class="line">3219</span><br><span class="line">3220</span><br><span class="line">3221</span><br><span class="line">3222</span><br><span class="line">3223</span><br><span class="line">3224</span><br><span class="line">3225</span><br><span class="line">3226</span><br><span class="line">3227</span><br><span class="line">3228</span><br><span class="line">3229</span><br><span class="line">3230</span><br><span class="line">3231</span><br><span class="line">3232</span><br><span class="line">3233</span><br><span class="line">3234</span><br><span class="line">3235</span><br><span class="line">3236</span><br><span class="line">3237</span><br><span class="line">3238</span><br><span class="line">3239</span><br><span class="line">3240</span><br><span class="line">3241</span><br><span class="line">3242</span><br><span class="line">3243</span><br><span class="line">3244</span><br><span class="line">3245</span><br><span class="line">3246</span><br><span class="line">3247</span><br><span class="line">3248</span><br><span class="line">3249</span><br><span class="line">3250</span><br><span class="line">3251</span><br><span class="line">3252</span><br><span class="line">3253</span><br><span class="line">3254</span><br><span class="line">3255</span><br><span class="line">3256</span><br><span class="line">3257</span><br><span class="line">3258</span><br><span class="line">3259</span><br><span class="line">3260</span><br><span class="line">3261</span><br><span class="line">3262</span><br><span class="line">3263</span><br><span class="line">3264</span><br><span class="line">3265</span><br><span class="line">3266</span><br><span class="line">3267</span><br><span class="line">3268</span><br><span class="line">3269</span><br><span class="line">3270</span><br><span class="line">3271</span><br><span class="line">3272</span><br><span class="line">3273</span><br><span class="line">3274</span><br><span class="line">3275</span><br><span class="line">3276</span><br><span class="line">3277</span><br><span class="line">3278</span><br><span class="line">3279</span><br><span class="line">3280</span><br><span class="line">3281</span><br><span class="line">3282</span><br><span class="line">3283</span><br><span class="line">3284</span><br><span class="line">3285</span><br><span class="line">3286</span><br><span class="line">3287</span><br><span class="line">3288</span><br><span class="line">3289</span><br><span class="line">3290</span><br><span class="line">3291</span><br><span class="line">3292</span><br><span class="line">3293</span><br><span class="line">3294</span><br><span class="line">3295</span><br><span class="line">3296</span><br><span class="line">3297</span><br><span class="line">3298</span><br><span class="line">3299</span><br><span class="line">3300</span><br><span class="line">3301</span><br><span class="line">3302</span><br><span class="line">3303</span><br><span class="line">3304</span><br><span class="line">3305</span><br><span class="line">3306</span><br><span class="line">3307</span><br><span class="line">3308</span><br><span class="line">3309</span><br><span class="line">3310</span><br><span class="line">3311</span><br><span class="line">3312</span><br><span class="line">3313</span><br><span class="line">3314</span><br><span class="line">3315</span><br><span class="line">3316</span><br><span class="line">3317</span><br><span class="line">3318</span><br><span class="line">3319</span><br><span class="line">3320</span><br><span class="line">3321</span><br><span class="line">3322</span><br><span class="line">3323</span><br><span class="line">3324</span><br><span class="line">3325</span><br><span class="line">3326</span><br><span class="line">3327</span><br><span class="line">3328</span><br><span class="line">3329</span><br><span class="line">3330</span><br><span class="line">3331</span><br><span class="line">3332</span><br><span class="line">3333</span><br><span class="line">3334</span><br><span class="line">3335</span><br><span class="line">3336</span><br><span class="line">3337</span><br><span class="line">3338</span><br><span class="line">3339</span><br><span class="line">3340</span><br><span class="line">3341</span><br><span class="line">3342</span><br><span class="line">3343</span><br><span class="line">3344</span><br><span class="line">3345</span><br><span class="line">3346</span><br><span class="line">3347</span><br><span class="line">3348</span><br><span class="line">3349</span><br><span class="line">3350</span><br><span class="line">3351</span><br><span class="line">3352</span><br><span class="line">3353</span><br><span class="line">3354</span><br><span class="line">3355</span><br><span class="line">3356</span><br><span class="line">3357</span><br><span class="line">3358</span><br><span class="line">3359</span><br><span class="line">3360</span><br><span class="line">3361</span><br><span class="line">3362</span><br><span class="line">3363</span><br><span class="line">3364</span><br><span class="line">3365</span><br><span class="line">3366</span><br><span class="line">3367</span><br><span class="line">3368</span><br><span class="line">3369</span><br><span class="line">3370</span><br><span class="line">3371</span><br><span class="line">3372</span><br><span class="line">3373</span><br><span class="line">3374</span><br><span class="line">3375</span><br><span class="line">3376</span><br><span class="line">3377</span><br><span class="line">3378</span><br><span class="line">3379</span><br><span class="line">3380</span><br><span class="line">3381</span><br><span class="line">3382</span><br><span class="line">3383</span><br><span class="line">3384</span><br><span class="line">3385</span><br><span class="line">3386</span><br><span class="line">3387</span><br><span class="line">3388</span><br><span class="line">3389</span><br><span class="line">3390</span><br><span class="line">3391</span><br><span class="line">3392</span><br><span class="line">3393</span><br><span class="line">3394</span><br><span class="line">3395</span><br><span class="line">3396</span><br><span class="line">3397</span><br><span class="line">3398</span><br><span class="line">3399</span><br><span class="line">3400</span><br><span class="line">3401</span><br><span class="line">3402</span><br><span class="line">3403</span><br><span class="line">3404</span><br><span class="line">3405</span><br><span class="line">3406</span><br><span class="line">3407</span><br><span class="line">3408</span><br><span class="line">3409</span><br><span class="line">3410</span><br><span class="line">3411</span><br><span class="line">3412</span><br><span class="line">3413</span><br><span class="line">3414</span><br><span class="line">3415</span><br><span class="line">3416</span><br><span class="line">3417</span><br><span class="line">3418</span><br><span class="line">3419</span><br><span class="line">3420</span><br><span class="line">3421</span><br><span class="line">3422</span><br><span class="line">3423</span><br><span class="line">3424</span><br><span class="line">3425</span><br><span class="line">3426</span><br><span class="line">3427</span><br><span class="line">3428</span><br><span class="line">3429</span><br><span class="line">3430</span><br><span class="line">3431</span><br><span class="line">3432</span><br><span class="line">3433</span><br><span class="line">3434</span><br><span class="line">3435</span><br><span class="line">3436</span><br><span class="line">3437</span><br><span class="line">3438</span><br><span class="line">3439</span><br><span class="line">3440</span><br><span class="line">3441</span><br><span class="line">3442</span><br><span class="line">3443</span><br><span class="line">3444</span><br><span class="line">3445</span><br><span class="line">3446</span><br><span class="line">3447</span><br><span class="line">3448</span><br><span class="line">3449</span><br><span class="line">3450</span><br><span class="line">3451</span><br><span class="line">3452</span><br><span class="line">3453</span><br><span class="line">3454</span><br><span class="line">3455</span><br><span class="line">3456</span><br><span class="line">3457</span><br><span class="line">3458</span><br><span class="line">3459</span><br><span class="line">3460</span><br><span class="line">3461</span><br><span class="line">3462</span><br><span class="line">3463</span><br><span class="line">3464</span><br><span class="line">3465</span><br><span class="line">3466</span><br><span class="line">3467</span><br><span class="line">3468</span><br><span class="line">3469</span><br><span class="line">3470</span><br><span class="line">3471</span><br><span class="line">3472</span><br><span class="line">3473</span><br><span class="line">3474</span><br><span class="line">3475</span><br><span class="line">3476</span><br><span class="line">3477</span><br><span class="line">3478</span><br><span class="line">3479</span><br><span class="line">3480</span><br><span class="line">3481</span><br><span class="line">3482</span><br><span class="line">3483</span><br><span class="line">3484</span><br><span class="line">3485</span><br><span class="line">3486</span><br><span class="line">3487</span><br><span class="line">3488</span><br><span class="line">3489</span><br><span class="line">3490</span><br><span class="line">3491</span><br><span class="line">3492</span><br><span class="line">3493</span><br><span class="line">3494</span><br><span class="line">3495</span><br><span class="line">3496</span><br><span class="line">3497</span><br><span class="line">3498</span><br><span class="line">3499</span><br><span class="line">3500</span><br><span class="line">3501</span><br><span class="line">3502</span><br><span class="line">3503</span><br><span class="line">3504</span><br><span class="line">3505</span><br><span class="line">3506</span><br><span class="line">3507</span><br><span class="line">3508</span><br><span class="line">3509</span><br><span class="line">3510</span><br><span class="line">3511</span><br><span class="line">3512</span><br><span class="line">3513</span><br><span class="line">3514</span><br><span class="line">3515</span><br><span class="line">3516</span><br><span class="line">3517</span><br><span class="line">3518</span><br><span class="line">3519</span><br><span class="line">3520</span><br><span class="line">3521</span><br><span class="line">3522</span><br><span class="line">3523</span><br><span class="line">3524</span><br><span class="line">3525</span><br><span class="line">3526</span><br><span class="line">3527</span><br><span class="line">3528</span><br><span class="line">3529</span><br><span class="line">3530</span><br><span class="line">3531</span><br><span class="line">3532</span><br><span class="line">3533</span><br><span class="line">3534</span><br><span class="line">3535</span><br><span class="line">3536</span><br><span class="line">3537</span><br><span class="line">3538</span><br><span class="line">3539</span><br><span class="line">3540</span><br><span class="line">3541</span><br><span class="line">3542</span><br><span class="line">3543</span><br><span class="line">3544</span><br><span class="line">3545</span><br><span class="line">3546</span><br><span class="line">3547</span><br><span class="line">3548</span><br><span class="line">3549</span><br><span class="line">3550</span><br><span class="line">3551</span><br><span class="line">3552</span><br><span class="line">3553</span><br><span class="line">3554</span><br><span class="line">3555</span><br><span class="line">3556</span><br><span class="line">3557</span><br><span class="line">3558</span><br><span class="line">3559</span><br><span class="line">3560</span><br><span class="line">3561</span><br><span class="line">3562</span><br><span class="line">3563</span><br><span class="line">3564</span><br><span class="line">3565</span><br><span class="line">3566</span><br><span class="line">3567</span><br><span class="line">3568</span><br><span class="line">3569</span><br><span class="line">3570</span><br><span class="line">3571</span><br><span class="line">3572</span><br><span class="line">3573</span><br><span class="line">3574</span><br><span class="line">3575</span><br><span class="line">3576</span><br><span class="line">3577</span><br><span class="line">3578</span><br><span class="line">3579</span><br><span class="line">3580</span><br><span class="line">3581</span><br><span class="line">3582</span><br><span class="line">3583</span><br><span class="line">3584</span><br><span class="line">3585</span><br><span class="line">3586</span><br><span class="line">3587</span><br><span class="line">3588</span><br><span class="line">3589</span><br><span class="line">3590</span><br><span class="line">3591</span><br><span class="line">3592</span><br><span class="line">3593</span><br><span class="line">3594</span><br><span class="line">3595</span><br><span class="line">3596</span><br><span class="line">3597</span><br><span class="line">3598</span><br><span class="line">3599</span><br><span class="line">3600</span><br><span class="line">3601</span><br><span class="line">3602</span><br><span class="line">3603</span><br><span class="line">3604</span><br><span class="line">3605</span><br><span class="line">3606</span><br><span class="line">3607</span><br><span class="line">3608</span><br><span class="line">3609</span><br><span class="line">3610</span><br><span class="line">3611</span><br><span class="line">3612</span><br><span class="line">3613</span><br><span class="line">3614</span><br><span class="line">3615</span><br><span class="line">3616</span><br><span class="line">3617</span><br><span class="line">3618</span><br><span class="line">3619</span><br><span class="line">3620</span><br><span class="line">3621</span><br><span class="line">3622</span><br><span class="line">3623</span><br><span class="line">3624</span><br><span class="line">3625</span><br><span class="line">3626</span><br><span class="line">3627</span><br><span class="line">3628</span><br><span class="line">3629</span><br><span class="line">3630</span><br><span class="line">3631</span><br><span class="line">3632</span><br><span class="line">3633</span><br><span class="line">3634</span><br><span class="line">3635</span><br><span class="line">3636</span><br><span class="line">3637</span><br><span class="line">3638</span><br><span class="line">3639</span><br><span class="line">3640</span><br><span class="line">3641</span><br><span class="line">3642</span><br><span class="line">3643</span><br><span class="line">3644</span><br><span class="line">3645</span><br><span class="line">3646</span><br><span class="line">3647</span><br><span class="line">3648</span><br><span class="line">3649</span><br><span class="line">3650</span><br><span class="line">3651</span><br><span class="line">3652</span><br><span class="line">3653</span><br><span class="line">3654</span><br><span class="line">3655</span><br><span class="line">3656</span><br><span class="line">3657</span><br><span class="line">3658</span><br><span class="line">3659</span><br><span class="line">3660</span><br><span class="line">3661</span><br><span class="line">3662</span><br><span class="line">3663</span><br><span class="line">3664</span><br><span class="line">3665</span><br><span class="line">3666</span><br><span class="line">3667</span><br><span class="line">3668</span><br><span class="line">3669</span><br><span class="line">3670</span><br><span class="line">3671</span><br><span class="line">3672</span><br><span class="line">3673</span><br><span class="line">3674</span><br><span class="line">3675</span><br><span class="line">3676</span><br><span class="line">3677</span><br><span class="line">3678</span><br><span class="line">3679</span><br><span class="line">3680</span><br><span class="line">3681</span><br><span class="line">3682</span><br><span class="line">3683</span><br><span class="line">3684</span><br><span class="line">3685</span><br><span class="line">3686</span><br><span class="line">3687</span><br><span class="line">3688</span><br><span class="line">3689</span><br><span class="line">3690</span><br><span class="line">3691</span><br><span class="line">3692</span><br><span class="line">3693</span><br><span class="line">3694</span><br><span class="line">3695</span><br><span class="line">3696</span><br><span class="line">3697</span><br><span class="line">3698</span><br><span class="line">3699</span><br><span class="line">3700</span><br><span class="line">3701</span><br><span class="line">3702</span><br><span class="line">3703</span><br><span class="line">3704</span><br><span class="line">3705</span><br><span class="line">3706</span><br><span class="line">3707</span><br><span class="line">3708</span><br><span class="line">3709</span><br><span class="line">3710</span><br><span class="line">3711</span><br><span class="line">3712</span><br><span class="line">3713</span><br><span class="line">3714</span><br><span class="line">3715</span><br><span class="line">3716</span><br><span class="line">3717</span><br><span class="line">3718</span><br><span class="line">3719</span><br><span class="line">3720</span><br><span class="line">3721</span><br><span class="line">3722</span><br><span class="line">3723</span><br><span class="line">3724</span><br><span class="line">3725</span><br><span class="line">3726</span><br><span class="line">3727</span><br><span class="line">3728</span><br><span class="line">3729</span><br><span class="line">3730</span><br><span class="line">3731</span><br><span class="line">3732</span><br><span class="line">3733</span><br><span class="line">3734</span><br><span class="line">3735</span><br><span class="line">3736</span><br><span class="line">3737</span><br><span class="line">3738</span><br><span class="line">3739</span><br><span class="line">3740</span><br><span class="line">3741</span><br><span class="line">3742</span><br><span class="line">3743</span><br><span class="line">3744</span><br><span class="line">3745</span><br><span class="line">3746</span><br><span class="line">3747</span><br><span class="line">3748</span><br><span class="line">3749</span><br><span class="line">3750</span><br><span class="line">3751</span><br><span class="line">3752</span><br><span class="line">3753</span><br><span class="line">3754</span><br><span class="line">3755</span><br><span class="line">3756</span><br><span class="line">3757</span><br><span class="line">3758</span><br><span class="line">3759</span><br><span class="line">3760</span><br><span class="line">3761</span><br><span class="line">3762</span><br><span class="line">3763</span><br><span class="line">3764</span><br><span class="line">3765</span><br><span class="line">3766</span><br><span class="line">3767</span><br><span class="line">3768</span><br><span class="line">3769</span><br><span class="line">3770</span><br><span class="line">3771</span><br><span class="line">3772</span><br><span class="line">3773</span><br><span class="line">3774</span><br><span class="line">3775</span><br><span class="line">3776</span><br><span class="line">3777</span><br><span class="line">3778</span><br><span class="line">3779</span><br><span class="line">3780</span><br><span class="line">3781</span><br><span class="line">3782</span><br><span class="line">3783</span><br><span class="line">3784</span><br><span class="line">3785</span><br><span class="line">3786</span><br><span class="line">3787</span><br><span class="line">3788</span><br><span class="line">3789</span><br><span class="line">3790</span><br><span class="line">3791</span><br><span class="line">3792</span><br><span class="line">3793</span><br><span class="line">3794</span><br><span class="line">3795</span><br><span class="line">3796</span><br><span class="line">3797</span><br><span class="line">3798</span><br><span class="line">3799</span><br><span class="line">3800</span><br><span class="line">3801</span><br><span class="line">3802</span><br><span class="line">3803</span><br><span class="line">3804</span><br><span class="line">3805</span><br><span class="line">3806</span><br><span class="line">3807</span><br><span class="line">3808</span><br><span class="line">3809</span><br><span class="line">3810</span><br><span class="line">3811</span><br><span class="line">3812</span><br><span class="line">3813</span><br><span class="line">3814</span><br><span class="line">3815</span><br><span class="line">3816</span><br><span class="line">3817</span><br><span class="line">3818</span><br><span class="line">3819</span><br><span class="line">3820</span><br><span class="line">3821</span><br><span class="line">3822</span><br><span class="line">3823</span><br><span class="line">3824</span><br><span class="line">3825</span><br><span class="line">3826</span><br><span class="line">3827</span><br><span class="line">3828</span><br><span class="line">3829</span><br><span class="line">3830</span><br><span class="line">3831</span><br><span class="line">3832</span><br><span class="line">3833</span><br><span class="line">3834</span><br><span class="line">3835</span><br><span class="line">3836</span><br><span class="line">3837</span><br><span class="line">3838</span><br><span class="line">3839</span><br><span class="line">3840</span><br><span class="line">3841</span><br><span class="line">3842</span><br><span class="line">3843</span><br><span class="line">3844</span><br><span class="line">3845</span><br><span class="line">3846</span><br><span class="line">3847</span><br><span class="line">3848</span><br><span class="line">3849</span><br><span class="line">3850</span><br><span class="line">3851</span><br><span class="line">3852</span><br><span class="line">3853</span><br><span class="line">3854</span><br><span class="line">3855</span><br><span class="line">3856</span><br><span class="line">3857</span><br><span class="line">3858</span><br><span class="line">3859</span><br><span class="line">3860</span><br><span class="line">3861</span><br><span class="line">3862</span><br><span class="line">3863</span><br><span class="line">3864</span><br><span class="line">3865</span><br><span class="line">3866</span><br><span class="line">3867</span><br><span class="line">3868</span><br><span class="line">3869</span><br><span class="line">3870</span><br><span class="line">3871</span><br><span class="line">3872</span><br><span class="line">3873</span><br><span class="line">3874</span><br><span class="line">3875</span><br><span class="line">3876</span><br><span class="line">3877</span><br><span class="line">3878</span><br><span class="line">3879</span><br><span class="line">3880</span><br><span class="line">3881</span><br><span class="line">3882</span><br><span class="line">3883</span><br><span class="line">3884</span><br><span class="line">3885</span><br><span class="line">3886</span><br><span class="line">3887</span><br><span class="line">3888</span><br><span class="line">3889</span><br><span class="line">3890</span><br><span class="line">3891</span><br><span class="line">3892</span><br><span class="line">3893</span><br><span class="line">3894</span><br><span class="line">3895</span><br><span class="line">3896</span><br><span class="line">3897</span><br><span class="line">3898</span><br><span class="line">3899</span><br><span class="line">3900</span><br><span class="line">3901</span><br><span class="line">3902</span><br><span class="line">3903</span><br><span class="line">3904</span><br><span class="line">3905</span><br><span class="line">3906</span><br><span class="line">3907</span><br><span class="line">3908</span><br><span class="line">3909</span><br><span class="line">3910</span><br><span class="line">3911</span><br><span class="line">3912</span><br><span class="line">3913</span><br><span class="line">3914</span><br><span class="line">3915</span><br><span class="line">3916</span><br><span class="line">3917</span><br><span class="line">3918</span><br><span class="line">3919</span><br><span class="line">3920</span><br><span class="line">3921</span><br><span class="line">3922</span><br><span class="line">3923</span><br><span class="line">3924</span><br><span class="line">3925</span><br><span class="line">3926</span><br><span class="line">3927</span><br><span class="line">3928</span><br><span class="line">3929</span><br><span class="line">3930</span><br><span class="line">3931</span><br><span class="line">3932</span><br><span class="line">3933</span><br><span class="line">3934</span><br><span class="line">3935</span><br><span class="line">3936</span><br><span class="line">3937</span><br><span class="line">3938</span><br><span class="line">3939</span><br><span class="line">3940</span><br><span class="line">3941</span><br><span class="line">3942</span><br><span class="line">3943</span><br><span class="line">3944</span><br><span class="line">3945</span><br><span class="line">3946</span><br><span class="line">3947</span><br><span class="line">3948</span><br><span class="line">3949</span><br><span class="line">3950</span><br><span class="line">3951</span><br><span class="line">3952</span><br><span class="line">3953</span><br><span class="line">3954</span><br><span class="line">3955</span><br><span class="line">3956</span><br><span class="line">3957</span><br><span class="line">3958</span><br><span class="line">3959</span><br><span class="line">3960</span><br><span class="line">3961</span><br><span class="line">3962</span><br><span class="line">3963</span><br><span class="line">3964</span><br><span class="line">3965</span><br><span class="line">3966</span><br><span class="line">3967</span><br><span class="line">3968</span><br><span class="line">3969</span><br><span class="line">3970</span><br><span class="line">3971</span><br><span class="line">3972</span><br><span class="line">3973</span><br><span class="line">3974</span><br><span class="line">3975</span><br><span class="line">3976</span><br><span class="line">3977</span><br><span class="line">3978</span><br><span class="line">3979</span><br><span class="line">3980</span><br><span class="line">3981</span><br><span class="line">3982</span><br><span class="line">3983</span><br><span class="line">3984</span><br><span class="line">3985</span><br><span class="line">3986</span><br><span class="line">3987</span><br><span class="line">3988</span><br><span class="line">3989</span><br><span class="line">3990</span><br><span class="line">3991</span><br><span class="line">3992</span><br><span class="line">3993</span><br><span class="line">3994</span><br><span class="line">3995</span><br><span class="line">3996</span><br><span class="line">3997</span><br><span class="line">3998</span><br><span class="line">3999</span><br><span class="line">4000</span><br><span class="line">4001</span><br><span class="line">4002</span><br><span class="line">4003</span><br><span class="line">4004</span><br><span class="line">4005</span><br><span class="line">4006</span><br><span class="line">4007</span><br><span class="line">4008</span><br><span class="line">4009</span><br><span class="line">4010</span><br><span class="line">4011</span><br><span class="line">4012</span><br><span class="line">4013</span><br><span class="line">4014</span><br><span class="line">4015</span><br><span class="line">4016</span><br><span class="line">4017</span><br><span class="line">4018</span><br><span class="line">4019</span><br><span class="line">4020</span><br><span class="line">4021</span><br><span class="line">4022</span><br><span class="line">4023</span><br><span class="line">4024</span><br><span class="line">4025</span><br><span class="line">4026</span><br><span class="line">4027</span><br><span class="line">4028</span><br><span class="line">4029</span><br><span class="line">4030</span><br><span class="line">4031</span><br><span class="line">4032</span><br><span class="line">4033</span><br><span class="line">4034</span><br><span class="line">4035</span><br><span class="line">4036</span><br><span class="line">4037</span><br><span class="line">4038</span><br><span class="line">4039</span><br><span class="line">4040</span><br><span class="line">4041</span><br><span class="line">4042</span><br><span class="line">4043</span><br><span class="line">4044</span><br><span class="line">4045</span><br><span class="line">4046</span><br><span class="line">4047</span><br><span class="line">4048</span><br><span class="line">4049</span><br><span class="line">4050</span><br><span class="line">4051</span><br><span class="line">4052</span><br><span class="line">4053</span><br><span class="line">4054</span><br><span class="line">4055</span><br><span class="line">4056</span><br><span class="line">4057</span><br><span class="line">4058</span><br><span class="line">4059</span><br><span class="line">4060</span><br><span class="line">4061</span><br><span class="line">4062</span><br><span class="line">4063</span><br><span class="line">4064</span><br><span class="line">4065</span><br><span class="line">4066</span><br><span class="line">4067</span><br><span class="line">4068</span><br><span class="line">4069</span><br><span class="line">4070</span><br><span class="line">4071</span><br><span class="line">4072</span><br><span class="line">4073</span><br><span class="line">4074</span><br><span class="line">4075</span><br><span class="line">4076</span><br><span class="line">4077</span><br><span class="line">4078</span><br><span class="line">4079</span><br><span class="line">4080</span><br><span class="line">4081</span><br><span class="line">4082</span><br><span class="line">4083</span><br><span class="line">4084</span><br><span class="line">4085</span><br><span class="line">4086</span><br><span class="line">4087</span><br><span class="line">4088</span><br><span class="line">4089</span><br><span class="line">4090</span><br><span class="line">4091</span><br><span class="line">4092</span><br><span class="line">4093</span><br><span class="line">4094</span><br><span class="line">4095</span><br><span class="line">4096</span><br><span class="line">4097</span><br><span class="line">4098</span><br><span class="line">4099</span><br><span class="line">4100</span><br><span class="line">4101</span><br><span class="line">4102</span><br><span class="line">4103</span><br><span class="line">4104</span><br><span class="line">4105</span><br><span class="line">4106</span><br><span class="line">4107</span><br><span class="line">4108</span><br><span class="line">4109</span><br><span class="line">4110</span><br><span class="line">4111</span><br><span class="line">4112</span><br><span class="line">4113</span><br><span class="line">4114</span><br><span class="line">4115</span><br><span class="line">4116</span><br><span class="line">4117</span><br><span class="line">4118</span><br><span class="line">4119</span><br><span class="line">4120</span><br><span class="line">4121</span><br><span class="line">4122</span><br><span class="line">4123</span><br><span class="line">4124</span><br><span class="line">4125</span><br><span class="line">4126</span><br><span class="line">4127</span><br><span class="line">4128</span><br><span class="line">4129</span><br><span class="line">4130</span><br><span class="line">4131</span><br><span class="line">4132</span><br><span class="line">4133</span><br><span class="line">4134</span><br><span class="line">4135</span><br><span class="line">4136</span><br><span class="line">4137</span><br><span class="line">4138</span><br><span class="line">4139</span><br><span class="line">4140</span><br><span class="line">4141</span><br><span class="line">4142</span><br><span class="line">4143</span><br><span class="line">4144</span><br><span class="line">4145</span><br><span class="line">4146</span><br><span class="line">4147</span><br><span class="line">4148</span><br><span class="line">4149</span><br><span class="line">4150</span><br><span class="line">4151</span><br><span class="line">4152</span><br><span class="line">4153</span><br><span class="line">4154</span><br><span class="line">4155</span><br><span class="line">4156</span><br><span class="line">4157</span><br><span class="line">4158</span><br><span class="line">4159</span><br><span class="line">4160</span><br><span class="line">4161</span><br><span class="line">4162</span><br><span class="line">4163</span><br><span class="line">4164</span><br><span class="line">4165</span><br><span class="line">4166</span><br><span class="line">4167</span><br><span class="line">4168</span><br><span class="line">4169</span><br><span class="line">4170</span><br><span class="line">4171</span><br><span class="line">4172</span><br><span class="line">4173</span><br><span class="line">4174</span><br><span class="line">4175</span><br><span class="line">4176</span><br><span class="line">4177</span><br><span class="line">4178</span><br><span class="line">4179</span><br><span class="line">4180</span><br><span class="line">4181</span><br><span class="line">4182</span><br><span class="line">4183</span><br><span class="line">4184</span><br><span class="line">4185</span><br><span class="line">4186</span><br><span class="line">4187</span><br><span class="line">4188</span><br><span class="line">4189</span><br><span class="line">4190</span><br><span class="line">4191</span><br><span class="line">4192</span><br><span class="line">4193</span><br><span class="line">4194</span><br><span class="line">4195</span><br><span class="line">4196</span><br><span class="line">4197</span><br><span class="line">4198</span><br><span class="line">4199</span><br><span class="line">4200</span><br><span class="line">4201</span><br><span class="line">4202</span><br><span class="line">4203</span><br><span class="line">4204</span><br><span class="line">4205</span><br><span class="line">4206</span><br><span class="line">4207</span><br><span class="line">4208</span><br><span class="line">4209</span><br><span class="line">4210</span><br><span class="line">4211</span><br><span class="line">4212</span><br><span class="line">4213</span><br><span class="line">4214</span><br><span class="line">4215</span><br><span class="line">4216</span><br><span class="line">4217</span><br><span class="line">4218</span><br><span class="line">4219</span><br><span class="line">4220</span><br><span class="line">4221</span><br><span class="line">4222</span><br><span class="line">4223</span><br><span class="line">4224</span><br><span class="line">4225</span><br><span class="line">4226</span><br><span class="line">4227</span><br><span class="line">4228</span><br><span class="line">4229</span><br><span class="line">4230</span><br><span class="line">4231</span><br><span class="line">4232</span><br><span class="line">4233</span><br><span class="line">4234</span><br><span class="line">4235</span><br><span class="line">4236</span><br><span class="line">4237</span><br><span class="line">4238</span><br><span class="line">4239</span><br><span class="line">4240</span><br><span class="line">4241</span><br><span class="line">4242</span><br><span class="line">4243</span><br><span class="line">4244</span><br><span class="line">4245</span><br><span class="line">4246</span><br><span class="line">4247</span><br><span class="line">4248</span><br><span class="line">4249</span><br><span class="line">4250</span><br><span class="line">4251</span><br><span class="line">4252</span><br><span class="line">4253</span><br><span class="line">4254</span><br><span class="line">4255</span><br><span class="line">4256</span><br><span class="line">4257</span><br><span class="line">4258</span><br><span class="line">4259</span><br><span class="line">4260</span><br><span class="line">4261</span><br><span class="line">4262</span><br><span class="line">4263</span><br><span class="line">4264</span><br><span class="line">4265</span><br><span class="line">4266</span><br><span class="line">4267</span><br><span class="line">4268</span><br><span class="line">4269</span><br><span class="line">4270</span><br><span class="line">4271</span><br><span class="line">4272</span><br><span class="line">4273</span><br><span class="line">4274</span><br><span class="line">4275</span><br><span class="line">4276</span><br><span class="line">4277</span><br><span class="line">4278</span><br><span class="line">4279</span><br><span class="line">4280</span><br><span class="line">4281</span><br><span class="line">4282</span><br><span class="line">4283</span><br><span class="line">4284</span><br><span class="line">4285</span><br><span class="line">4286</span><br><span class="line">4287</span><br><span class="line">4288</span><br><span class="line">4289</span><br><span class="line">4290</span><br><span class="line">4291</span><br><span class="line">4292</span><br><span class="line">4293</span><br><span class="line">4294</span><br><span class="line">4295</span><br><span class="line">4296</span><br><span class="line">4297</span><br><span class="line">4298</span><br><span class="line">4299</span><br><span class="line">4300</span><br><span class="line">4301</span><br><span class="line">4302</span><br><span class="line">4303</span><br><span class="line">4304</span><br><span class="line">4305</span><br><span class="line">4306</span><br><span class="line">4307</span><br><span class="line">4308</span><br><span class="line">4309</span><br><span class="line">4310</span><br><span class="line">4311</span><br><span class="line">4312</span><br><span class="line">4313</span><br><span class="line">4314</span><br><span class="line">4315</span><br><span class="line">4316</span><br><span class="line">4317</span><br><span class="line">4318</span><br><span class="line">4319</span><br><span class="line">4320</span><br><span class="line">4321</span><br><span class="line">4322</span><br><span class="line">4323</span><br><span class="line">4324</span><br><span class="line">4325</span><br><span class="line">4326</span><br><span class="line">4327</span><br><span class="line">4328</span><br><span class="line">4329</span><br><span class="line">4330</span><br><span class="line">4331</span><br><span class="line">4332</span><br><span class="line">4333</span><br><span class="line">4334</span><br><span class="line">4335</span><br><span class="line">4336</span><br><span class="line">4337</span><br><span class="line">4338</span><br><span class="line">4339</span><br><span class="line">4340</span><br><span class="line">4341</span><br><span class="line">4342</span><br><span class="line">4343</span><br><span class="line">4344</span><br><span class="line">4345</span><br><span class="line">4346</span><br><span class="line">4347</span><br><span class="line">4348</span><br><span class="line">4349</span><br><span class="line">4350</span><br><span class="line">4351</span><br><span class="line">4352</span><br><span class="line">4353</span><br><span class="line">4354</span><br><span class="line">4355</span><br><span class="line">4356</span><br><span class="line">4357</span><br><span class="line">4358</span><br><span class="line">4359</span><br><span class="line">4360</span><br><span class="line">4361</span><br><span class="line">4362</span><br><span class="line">4363</span><br><span class="line">4364</span><br><span class="line">4365</span><br><span class="line">4366</span><br><span class="line">4367</span><br><span class="line">4368</span><br><span class="line">4369</span><br><span class="line">4370</span><br><span class="line">4371</span><br><span class="line">4372</span><br><span class="line">4373</span><br><span class="line">4374</span><br><span class="line">4375</span><br><span class="line">4376</span><br><span class="line">4377</span><br><span class="line">4378</span><br><span class="line">4379</span><br><span class="line">4380</span><br><span class="line">4381</span><br><span class="line">4382</span><br><span class="line">4383</span><br><span class="line">4384</span><br><span class="line">4385</span><br><span class="line">4386</span><br><span class="line">4387</span><br><span class="line">4388</span><br><span class="line">4389</span><br><span class="line">4390</span><br><span class="line">4391</span><br><span class="line">4392</span><br><span class="line">4393</span><br><span class="line">4394</span><br><span class="line">4395</span><br><span class="line">4396</span><br><span class="line">4397</span><br><span class="line">4398</span><br><span class="line">4399</span><br><span class="line">4400</span><br><span class="line">4401</span><br><span class="line">4402</span><br><span class="line">4403</span><br><span class="line">4404</span><br><span class="line">4405</span><br><span class="line">4406</span><br><span class="line">4407</span><br><span class="line">4408</span><br><span class="line">4409</span><br><span class="line">4410</span><br><span class="line">4411</span><br><span class="line">4412</span><br><span class="line">4413</span><br><span class="line">4414</span><br><span class="line">4415</span><br><span class="line">4416</span><br><span class="line">4417</span><br><span class="line">4418</span><br><span class="line">4419</span><br><span class="line">4420</span><br><span class="line">4421</span><br><span class="line">4422</span><br><span class="line">4423</span><br><span class="line">4424</span><br><span class="line">4425</span><br><span class="line">4426</span><br><span class="line">4427</span><br><span class="line">4428</span><br><span class="line">4429</span><br><span class="line">4430</span><br><span class="line">4431</span><br><span class="line">4432</span><br><span class="line">4433</span><br><span class="line">4434</span><br><span class="line">4435</span><br><span class="line">4436</span><br><span class="line">4437</span><br><span class="line">4438</span><br><span class="line">4439</span><br><span class="line">4440</span><br><span class="line">4441</span><br><span class="line">4442</span><br><span class="line">4443</span><br><span class="line">4444</span><br><span class="line">4445</span><br><span class="line">4446</span><br><span class="line">4447</span><br><span class="line">4448</span><br><span class="line">4449</span><br><span class="line">4450</span><br><span class="line">4451</span><br><span class="line">4452</span><br><span class="line">4453</span><br><span class="line">4454</span><br><span class="line">4455</span><br><span class="line">4456</span><br><span class="line">4457</span><br><span class="line">4458</span><br><span class="line">4459</span><br><span class="line">4460</span><br><span class="line">4461</span><br><span class="line">4462</span><br><span class="line">4463</span><br><span class="line">4464</span><br><span class="line">4465</span><br><span class="line">4466</span><br><span class="line">4467</span><br><span class="line">4468</span><br><span class="line">4469</span><br><span class="line">4470</span><br><span class="line">4471</span><br><span class="line">4472</span><br><span class="line">4473</span><br><span class="line">4474</span><br><span class="line">4475</span><br><span class="line">4476</span><br><span class="line">4477</span><br><span class="line">4478</span><br><span class="line">4479</span><br><span class="line">4480</span><br><span class="line">4481</span><br><span class="line">4482</span><br><span class="line">4483</span><br><span class="line">4484</span><br><span class="line">4485</span><br><span class="line">4486</span><br><span class="line">4487</span><br><span class="line">4488</span><br><span class="line">4489</span><br><span class="line">4490</span><br><span class="line">4491</span><br><span class="line">4492</span><br><span class="line">4493</span><br><span class="line">4494</span><br><span class="line">4495</span><br><span class="line">4496</span><br><span class="line">4497</span><br><span class="line">4498</span><br><span class="line">4499</span><br><span class="line">4500</span><br><span class="line">4501</span><br><span class="line">4502</span><br><span class="line">4503</span><br><span class="line">4504</span><br><span class="line">4505</span><br><span class="line">4506</span><br><span class="line">4507</span><br><span class="line">4508</span><br><span class="line">4509</span><br><span class="line">4510</span><br><span class="line">4511</span><br><span class="line">4512</span><br><span class="line">4513</span><br><span class="line">4514</span><br><span class="line">4515</span><br><span class="line">4516</span><br><span class="line">4517</span><br><span class="line">4518</span><br><span class="line">4519</span><br><span class="line">4520</span><br><span class="line">4521</span><br><span class="line">4522</span><br><span class="line">4523</span><br><span class="line">4524</span><br><span class="line">4525</span><br><span class="line">4526</span><br><span class="line">4527</span><br><span class="line">4528</span><br><span class="line">4529</span><br><span class="line">4530</span><br><span class="line">4531</span><br><span class="line">4532</span><br><span class="line">4533</span><br><span class="line">4534</span><br><span class="line">4535</span><br><span class="line">4536</span><br><span class="line">4537</span><br><span class="line">4538</span><br><span class="line">4539</span><br><span class="line">4540</span><br><span class="line">4541</span><br><span class="line">4542</span><br><span class="line">4543</span><br><span class="line">4544</span><br><span class="line">4545</span><br><span class="line">4546</span><br><span class="line">4547</span><br><span class="line">4548</span><br><span class="line">4549</span><br><span class="line">4550</span><br><span class="line">4551</span><br><span class="line">4552</span><br><span class="line">4553</span><br><span class="line">4554</span><br><span class="line">4555</span><br><span class="line">4556</span><br><span class="line">4557</span><br><span class="line">4558</span><br><span class="line">4559</span><br><span class="line">4560</span><br><span class="line">4561</span><br><span class="line">4562</span><br><span class="line">4563</span><br><span class="line">4564</span><br><span class="line">4565</span><br><span class="line">4566</span><br><span class="line">4567</span><br><span class="line">4568</span><br><span class="line">4569</span><br><span class="line">4570</span><br><span class="line">4571</span><br><span class="line">4572</span><br><span class="line">4573</span><br><span class="line">4574</span><br><span class="line">4575</span><br><span class="line">4576</span><br><span class="line">4577</span><br><span class="line">4578</span><br><span class="line">4579</span><br><span class="line">4580</span><br><span class="line">4581</span><br><span class="line">4582</span><br><span class="line">4583</span><br><span class="line">4584</span><br><span class="line">4585</span><br><span class="line">4586</span><br><span class="line">4587</span><br><span class="line">4588</span><br><span class="line">4589</span><br><span class="line">4590</span><br><span class="line">4591</span><br><span class="line">4592</span><br><span class="line">4593</span><br><span class="line">4594</span><br><span class="line">4595</span><br><span class="line">4596</span><br><span class="line">4597</span><br><span class="line">4598</span><br><span class="line">4599</span><br><span class="line">4600</span><br><span class="line">4601</span><br><span class="line">4602</span><br><span class="line">4603</span><br><span class="line">4604</span><br><span class="line">4605</span><br><span class="line">4606</span><br><span class="line">4607</span><br><span class="line">4608</span><br><span class="line">4609</span><br><span class="line">4610</span><br><span class="line">4611</span><br><span class="line">4612</span><br><span class="line">4613</span><br><span class="line">4614</span><br><span class="line">4615</span><br><span class="line">4616</span><br><span class="line">4617</span><br><span class="line">4618</span><br><span class="line">4619</span><br><span class="line">4620</span><br><span class="line">4621</span><br><span class="line">4622</span><br><span class="line">4623</span><br><span class="line">4624</span><br><span class="line">4625</span><br><span class="line">4626</span><br><span class="line">4627</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//                                                                            //</span></span><br><span class="line"><span class="comment">//                        OLLYDBG 2 PLUGIN HEADER FILE                        //</span></span><br><span class="line"><span class="comment">//                                                                            //</span></span><br><span class="line"><span class="comment">//                                Version 2.01                                //</span></span><br><span class="line"><span class="comment">//                                                                            //</span></span><br><span class="line"><span class="comment">//               Written by Oleh Yuschuk (ollydbg@t-online.de)                //</span></span><br><span class="line"><span class="comment">//                                                                            //</span></span><br><span class="line"><span class="comment">//                          Internet: www.ollydbg.de                          //</span></span><br><span class="line"><span class="comment">//                                                                            //</span></span><br><span class="line"><span class="comment">// This code is distributed &quot;as is&quot;, without warranty of any kind, expressed  //</span></span><br><span class="line"><span class="comment">// or implied, including, but not limited to warranty of fitness for any      //</span></span><br><span class="line"><span class="comment">// particular purpose. In no event will Oleh Yuschuk be liable to you for any //</span></span><br><span class="line"><span class="comment">// special, incidental, indirect, consequential or any other damages caused   //</span></span><br><span class="line"><span class="comment">// by the use, misuse, or the inability to use of this code, including any    //</span></span><br><span class="line"><span class="comment">// lost profits or lost savings, even if Oleh Yuschuk has been advised of the //</span></span><br><span class="line"><span class="comment">// possibility of such damages.                                               //</span></span><br><span class="line"><span class="comment">//                                                                            //</span></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __ODBG_PLUGIN_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __ODBG_PLUGIN_H</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// OD 2.0 版本的插件接口</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PLUGIN_VERSION 0x02010001      <span class="comment">// Version 2.01.0001 of plugin interface</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//////////////////////////// IMPORTANT INFORMATION /////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. Plugins are UNICODE libraries!</span></span><br><span class="line"><span class="comment">// 1. 插件必须使用Unicode版本的库</span></span><br><span class="line"><span class="comment">// 2. Export all callback functions by name, NOT by ordinal!</span></span><br><span class="line"><span class="comment">// 3. Force byte alignment of OllyDbg structures!</span></span><br><span class="line"><span class="comment">// 4. Set default char type to unsigned!</span></span><br><span class="line"><span class="comment">// 5. Most API functions are NOT thread-safe!</span></span><br><span class="line"><span class="comment">// 6. Read documentation!</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> !defined(_UNICODE) &amp;&amp; !defined(UNICODE)</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">error</span> This version must be compiled with UNICODE on</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////// PREFERRED SETTINGS AND FIXES FOR BORLAND COMPILERS //////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __BORLANDC__</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">pragma</span> option -a1                   <span class="comment">// Byte alignment</span></span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">pragma</span> option -K                    <span class="comment">// Force unsigned characters!</span></span></span><br><span class="line">  <span class="comment">// Redefinition of MAKELONG removes nasty warning under Borland Builder 4.0:</span></span><br><span class="line">  <span class="comment">// boolean OR in one row with arithmetical shift.</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">undef</span>  MAKELONG</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> MAKELONG(lo,hi) ((LONG)(((WORD)(lo))|(((DWORD)((WORD)(hi)))&lt;&lt;16)))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">///////////// PREFERRED SETTINGS AND FIXES FOR MICROSOFT COMPILERS /////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// If you like Microsoft compiler, this will force byte alignment and verify</span></span><br><span class="line"><span class="comment">// that character is set to unsigned.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _MSC_VER</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">pragma</span> pack(1)                      <span class="comment">// Force byte alignment of structures</span></span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">ifndef</span> _CHAR_UNSIGNED               <span class="comment">// Verify that character is unsigned</span></span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">error</span> Please set default char type to unsigned (option /J)</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//////////////////// PREFERRED SETTINGS AND FIXES FOR MINGW ////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __MINGW32__</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">pragma</span> pack(1)                      <span class="comment">// Force byte alignment of structures</span></span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">ifndef</span> __CHAR_UNSIGNED__            <span class="comment">// Verify that character is unsigned</span></span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">error</span> Please set default char type to unsigned (option -funsigned-char)</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////////////////// GLOBAL DEFINITIONS //////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _export</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> _export      __declspec(dllexport)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _import</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> _import      __declspec(dllimport)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _USERENTRY</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> _USERENTRY   __cdecl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAKEWP(lo,hi)  ((WPARAM)MAKELONG(lo,hi))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAKELP(lo,hi)  ((LPARAM)MAKELONG(lo,hi))</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LOINT(l)       ((signed short)((WORD)(l)))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HIINT(l)       ((signed short)(((DWORD)(l)&gt;&gt;16) &amp; 0xFFFF))</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MAXPATH</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> MAXPATH      MAX_PATH</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> FIELD_OFFSET</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> FIELD_OFFSET(type,field) ((LONG)&amp;(((type *)0)-&gt;field))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> arraysize</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> arraysize(x) (sizeof(x)/sizeof(x[0]))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TEXTLEN        256             <span class="comment">// Max length of text string incl. &#x27;\0&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DATALEN        4096            <span class="comment">// Max length of data record (max 65535)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ARGLEN         1024            <span class="comment">// Max length of argument string</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXMULTIPATH   8192            <span class="comment">// Max length of multiple selection</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SHORTNAME      32              <span class="comment">// Max length of short or module name</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">char</span>  uchar;          <span class="comment">// Unsigned character (byte)</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">short</span> ushort;         <span class="comment">// Unsigned short</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span>   uint;           <span class="comment">// Unsigned integer</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span>  ulong;          <span class="comment">// Unsigned long</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Exports used by plugins are declared as stdapi if they use fixed number of</span></span><br><span class="line"><span class="comment">// arguments, and varapi if variable or if code is written in Assembler</span></span><br><span class="line"><span class="comment">// language (I use C calling conventions). OllyDbg variables are declared as</span></span><br><span class="line"><span class="comment">// oddata.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> extc         extern <span class="meta-string">&quot;C&quot;</span> _export</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> stdapi(type) extern <span class="meta-string">&quot;C&quot;</span>               type __cdecl</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> varapi(type) extern <span class="meta-string">&quot;C&quot;</span>               type __cdecl</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> oddata(type) extern <span class="meta-string">&quot;C&quot;</span> const _import type</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> pentry(type) extern <span class="meta-string">&quot;C&quot;</span> _export       type __cdecl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> extc         extern     _export</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> stdapi(type) extern                   type __cdecl</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> varapi(type) extern                   type __cdecl</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> oddata(type) extern     const _import type</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">define</span> pentry(type) extern     _export       type __cdecl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////////////////// FORWARD REFERENCES //////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">t_table</span>;</span>                        <span class="comment">// Forward reference</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">t_module</span>;</span>                       <span class="comment">// Forward reference</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">t_dump</span>;</span>                         <span class="comment">// Forward reference</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////////////////// SERVICE FUNCTIONS ///////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Flags returned by functions Istext.../Israre...</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PLAINASCII     0x01            <span class="comment">// Plain ASCII character</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIACRITICAL    0x02            <span class="comment">// Diacritical character</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RAREASCII      0x10            <span class="comment">// Rare ASCII character</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Flags used by Memalloc() and Virtalloc(). Note that Virtalloc() alwyas</span></span><br><span class="line"><span class="comment">// initializes memory to zero.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REPORT         0x0000          <span class="comment">// Report memory allocation errors</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SILENT         0x0001          <span class="comment">// Don&#x27;t report allocation errors</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ZEROINIT       0x0002          <span class="comment">// Initialize memory to 0</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CONT_BROADCAST 0x0000          <span class="comment">// Continue sending msg to MDI windows</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STOP_BROADCAST 0x1234          <span class="comment">// Stop sending message to MDI windows</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Symbol decoding mode, used by Decodethreadname(), Decodeaddress() and</span></span><br><span class="line"><span class="comment">// Decoderelativeoffset().</span></span><br><span class="line"><span class="comment">// Bits that determine when to decode and comment name at all.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_VALID       0x00000001      <span class="comment">// Only decode if memory exists</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_INMOD       0x00000002      <span class="comment">// Only decode if in module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_SAMEMOD     0x00000004      <span class="comment">// Only decode if in same module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_SYMBOL      0x00000008      <span class="comment">// Only decode if direct symbolic name</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_NONTRIVIAL  0x00000010      <span class="comment">// Only decode if nontrivial form</span></span></span><br><span class="line"><span class="comment">// Bits that control name format.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_BINARY      0x00000100      <span class="comment">// Don&#x27;t use symbolic form</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_DIFBIN      0x00000200      <span class="comment">// No symbolic form if different module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_WIDEFORM    0x00000400      <span class="comment">// Extended form (8 digits by hex)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_CAPITAL     0x00000800      <span class="comment">// First letter in uppercase if possible</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_OFFSET      0x00001000      <span class="comment">// Add &#x27;OFFSET&#x27; if data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_JUMPIMP     0x00002000      <span class="comment">// Check if points to JMP to import</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_DYNAMIC     0x00004000      <span class="comment">// Check if points to JMP to DLL</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_ORDINAL     0x00008000      <span class="comment">// Add ordinal to thread&#x27;s name</span></span></span><br><span class="line"><span class="comment">// Bits that control whether address is preceded with module name.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_NOMODNAME   0x00000000      <span class="comment">// Never add module name</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_DIFFMODNAME 0x00010000      <span class="comment">// Add name only if different module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_MODNAME     0x00020000      <span class="comment">// Always add module name</span></span></span><br><span class="line"><span class="comment">// Bits that control comments.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_STRING      0x00100000      <span class="comment">// Check if pointer to ASCII or UNICODE</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_STRPTR      0x00200000      <span class="comment">// Check if points to pointer to text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_FOLLOW      0x00400000      <span class="comment">// Check if follows to different symbol</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_ENTRY       0x00800000      <span class="comment">// Check if unnamed entry to subroutine</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_EFORCE      0x01000000      <span class="comment">// Check if named entry, too</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_DIFFMOD     0x02000000      <span class="comment">// Check if points to different module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_RELOFFS     0x04000000      <span class="comment">// Check if points inside subroutine</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_ANALYSED    0x08000000      <span class="comment">// Check if points to decoded data</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Standard commenting mode. Note: DM_DIFFMOD and DM_RELOFFS are not included.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DM_COMMENT     (DM_STRING|DM_STRPTR|DM_FOLLOW|DM_ENTRY|DM_ANALYSED)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Address decoding mode, used by Labeladdress().</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADDR_SYMMASK   0x00000003      <span class="comment">// Mask to extract sym presentation mode</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   ADDR_HEXSYM  0x00000000      <span class="comment">// Hex, followed by symbolic name</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   ADDR_SYMHEX  0x00000001      <span class="comment">// Symbolic name, followed by hex</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   ADDR_SINGLE  0x00000002      <span class="comment">// Symbolic name, or hex if none</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   ADDR_HEXONLY 0x00000003      <span class="comment">// Only hexadecimal address</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADDR_MODNAME   0x00000004      <span class="comment">// Add module name to symbol</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADDR_FORCEMOD  0x00000008      <span class="comment">// (ADDR_SINGLE) Always add module name</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADDR_GRAYHEX   0x00000010      <span class="comment">// Gray hex</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADDR_HILSYM    0x00000020      <span class="comment">// Highlight symbolic name</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADDR_NODEFMEP  0x00000100      <span class="comment">// Do not show &lt;ModuleEntryPoint&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADDR_BREAK     0x00000200      <span class="comment">// Mark as unconditional breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADDR_CONDBRK   0x00000400      <span class="comment">// Mark as conditional breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADDR_DISBRK    0x00000800      <span class="comment">// Mark as disabled breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADDR_EIP       0x00001000      <span class="comment">// Mark as actual EIP</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADDR_CHECKEIP  0x00002000      <span class="comment">// Mark as EIP if EIP of CPU thread</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADDR_SHOWNULL  0x00004000      <span class="comment">// Display address 0</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Mode bits and return value of Browsefilename().</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BRO_MODEMASK   0xF0000000      <span class="comment">// Mask to extract browsing mode</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BRO_FILE     0x00000000      <span class="comment">// Get file name</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BRO_EXE      0x10000000      <span class="comment">// Get name of executable</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BRO_TEXT     0x20000000      <span class="comment">// Get name of text log</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BRO_GROUP    0x30000000      <span class="comment">// Get one or several obj or lib files</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BRO_MULTI    0x40000000      <span class="comment">// Get one or several files</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BRO_SAVE       0x08000000      <span class="comment">// Get name in save mode</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BRO_SINGLE     0x00800000      <span class="comment">// Single file selected</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BRO_MULTIPLE   0x00400000      <span class="comment">// Multiple files selected</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BRO_APPEND     0x00080000      <span class="comment">// Append to existing file</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BRO_ACTUAL     0x00040000      <span class="comment">// Add actual contents</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BRO_TABS       0x00020000      <span class="comment">// Separate columns with tabs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BRO_GROUPMASK  0x000000FF      <span class="comment">// Mask to extract groups</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BRO_GROUP1   0x00000001      <span class="comment">// Belongs to group 1</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BRO_GROUP2   0x00000002      <span class="comment">// Belongs to group 2</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BRO_GROUP3   0x00000004      <span class="comment">// Belongs to group 3</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BRO_GROUP4   0x00000008      <span class="comment">// Belongs to group 4</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// String decoding modes.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DS_DIR         0               <span class="comment">// Direct quote</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DS_ASM         1               <span class="comment">// Assembler style</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DS_C           2               <span class="comment">// C style</span></span></span><br><span class="line"></span><br><span class="line">varapi (<span class="keyword">void</span>)    Error(<span class="keyword">wchar_t</span> *format,...);</span><br><span class="line">varapi (<span class="keyword">void</span>)    Conderror(<span class="keyword">int</span> *cond,<span class="keyword">wchar_t</span> *title,<span class="keyword">wchar_t</span> *format,...);</span><br><span class="line">varapi (<span class="keyword">int</span>)     Condyesno(<span class="keyword">int</span> *cond,<span class="keyword">wchar_t</span> *title,<span class="keyword">wchar_t</span> *format,...);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Stringfromini(<span class="keyword">wchar_t</span> *section,<span class="keyword">wchar_t</span> *key,<span class="keyword">wchar_t</span> *s,</span><br><span class="line">                   <span class="keyword">int</span> length);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Filefromini(<span class="keyword">wchar_t</span> *key,<span class="keyword">wchar_t</span> *name,<span class="keyword">wchar_t</span> *defname);</span><br><span class="line">varapi (<span class="keyword">int</span>)     Getfromini(<span class="keyword">wchar_t</span> *file,<span class="keyword">wchar_t</span> *section,<span class="keyword">wchar_t</span> *key,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *format,...);</span><br><span class="line">varapi (<span class="keyword">int</span>)     Writetoini(<span class="keyword">wchar_t</span> *file,<span class="keyword">wchar_t</span> *section,<span class="keyword">wchar_t</span> *key,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *format,...);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Filetoini(<span class="keyword">wchar_t</span> *key,<span class="keyword">wchar_t</span> *name);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Deleteinisection(<span class="keyword">wchar_t</span> *file,<span class="keyword">wchar_t</span> *section);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getfromsettings(<span class="keyword">wchar_t</span> *key,<span class="keyword">int</span> defvalue);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Addtosettings(<span class="keyword">wchar_t</span> *key,<span class="keyword">int</span> value);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Replacegraphs(<span class="keyword">int</span> mode,<span class="keyword">wchar_t</span> *s,uchar *mask,</span><br><span class="line">                   <span class="keyword">int</span> select,<span class="keyword">int</span> n);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Unicodetoascii(<span class="keyword">const</span> <span class="keyword">wchar_t</span> *w,<span class="keyword">int</span> nw,<span class="keyword">char</span> *s,<span class="keyword">int</span> ns);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Asciitounicode(<span class="keyword">const</span> <span class="keyword">char</span> *s,<span class="keyword">int</span> ns,<span class="keyword">wchar_t</span> *w,<span class="keyword">int</span> nw);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Unicodetoutf(<span class="keyword">const</span> <span class="keyword">wchar_t</span> *w,<span class="keyword">int</span> nw,<span class="keyword">char</span> *t,<span class="keyword">int</span> nt);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Utftounicode(<span class="keyword">const</span> <span class="keyword">char</span> *t,<span class="keyword">int</span> nt,<span class="keyword">wchar_t</span> *w,<span class="keyword">int</span> nw);</span><br><span class="line">stdapi (HGLOBAL) Unicodebuffertoascii(HGLOBAL hunicode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Iszero(<span class="keyword">void</span> *data,<span class="keyword">int</span> n);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Guidtotext(uchar *guid,<span class="keyword">wchar_t</span> *s);</span><br><span class="line">varapi (<span class="keyword">int</span>)     Swprintf(<span class="keyword">wchar_t</span> *s,<span class="keyword">wchar_t</span> *format,...);</span><br><span class="line">stdapi (<span class="keyword">void</span> *)  Memalloc(ulong size,<span class="keyword">int</span> flags);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Memfree(<span class="keyword">void</span> *data);</span><br><span class="line">stdapi (<span class="keyword">void</span> *)  Mempurge(<span class="keyword">void</span> *data,<span class="keyword">int</span> count,ulong itemsize,<span class="keyword">int</span> *newcount);</span><br><span class="line">stdapi (<span class="keyword">void</span> *)  Memdouble(<span class="keyword">void</span> *data,<span class="keyword">int</span> *pcount,ulong itemsize,</span><br><span class="line">                   <span class="keyword">int</span> *failed,<span class="keyword">int</span> flags);</span><br><span class="line">stdapi (<span class="keyword">void</span> *)  Virtalloc(ulong size,<span class="keyword">int</span> flags);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Virtfree(<span class="keyword">void</span> *data);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Broadcast(UINT msg,WPARAM wp,LPARAM lp);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Browsefilename(<span class="keyword">wchar_t</span> *title,<span class="keyword">wchar_t</span> *name,<span class="keyword">wchar_t</span> *args,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *currdir,<span class="keyword">wchar_t</span> *defext,HWND hwnd,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Browsedirectory(HWND hw,<span class="keyword">wchar_t</span> *comment,<span class="keyword">wchar_t</span> *dir);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Relativizepath(<span class="keyword">wchar_t</span> *path);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Absolutizepath(<span class="keyword">wchar_t</span> *path);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Confirmoverwrite(<span class="keyword">wchar_t</span> *path);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Labeladdress(<span class="keyword">wchar_t</span> *text,ulong addr,ulong reladdr,<span class="keyword">int</span> relreg,</span><br><span class="line">                   <span class="keyword">int</span> index,uchar *mask,<span class="keyword">int</span> *select,ulong mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Simpleaddress(<span class="keyword">wchar_t</span> *text,ulong addr,</span><br><span class="line">                   uchar *mask,<span class="keyword">int</span> *select);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Heapsort(<span class="keyword">void</span> *data,<span class="keyword">const</span> <span class="keyword">int</span> count,<span class="keyword">const</span> <span class="keyword">int</span> size,</span><br><span class="line">                   <span class="keyword">int</span> (_USERENTRY *compare)(<span class="keyword">const</span> <span class="keyword">void</span> *,<span class="keyword">const</span> <span class="keyword">void</span> *));</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Heapsortex(<span class="keyword">void</span> *data,<span class="keyword">const</span> <span class="keyword">int</span> count,<span class="keyword">const</span> <span class="keyword">int</span> size,</span><br><span class="line">                   <span class="keyword">int</span> (_USERENTRY *compareex)(<span class="keyword">const</span> <span class="keyword">void</span> *,<span class="keyword">const</span> <span class="keyword">void</span> *,ulong),</span><br><span class="line">                   ulong lp);</span><br><span class="line">stdapi (uchar *) Readfile(<span class="keyword">wchar_t</span> *path,ulong fixsize,ulong *psize);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Devicenametodosname(<span class="keyword">wchar_t</span> *devname,<span class="keyword">wchar_t</span> *dosname);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Filenamefromhandle(HANDLE hfile,<span class="keyword">wchar_t</span> *path);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Quicktimerstart(<span class="keyword">int</span> timer);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Quicktimerstop(<span class="keyword">int</span> timer);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Quicktimerflush(<span class="keyword">int</span> timer);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////// FAST SERVICE ROUTINES WRITTEN IN ASSEMBLER //////////////////</span></span><br><span class="line"></span><br><span class="line">varapi (<span class="keyword">int</span>)     StrcopyA(<span class="keyword">char</span> *dest,<span class="keyword">int</span> n,<span class="keyword">const</span> <span class="keyword">char</span> *src);</span><br><span class="line">varapi (<span class="keyword">int</span>)     StrcopyW(<span class="keyword">wchar_t</span> *dest,<span class="keyword">int</span> n,<span class="keyword">const</span> <span class="keyword">wchar_t</span> *src);</span><br><span class="line">varapi (<span class="keyword">int</span>)     StrlenA(<span class="keyword">const</span> <span class="keyword">char</span> *src,<span class="keyword">int</span> n);</span><br><span class="line">varapi (<span class="keyword">int</span>)     StrlenW(<span class="keyword">const</span> <span class="keyword">wchar_t</span> *src,<span class="keyword">int</span> n);</span><br><span class="line">varapi (<span class="keyword">int</span>)     HexprintA(<span class="keyword">char</span> *s,ulong u);</span><br><span class="line">varapi (<span class="keyword">int</span>)     HexprintW(<span class="keyword">wchar_t</span> *s,ulong u);</span><br><span class="line">varapi (<span class="keyword">int</span>)     Hexprint4A(<span class="keyword">char</span> *s,ulong u);</span><br><span class="line">varapi (<span class="keyword">int</span>)     Hexprint4W(<span class="keyword">wchar_t</span> *s,ulong u);</span><br><span class="line">varapi (<span class="keyword">int</span>)     Hexprint8A(<span class="keyword">char</span> *s,ulong u);</span><br><span class="line">varapi (<span class="keyword">int</span>)     Hexprint8W(<span class="keyword">wchar_t</span> *s,ulong u);</span><br><span class="line">varapi (<span class="keyword">int</span>)     SignedhexA(<span class="keyword">char</span> *s,ulong u);</span><br><span class="line">varapi (<span class="keyword">int</span>)     SignedhexW(<span class="keyword">wchar_t</span> *s,ulong u);</span><br><span class="line">varapi (<span class="keyword">void</span>)    Swapmem(<span class="keyword">void</span> *base,<span class="keyword">int</span> size,<span class="keyword">int</span> i1,<span class="keyword">int</span> i2);</span><br><span class="line">varapi (<span class="keyword">int</span>)     HexdumpA(<span class="keyword">char</span> *s,uchar *code,<span class="keyword">int</span> n);</span><br><span class="line">varapi (<span class="keyword">int</span>)     HexdumpW(<span class="keyword">wchar_t</span> *s,uchar *code,<span class="keyword">int</span> n);</span><br><span class="line">varapi (<span class="keyword">int</span>)     Bitcount(ulong u);</span><br><span class="line"></span><br><span class="line">varapi (<span class="keyword">char</span> *)  SetcaseA(<span class="keyword">char</span> *s);</span><br><span class="line">varapi (<span class="keyword">wchar_t</span> *) SetcaseW(<span class="keyword">wchar_t</span> *s);</span><br><span class="line">varapi (<span class="keyword">int</span>)     StrcopycaseA(<span class="keyword">char</span> *dest,<span class="keyword">int</span> n,<span class="keyword">const</span> <span class="keyword">char</span> *src);</span><br><span class="line">varapi (<span class="keyword">int</span>)     StrcopycaseW(<span class="keyword">wchar_t</span> *dest,<span class="keyword">int</span> n,<span class="keyword">const</span> <span class="keyword">wchar_t</span> *src);</span><br><span class="line">varapi (<span class="keyword">int</span>)     StrnstrA(<span class="keyword">char</span> *data,<span class="keyword">int</span> ndata,</span><br><span class="line">                   <span class="keyword">char</span> *pat,<span class="keyword">int</span> npat,<span class="keyword">int</span> ignorecase);</span><br><span class="line">varapi (<span class="keyword">int</span>)     StrnstrW(<span class="keyword">wchar_t</span> *data,<span class="keyword">int</span> ndata,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *pat,<span class="keyword">int</span> npat,<span class="keyword">int</span> ignorecase);</span><br><span class="line">varapi (<span class="keyword">int</span>)     StrcmpW(<span class="keyword">const</span> <span class="keyword">wchar_t</span> *s1,<span class="keyword">const</span> <span class="keyword">wchar_t</span> *s2);</span><br><span class="line">varapi (ulong)   Div64by32(ulong low,ulong hi,ulong div);</span><br><span class="line">varapi (ulong)   CRCcalc(uchar *datacopy,ulong datasize);</span><br><span class="line">varapi (<span class="keyword">int</span>)     Getcpuidfeatures(<span class="keyword">void</span>);</span><br><span class="line">varapi (<span class="keyword">void</span>)    Maskfpu(<span class="keyword">void</span>);</span><br><span class="line">varapi (<span class="keyword">void</span>)    Clearfpu(<span class="keyword">void</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////////// DATA COMPRESSION AND DECOMPRESSION //////////////////////</span></span><br><span class="line"></span><br><span class="line">stdapi (ulong)   Compress(uchar *bufin,ulong nbufin,</span><br><span class="line">                   uchar *bufout,ulong nbufout);</span><br><span class="line">stdapi (ulong)   Getoriginaldatasize(uchar *bufin,ulong nbufin);</span><br><span class="line">stdapi (ulong)   Decompress(uchar *bufin,ulong nbufin,</span><br><span class="line">                   uchar *bufout,ulong nbufout);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">/////////////////////// TAGGED DATA FILES AND RESOURCES ////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_SIGNATURE   0x00646F4DL     <span class="comment">// Signature of tagged file</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_VERSION     0x7265560AL     <span class="comment">// File version</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_FILENAME    0x6C69460AL     <span class="comment">// Record with full name of executable</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_FILEINFO    0x7263460AL     <span class="comment">// Length, date, CRC (t_fileinfo)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_DATA        0x7461440AL     <span class="comment">// Name or data (t_nameinfo)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_CALLBRA     0x7262430AL     <span class="comment">// Call brackets</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_LOOPBRA     0x72624C0AL     <span class="comment">// Loop brackets</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_PROCDATA    0x6372500AL     <span class="comment">// Procedure data (set of t_procdata)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_INT3BREAK   0x336E490AL     <span class="comment">// INT3 breakpoint (t_bpoint)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_MEMBREAK    0x6D70420AL     <span class="comment">// Memory breakpoint (t_bpmem)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_HWBREAK     0x6870420AL     <span class="comment">// Hardware breakpoint (t_bphard)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_ANALYSIS    0x616E410AL     <span class="comment">// Record with analysis data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_SWITCH      0x6977530AL     <span class="comment">// Switch (addr+dt_switch)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_CASE        0x7361430AL     <span class="comment">// Case (addr+dt_case)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_MNEMO       0x656E4D0AL     <span class="comment">// Decoding of mnemonics (addr+dt_mnemo)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_JMPDATA     0x74644A0AL     <span class="comment">// Jump data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_NETSTREAM   0x74734E0AL     <span class="comment">// .NET streams (t_netstream)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_METADATA    0x74644D0AL     <span class="comment">// .NET MetaData tables (t_metadata)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_BINSAV      0x7673420AL     <span class="comment">// Last entered binary search patterns</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_MODDATA     0x61624D0AL     <span class="comment">// Module base, size and path</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_PREDICT     0x6472500AL     <span class="comment">// Predicted command execution results</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_LASTSAV     0x61734C0AL     <span class="comment">// Last entered strings (t_nameinfo)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_SAVEAREA    0x7661530AL     <span class="comment">// Save area (t_savearea)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_RTCOND      0x6374520AL     <span class="comment">// Run trace pause condition</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_RTPROT      0x7074520AL     <span class="comment">// Run trace protocol condition</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_WATCH       0x6374570AL     <span class="comment">// Watch in watch window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_LOADDLL     0x64644C0AL     <span class="comment">// Packed loaddll.exe</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_PATCH       0x7461500AL     <span class="comment">// Patch data (compressed t_patch)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_PLUGIN      0x676C500AL     <span class="comment">// Plugin prefix descriptor</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MI_END         0x646E450AL     <span class="comment">// End of tagged file</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> FILE                            <span class="comment">// Requires &lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_fileinfo</span> &#123;</span>            <span class="comment">// Length, date, CRC (MI_FILEINFO)</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Length of executable file</span></span><br><span class="line">  FILETIME       filetime;             <span class="comment">// Time of last modification</span></span><br><span class="line">  ulong          crc;                  <span class="comment">// CRC of executable file</span></span><br><span class="line">  <span class="keyword">int</span>            issfx;                <span class="comment">// Whether self-extractable</span></span><br><span class="line">  ulong          sfxentry;             <span class="comment">// Offset of original entry after SFX</span></span><br><span class="line">&#125; t_fileinfo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_tagfile</span> &#123;</span>             <span class="comment">// Descriptor of tagged file (reading)</span></span><br><span class="line">  FILE           *f;                   <span class="comment">// File descriptor</span></span><br><span class="line">  ulong          filesize;             <span class="comment">// File size</span></span><br><span class="line">  ulong          offset;               <span class="comment">// Actual offset</span></span><br><span class="line">  ulong          tag;                  <span class="comment">// Tag of next accessed record</span></span><br><span class="line">  ulong          recsize;              <span class="comment">// Size of next accessed record</span></span><br><span class="line">&#125; t_tagfile;</span><br><span class="line"></span><br><span class="line">stdapi (FILE *)  Createtaggedfile(<span class="keyword">wchar_t</span> *name,<span class="keyword">char</span> *signature,ulong version);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Savetaggedrecord(FILE *f,ulong tag,ulong size,<span class="keyword">void</span> *data);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Savepackedrecord(FILE *f,ulong tag,ulong size,<span class="keyword">void</span> *data);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Finalizetaggedfile(FILE *f);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Opentaggedfile(t_tagfile *tf,<span class="keyword">wchar_t</span> *name,<span class="keyword">char</span> *signature);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Gettaggedrecordsize(t_tagfile *tf,ulong *tag,ulong *size);</span><br><span class="line">stdapi (ulong)   Gettaggedfiledata(t_tagfile *tf,<span class="keyword">void</span> *buf,ulong bufsize);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Closetaggedfile(t_tagfile *tf);</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_nameinfo</span> &#123;</span>            <span class="comment">// Header of name/data record (MI_NAME)</span></span><br><span class="line">  ulong          offs;                 <span class="comment">// Offset in module</span></span><br><span class="line">  uchar          type;                 <span class="comment">// Name/data type, one of NM_xxx/DT_xxx</span></span><br><span class="line">&#125; t_nameinfo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_uddsave</span> &#123;</span>             <span class="comment">// .udd file descriptor used by plugins</span></span><br><span class="line">  <span class="keyword">void</span>           *file;                <span class="comment">// .udd file</span></span><br><span class="line">  ulong          uddprefix;            <span class="comment">// .udd tag prefix</span></span><br><span class="line">&#125; t_uddsave;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">int</span>)     Pluginsaverecord(t_uddsave *psave,ulong tag,</span><br><span class="line">                   ulong size,<span class="keyword">void</span> *data);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Pluginpackedrecord(t_uddsave *psave,ulong tag,</span><br><span class="line">                   ulong size,<span class="keyword">void</span> *data);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Pluginmodulechanged(ulong addr);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Plugingetuniquedatatype(<span class="keyword">void</span>);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Plugintempbreakpoint(ulong addr,ulong type,<span class="keyword">int</span> forceint3);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Pluginshowoptions(struct t_control *options);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">/////////////////////////////// LEXICAL SCANNER ////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SMODE_UPCASE   0x00000001      <span class="comment">// Convert keywords to uppercase</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SMODE_NOEOL    0x00000010      <span class="comment">// Don&#x27;t report SCAN_EOL, just skip it</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SMODE_NOSPEC   0x00000020      <span class="comment">// Don&#x27;t translate specsymbols</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SMODE_EXTKEY   0x00000040      <span class="comment">// Allow &amp;# and .!?%~ inside keywords</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SMODE_NOUSKEY  0x00000080      <span class="comment">// Underscore (_) is not part of keyword</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SMODE_NODEC    0x00000100      <span class="comment">// nn. is not decimal, but nn and &#x27;.&#x27;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SMODE_NOFLOAT  0x00000200      <span class="comment">// nn.mm is not float, but nn, &#x27;.&#x27;, mm</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SMODE_RADIX10  0x00000400      <span class="comment">// Default base is 10, not 16</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SMODE_ANGLES   0x00000800      <span class="comment">// Use angular brackets (&lt;&gt;) for text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SMODE_MASK     0x00001000      <span class="comment">// Allow masked nibbles in SCAN_INT</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCAN_EOF       0               <span class="comment">// End of data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCAN_EOL       1               <span class="comment">// End of line</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCAN_KEY       2               <span class="comment">// Keyword in text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCAN_TEXT      3               <span class="comment">// Text string (without quotes) in text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCAN_INT       4               <span class="comment">// Integer in ival or uval</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCAN_FLOAT     5               <span class="comment">// Floating-point number in fval</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCAN_OP        6               <span class="comment">// Operator or punctuator in ival</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCAN_INVALID   7               <span class="comment">// Invalid character in ival</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCAN_SYNTAX    8               <span class="comment">// Syntactical error in errmsg</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCAN_USER      10              <span class="comment">// Base for user-defined types</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_scan</span> &#123;</span>                <span class="comment">// Scan descriptor</span></span><br><span class="line">  <span class="comment">// Fill these fields before the first scan. Set line to 1 for 1-based numbers.</span></span><br><span class="line">  ulong          mode;                 <span class="comment">// Scanning mode, set of SMODE_xxx</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        *src;                 <span class="comment">// Pointer to UNICODE source data</span></span><br><span class="line">  ulong          length;               <span class="comment">// Length of source data, characters</span></span><br><span class="line">  ulong          caret;                <span class="comment">// Next processed symbol, characters</span></span><br><span class="line">  <span class="keyword">int</span>            line;                 <span class="comment">// Number of encountered EOLs</span></span><br><span class="line">  <span class="comment">// Call to Scan() fills some of these fields with scan data.</span></span><br><span class="line">  <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span>          ival;                 <span class="comment">// Scanned item as integer number</span></span><br><span class="line">    ulong        uval;                 <span class="comment">// Scanned item as unsigned number</span></span><br><span class="line">  &#125;;</span><br><span class="line">  ulong          mask;                 <span class="comment">// Binary mask for uval, SCAN_INT only</span></span><br><span class="line">  <span class="keyword">long</span> <span class="keyword">double</span>    fval;                 <span class="comment">// Scanned item as floating number</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        text[TEXTLEN];        <span class="comment">// Scanned item as a text string</span></span><br><span class="line">  <span class="keyword">int</span>            ntext;                <span class="comment">// Length of text, characters</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        errmsg[TEXTLEN];      <span class="comment">// Error message</span></span><br><span class="line">  <span class="keyword">int</span>            type;                 <span class="comment">// Type of last scanned item, SCAN_xxx</span></span><br><span class="line">&#125; t_scan;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">int</span>)     Skipspaces(t_scan *ps);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Scan(t_scan *ps);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Optostring(<span class="keyword">wchar_t</span> *s,<span class="keyword">int</span> op);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">///////////////////////// SHORTCUTS, MENUS AND TOOLBAR /////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Input modes of menu functions.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MENU_VERIFY    0               <span class="comment">// Check if menu item applies</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MENU_EXECUTE   1               <span class="comment">// Execute menu item</span></span></span><br><span class="line"><span class="comment">// Values returned by menu functions on MENU_VERIFY.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MENU_ABSENT    0               <span class="comment">// Item doesn&#x27;t appear in menu</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MENU_NORMAL    1               <span class="comment">// Ordinary menu item</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MENU_CHECKED   2               <span class="comment">// Checked menu item</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MENU_CHKPARENT 3               <span class="comment">// Checked menu item + checked parent</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MENU_GRAYED    4               <span class="comment">// Inactive menu item</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MENU_SHORTCUT  5               <span class="comment">// Shortcut only, not in menu</span></span></span><br><span class="line"><span class="comment">// Values returned by menu functions on MENU_EXECUTE.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MENU_NOREDRAW  0               <span class="comment">// Do not redraw owning window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MENU_REDRAW    1               <span class="comment">// Redraw owning window</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Shortcut descriptions.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> KK_KEYMASK     0x0000FFFF      <span class="comment">// Mask to extract key</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> KK_CHAR        0x00010000      <span class="comment">// Process as WM_CHAR</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> KK_SHIFT       0x00020000      <span class="comment">// Shortcut includes Shift key</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> KK_CTRL        0x00040000      <span class="comment">// Shortcut includes Ctrl key</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> KK_ALT         0x00080000      <span class="comment">// Shortcut includes Alt key</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> KK_WIN         0x00100000      <span class="comment">// Shortcut includes WIN key</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> KK_NOSH        0x00200000      <span class="comment">// Shortcut ignores Shift in main menu</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> KK_UNUSED      0x7FC00000      <span class="comment">// Unused shortcut data bits</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> KK_DIRECT      0x80000000      <span class="comment">// Direct shortcut in menu</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Global shortcuts. They may be re-used by plugins.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NONE         0               <span class="comment">// No shortcut</span></span></span><br><span class="line"><span class="comment">// Global shortcuts: File functions.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_OPENNEW      100             <span class="comment">// Open new executable to debug</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SETARGS      101             <span class="comment">// Set command line args for next run</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ATTACH       102             <span class="comment">// Attach to the running process</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DETACH       103             <span class="comment">// Detach from the debugged process</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_EXIT         104             <span class="comment">// Close OllyDbg</span></span></span><br><span class="line"><span class="comment">// Global shortcuts: View functions.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_LOGWINDOW    110             <span class="comment">// Open Log window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MODULES      111             <span class="comment">// Open Executable modules window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MEMORY       112             <span class="comment">// Open Memory map window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_WINDOWS      113             <span class="comment">// Open list of windows</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_THREADS      114             <span class="comment">// Open Threads window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_CPU          115             <span class="comment">// Open CPU window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_WATCHES      116             <span class="comment">// Open Watches window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SEARCHES     117             <span class="comment">// Open Search results window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_RTRACE       118             <span class="comment">// Open Run trace window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PATCHES      119             <span class="comment">// Open Patches window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_BPOINTS      120             <span class="comment">// Open INT3 breakpoints window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_BPMEM        121             <span class="comment">// Open Memory breakpoints window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_BPHARD       122             <span class="comment">// Open Hardware breakpoints window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SOURCES      123             <span class="comment">// Open list of source files</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_FILE         124             <span class="comment">// Open file</span></span></span><br><span class="line"><span class="comment">// Global shortcuts: Debug functions.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_RUN          130             <span class="comment">// Run debugged application</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_RUNTHREAD    131             <span class="comment">// Run only actual thread</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PAUSE        132             <span class="comment">// Pause debugged application</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_STEPIN       133             <span class="comment">// Step into</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_STEPOVER     134             <span class="comment">// Step over</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_TILLRET      135             <span class="comment">// Execute till return</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_TILLUSER     136             <span class="comment">// Execute till user code</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_CALLDLL      137             <span class="comment">// Call DLL export</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_RESTART      138             <span class="comment">// Restart last debugged executable</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_CLOSE        139             <span class="comment">// Close debuggee</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_AFFINITY     140             <span class="comment">// Set affinity</span></span></span><br><span class="line"><span class="comment">// Global shortcuts: Trace functions.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_OPENTRACE    150             <span class="comment">// Open Run trace</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_CLOSETRACE   151             <span class="comment">// Close Run trace</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ANIMIN       152             <span class="comment">// Animate into</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ANIMOVER     153             <span class="comment">// Animate over</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_TRACEIN      154             <span class="comment">// Trace into</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_TRACEOVER    155             <span class="comment">// Trace over</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_RUNHIT       156             <span class="comment">// Run hit trace</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_STOPHIT      157             <span class="comment">// Stop hit trace</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_RTCOND       158             <span class="comment">// Set run trace break condition</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_RTLOG        159             <span class="comment">// Set run trace log condition</span></span></span><br><span class="line"><span class="comment">// Global shortcuts: Options.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_OPTIONS      170             <span class="comment">// Open Options dialog</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PLUGOPTIONS  171             <span class="comment">// Open Plugin options dialog</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SHORTCUTS    172             <span class="comment">// Open Shortcut editor</span></span></span><br><span class="line"><span class="comment">// Global shortcuts: Windows functions.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_TOPMOST      180             <span class="comment">// Toggle topmost status of main window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_CASCADE      181             <span class="comment">// Cascade MDI windows</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_TILEHOR      182             <span class="comment">// Tile MDI windows horizontally</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_TILEVER      183             <span class="comment">// Tile MDI windows vertically</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ICONS        184             <span class="comment">// Arrange icons</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_CLOSEMDI     185             <span class="comment">// Close all MDI windows</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_RESTORE      186             <span class="comment">// Maximize or restore active MDI window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PREVMDI      187             <span class="comment">// Go to previous MDI window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NEXTMDI      188             <span class="comment">// Go to next MDI window</span></span></span><br><span class="line"><span class="comment">// Global shortcuts: Help functions.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ABOUT        190             <span class="comment">// Open About dialog</span></span></span><br><span class="line"><span class="comment">// Generic table shortcuts.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PREVFRAME    200             <span class="comment">// Go to previous frame in table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NEXTFRAME    201             <span class="comment">// Go to next frame in table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_UPDATE       202             <span class="comment">// Update table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_COPY         203             <span class="comment">// Copy to clipboard</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_COPYALL      204             <span class="comment">// Copy whole table to clipboard</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_CUT          205             <span class="comment">// Cut to clipboard</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PASTE        206             <span class="comment">// Paste</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_TOPMOSTMDI   207             <span class="comment">// Make MDI window topmost</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_AUTOUPDATE   208             <span class="comment">// Periodically update contents of window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SHOWBAR      209             <span class="comment">// Show/hide bar</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_HSCROLL      210             <span class="comment">// Show/hide horizontal scroll</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DEFCOLUMNS   211             <span class="comment">// Resize all columns to default width</span></span></span><br><span class="line"><span class="comment">// Shortcuts used by different windows.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SEARCHAGAIN  220             <span class="comment">// Repeat last search</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SEARCHREV    221             <span class="comment">// Repeat search in inverse direction</span></span></span><br><span class="line"><span class="comment">// Dump: Data backup.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_BACKUP       240             <span class="comment">// Create or update backup</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SHOWBKUP     241             <span class="comment">// Toggle backup display</span></span></span><br><span class="line"><span class="comment">// Dump: Edit.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_UNDO         250             <span class="comment">// Undo selection</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_COPYADDR     251             <span class="comment">// Copy address</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_COPYHEX      252             <span class="comment">// Copy data in hexadecimal format</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PASTEHEX     253             <span class="comment">// Paste data in hexadecimal format</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_EDITITEM     254             <span class="comment">// Edit first selected item</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_EDIT         255             <span class="comment">// Edit selection</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_FILLZERO     256             <span class="comment">// Fill selection with zeros</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_FILLNOP      257             <span class="comment">// Fill selection with NOPs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_FILLFF       258             <span class="comment">// Fill selection with FF code</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SELECTALL    259             <span class="comment">// Select all</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SELECTPROC   260             <span class="comment">// Select procedure or structure</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_COPYTOEXE    261             <span class="comment">// Copy selection to executable file</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ZERODUMP     262             <span class="comment">// Zero whole dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_LABEL        263             <span class="comment">// Add custom label</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ASSEMBLE     264             <span class="comment">// Assemble</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_COMMENT      265             <span class="comment">// Add custom comment</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SAVEFILE     266             <span class="comment">// Save file</span></span></span><br><span class="line"><span class="comment">// Dump: Breakpoints.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_BREAK        280             <span class="comment">// Toggle simple INT3 breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_CONDBREAK    281             <span class="comment">// Set or edit cond INT3 breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_LOGBREAK     282             <span class="comment">// Set or edit logging INT3 breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_RUNTOSEL     283             <span class="comment">// Run to selection</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ENABLEBRK    284             <span class="comment">// Enable or disable INT3 breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MEMBREAK     285             <span class="comment">// Set or edit memory breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MEMLOGBREAK  286             <span class="comment">// Set or edit memory log breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MEMENABLE    287             <span class="comment">// Enable or disable memory breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MEMDEL       288             <span class="comment">// Delete memory breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_HWBREAK      289             <span class="comment">// Set or edit hardware breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_HWLOGBREAK   290             <span class="comment">// Set or edit hardware log breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_HWENABLE     291             <span class="comment">// Enable or disable hardware breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_HWDEL        292             <span class="comment">// Delete hardware breakpoint</span></span></span><br><span class="line"><span class="comment">// Dump: Jumps to location.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NEWORIGIN    300             <span class="comment">// Set new origin</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_FOLLOWDASM   301             <span class="comment">// Follow address in Disassembler</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ORIGIN       302             <span class="comment">// Go to origin</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_GOTO         303             <span class="comment">// Go to expression</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_JMPTOSEL     304             <span class="comment">// Follow jump or call to selection</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SWITCHCASE   305             <span class="comment">// Go to switch case</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PREVHIST     306             <span class="comment">// Go to previous history location</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NEXTHIST     307             <span class="comment">// Go to next history location</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PREVTRACE    308             <span class="comment">// Go to previous run trace record</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NEXTTRACE    309             <span class="comment">// Go to next run trace record</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PREVPROC     310             <span class="comment">// Go to previous procedure</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NEXTPROC     311             <span class="comment">// Go to next procedure</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PREVREF      312             <span class="comment">// Go to previous found item</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NEXTREF      313             <span class="comment">// Go to next found item</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_FOLLOWEXE    314             <span class="comment">// Follow selection in executable file</span></span></span><br><span class="line"><span class="comment">// Dump: Structures.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DECODESTR    330             <span class="comment">// Decode as structure</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DECODESPTR   331             <span class="comment">// Decode as pointer to structure</span></span></span><br><span class="line"><span class="comment">// Dump: Search.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NAMES        380             <span class="comment">// Show list of names</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_FINDCMD      381             <span class="comment">// Find command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_FINDCMDSEQ   382             <span class="comment">// Find sequence of commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_FINDCONST    383             <span class="comment">// Find constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_FINDBIN      384             <span class="comment">// Find binary string</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_FINDMOD      385             <span class="comment">// Find modification</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ALLCALLS     386             <span class="comment">// Search for all intermodular calls</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ALLCMDS      387             <span class="comment">// Search for all commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ALLCMDSEQ    388             <span class="comment">// Search for all command sequences</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ALLCONST     389             <span class="comment">// Search for all constants</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ALLMODS      390             <span class="comment">// Search for all modifications</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ALLSTRS      391             <span class="comment">// Search for all referenced strings</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ALLGUIDS     392             <span class="comment">// Search for all referenced GUIDs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ALLCOMMENTS  393             <span class="comment">// Search for all user-defined comments</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ALLSWITCHES  394             <span class="comment">// Search for all switches</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ALLFLOATS    395             <span class="comment">// Search for all floating constants</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_LASTRTREC    396             <span class="comment">// Find last record in run trace</span></span></span><br><span class="line"><span class="comment">// Dump: References.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_REFERENCES   410             <span class="comment">// Find all references</span></span></span><br><span class="line"><span class="comment">// Dump: Addressing.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ABSADDR      420             <span class="comment">// Show absolute addresses</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_RELADDR      421             <span class="comment">// Show offsets from current selection</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_BASEADDR     422             <span class="comment">// Show offsets relative to module base</span></span></span><br><span class="line"><span class="comment">// Dump: Comments.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_COMMSRC      430             <span class="comment">// Toggle between comments and source</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SHOWPROF     431             <span class="comment">// Show or hide run trace profile</span></span></span><br><span class="line"><span class="comment">// Dump: Analysis.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ANALYSE      440             <span class="comment">// Analyse module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_REMANAL      441             <span class="comment">// Remove analysis from selection</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_REMANMOD     442             <span class="comment">// Remove analysis from the module</span></span></span><br><span class="line"><span class="comment">// Dump: Help.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_HELPCMD      450             <span class="comment">// Help on command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_HELPAPI      451             <span class="comment">// Help on Windows API function</span></span></span><br><span class="line"><span class="comment">// Dump: Data presentation.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPHA16     460             <span class="comment">// Dump as 16 hex bytes and ASCII text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPHA8      461             <span class="comment">// Dump as 8 hex bytes and ASCII text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPHU16     462             <span class="comment">// Dump as 16 hex bytes and UNICODE text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPHU8      463             <span class="comment">// Dump as 8 hex bytes and UNICODE text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPA64      464             <span class="comment">// Dump as 64 ASCII characters</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPA32      465             <span class="comment">// Dump as 32 ASCII characters</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPU64      466             <span class="comment">// Dump as 64 UNICODE characters</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPU32      467             <span class="comment">// Dump as 32 UNICODE characters</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPU16      468             <span class="comment">// Dump as 16 UNICODE characters</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPISHORT   469             <span class="comment">// Dump as 16-bit signed numbers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPUSHORT   470             <span class="comment">// Dump as 16-bit unsigned numbers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPXSHORT   471             <span class="comment">// Dump as 16-bit hexadecimal numbers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPILONG    472             <span class="comment">// Dump as 32-bit signed numbers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPULONG    473             <span class="comment">// Dump as 32-bit unsigned numbers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPXLONG    474             <span class="comment">// Dump as 32-bit hexadecimal numbers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPADR      475             <span class="comment">// Dump as address with comments</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPADRA     476             <span class="comment">// Dump as address with ASCII &amp; comments</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPADRU     477             <span class="comment">// Dump as address with UNICODE &amp; comms</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPF32      478             <span class="comment">// Dump as 32-bit floats</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPF64      479             <span class="comment">// Dump as 64-bit floats</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPF80      480             <span class="comment">// Dump as 80-bit floats</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPDA       481             <span class="comment">// Dump as disassembly</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMPSTRUCT   482             <span class="comment">// Dump as known structure</span></span></span><br><span class="line"><span class="comment">// Stack-specific shortcuts.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_LOCKSTK      490             <span class="comment">// Toggle stack lock</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PUSH         491             <span class="comment">// Push doubleword</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_POP          492             <span class="comment">// Pop doubleword</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_STACKINDASM  493             <span class="comment">// Follow stack doubleword in CPU</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_GOTOESP      494             <span class="comment">// Go to ESP</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_GOTOEBP      495             <span class="comment">// Go to EBP</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ESPADDR      496             <span class="comment">// Show offsets relative to ESP</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_EBPADDR      497             <span class="comment">// Show offsets relative to EBP</span></span></span><br><span class="line"><span class="comment">// Shortcuts of Register pane.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_INCREMENT    500             <span class="comment">// Increment register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DECREMENT    501             <span class="comment">// Decrement register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ZERO         502             <span class="comment">// Zero selected register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SET1         503             <span class="comment">// Set register to 1</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MODIFY       504             <span class="comment">// Modify contents of register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_UNDOREG      505</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PUSHFPU      506             <span class="comment">// Push FPU stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_POPFPU       507             <span class="comment">// Pop FPU stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_REGINDASM    508             <span class="comment">// Follow register in CPU Disassembler</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_REGINDUMP    509             <span class="comment">// Follow register in CPU Dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_REGINSTACK   510             <span class="comment">// Follow register in CPU Stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_VIEWFPU      511             <span class="comment">// View FPU registers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_VIEWMMX      512             <span class="comment">// View MMX registers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_VIEW3DNOW    513             <span class="comment">// View 3DNow! registers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_HELPREG      514             <span class="comment">// Help on register</span></span></span><br><span class="line"><span class="comment">// Shortcuts of Information pane.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_EDITOP       520             <span class="comment">// Edit contents of operand in info pane</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_INFOINDASM   521             <span class="comment">// Follow information in CPU Disassembler</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_INFOINDUMP   522             <span class="comment">// Follow information in CPU Dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_INFOINSTACK  523             <span class="comment">// Follow information in CPU Stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_LISTJUMPS    524             <span class="comment">// List jumps and calls to command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_LISTCASES    525             <span class="comment">// List switch cases</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_INFOSRC      526             <span class="comment">// Follow address in Source code</span></span></span><br><span class="line"><span class="comment">// Log window.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_LOGINDASM    530             <span class="comment">// Follow log address in CPU Disassembler</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_LOGINDUMP    531             <span class="comment">// Follow log address in CPU Dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_LOGINSTACK   532             <span class="comment">// Follow log address in CPU Stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_LOGCLEAR     533             <span class="comment">// Clear log</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_LOGTOFILE    534             <span class="comment">// Start logging to file</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_STOPLOG      535             <span class="comment">// Stop logging to file</span></span></span><br><span class="line"><span class="comment">// Executable modules.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MODINDASM    540             <span class="comment">// Follow module entry point in CPU</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MODDATA      541             <span class="comment">// View module data section in CPU Dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MODEXE       542             <span class="comment">// Open executable in standalone Dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MODNAMES     543             <span class="comment">// Show names declared in the module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_GLOBNAMES    544             <span class="comment">// Show global list of names</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MODCALLS     545             <span class="comment">// Find intermodular calls in module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MODANALYSE   546             <span class="comment">// Analyse selected module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SAVEUDD      547             <span class="comment">// Save module data to .udd file</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_LOADUDD      548             <span class="comment">// Load module data from .udd file</span></span></span><br><span class="line"><span class="comment">// Memory map.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MEMBACKUP    550             <span class="comment">// Create backup of memory block</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MEMINDASM    551             <span class="comment">// Open memory block in CPU Disassembler</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MEMINDUMP    552             <span class="comment">// Open memory block in CPU Dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DUMP         553             <span class="comment">// Dump memory block in separate window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SEARCHMEM    554             <span class="comment">// Search memory block for binary string</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MEMBPACCESS  555             <span class="comment">// Toggle break on access</span></span></span><br><span class="line"><span class="comment">// List of windows.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_WININDASM    560             <span class="comment">// Follow WinProc in CPU Disassembler</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_CLSINDASM    561             <span class="comment">// Follow ClassProc in CPU Disassembler</span></span></span><br><span class="line"><span class="comment">// Threads.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_THRINCPU     570             <span class="comment">// Open thread in CPU window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_THRTIB       571             <span class="comment">// Dump Thread Information Block</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_REGISTERS    572             <span class="comment">// Open Registers window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_THRSUSPEND   573             <span class="comment">// Suspend selected thread</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_THRRESUME    574             <span class="comment">// Resume selected thread</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_THRKILL      575             <span class="comment">// Kill selected thread</span></span></span><br><span class="line"><span class="comment">// Watches.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ADDWATCH     580             <span class="comment">// Add watch</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_EDITWATCH    581             <span class="comment">// Edit existing watch</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DELWATCH     582             <span class="comment">// Delete watch</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_WATCHUP      583             <span class="comment">// Move watch up</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_WATCHDN      584             <span class="comment">// Move watch down</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_EDITCONT     585             <span class="comment">// Edit contents of register or memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_WATCHINDASM  586             <span class="comment">// Follow watch value in CPU Disassembler</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_WATCHINDUMP  587             <span class="comment">// Follow watch value in CPU Dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_WATCHINSTACK 588             <span class="comment">// Follow watch value in CPU Stack</span></span></span><br><span class="line"><span class="comment">// Search results.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SEARCHINDASM 600             <span class="comment">// Follow address of found item in CPU</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PREVSEARCH   601             <span class="comment">// Follow previous found item in Disasm</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NEXTSEARCH   602             <span class="comment">// Follow next found item in Disasm</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_FINDTEXT     603             <span class="comment">// Find text substring in search results</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_BREAKALL     604             <span class="comment">// Set breakpoint on all found commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_CONDBPALL    605             <span class="comment">// Set conditional bp on all commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_LOGBPALL     606             <span class="comment">// Set logging bp on all commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DELBPALL     607             <span class="comment">// Remove breakpoints from all commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_BREAKCALLS   608             <span class="comment">// Set break on calls to function</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_CONDBPCALLS  609             <span class="comment">// Set cond break on calls to function</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_LOGBPCALLS   610             <span class="comment">// Set logging break on calls to function</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DELBPCALLS   611             <span class="comment">// Remove breakpoints from calls</span></span></span><br><span class="line"><span class="comment">// Run trace.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_RTPREV       620             <span class="comment">// Show previous run trace in Disasm</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_RTNEXT       621             <span class="comment">// Show next run trace in Disasm</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_TRACEINDASM  622             <span class="comment">// Follow traced command in CPU</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_CLRTRACE     623             <span class="comment">// Clear run trace</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_REGMODE      624             <span class="comment">// Toggle register display mode</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_MARKTRACE    625             <span class="comment">// Mark address in run trace</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_FINDTRADDR   626             <span class="comment">// Enter address to mark in run trace</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PREVMARK     627             <span class="comment">// Find previous marked address</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NEXTMARK     628             <span class="comment">// Find next marked address</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_CLEARMARK    629             <span class="comment">// Clear address marks in run trace</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PROFILE      630             <span class="comment">// Profile selected module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_GLOBPROFILE  631             <span class="comment">// Profile whole memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SAVETRACE    632             <span class="comment">// Save run trace data to the file</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_STOPSAVETR   633             <span class="comment">// Close run trace log file</span></span></span><br><span class="line"><span class="comment">// Profile.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PROFINDASM   640             <span class="comment">// Follow profiled command in CPU</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PREVPROF     641             <span class="comment">// Follow previous profile item in Disasm</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NEXTPROF     642             <span class="comment">// Follow next profile item in Disasm</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PROFMARK     643             <span class="comment">// Mark profile address in run trace</span></span></span><br><span class="line"><span class="comment">// Patches.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PATCHINDASM  650             <span class="comment">// Follow patch in CPU Disassembler</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_PREVPATCH    651             <span class="comment">// Go to previous patch</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NEXTPATCH    652             <span class="comment">// Go to next patch</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_APPLYPATCH   653             <span class="comment">// Apply patch</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_RESTOREPT    654             <span class="comment">// Restore original code</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DELPATCH     655             <span class="comment">// Delete patch record</span></span></span><br><span class="line"><span class="comment">// Breakpoint lists.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DELETEBP     660             <span class="comment">// Delete breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ENABLEBP     661             <span class="comment">// Enable or disable breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_BPINDASM     662             <span class="comment">// Follow breakpoint in CPU Disassembler</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_BPINDUMP     663             <span class="comment">// Follow breakpoint in CPU Dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_DISABLEALLBP 664             <span class="comment">// Disable all breakpoints</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_ENABLEALLBP  665             <span class="comment">// Enable all breakpoints</span></span></span><br><span class="line"><span class="comment">// Source.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_SOURCEINDASM 670             <span class="comment">// Follow source line in CPU Disassembler</span></span></span><br><span class="line"><span class="comment">// List of source files.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_VIEWSRC      680             <span class="comment">// View source file</span></span></span><br><span class="line"><span class="comment">// Names.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_FOLLOWIMP    690             <span class="comment">// Follow import in CPU Disassembler</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NAMEINDASM   691             <span class="comment">// Follow label in CPU Disassembler</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NAMEINDUMP   692             <span class="comment">// Follow label in CPU Dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NAMEREFS     693             <span class="comment">// Find references to name</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_NAMEHELPAPI  694             <span class="comment">// Help on selected API function</span></span></span><br><span class="line"><span class="comment">// Special non-changeable shortcuts.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_0            1008            <span class="comment">// Digit 0</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_1            1009            <span class="comment">// Digit 1</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_2            1010            <span class="comment">// Digit 2</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_3            1011            <span class="comment">// Digit 3</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_4            1012            <span class="comment">// Digit 4</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_5            1013            <span class="comment">// Digit 5</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_6            1014            <span class="comment">// Digit 6</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_7            1015            <span class="comment">// Digit 7</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_8            1016            <span class="comment">// Digit 8</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_9            1017            <span class="comment">// Digit 9</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_A            1018            <span class="comment">// Hex digit A</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_B            1019            <span class="comment">// Hex digit B</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_C            1020            <span class="comment">// Hex digit C</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_D            1021            <span class="comment">// Hex digit D</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_E            1022            <span class="comment">// Hex digit E</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> K_F            1023            <span class="comment">// Hex digit F</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Native OllyDbg tables that support embedded plugin menus:</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_ATTACH     <span class="meta-string">L&quot;ATTACH&quot;</span>       <span class="comment">// List of processes in Attach window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_BPHARD     <span class="meta-string">L&quot;BPHARD&quot;</span>       <span class="comment">// Hardware breakpoints</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_BPMEM      <span class="meta-string">L&quot;BPMEM&quot;</span>        <span class="comment">// Memory breakpoints</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_BPOINT     <span class="meta-string">L&quot;BPOINT&quot;</span>       <span class="comment">// INT3 breakpoints</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_DISASM     <span class="meta-string">L&quot;DISASM&quot;</span>       <span class="comment">// CPU Disassembler pane</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_DUMP       <span class="meta-string">L&quot;DUMP&quot;</span>         <span class="comment">// All dumps except CPU disasm &amp; stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_INFO       <span class="meta-string">L&quot;INFO&quot;</span>         <span class="comment">// CPU Info pane</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_LOG        <span class="meta-string">L&quot;LOG&quot;</span>          <span class="comment">// Log window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_MAIN       <span class="meta-string">L&quot;MAIN&quot;</span>         <span class="comment">// Main OllyDbg menu</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_MEMORY     <span class="meta-string">L&quot;MEMORY&quot;</span>       <span class="comment">// Memory window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_MODULES    <span class="meta-string">L&quot;MODULES&quot;</span>      <span class="comment">// Modules window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_NAMELIST   <span class="meta-string">L&quot;NAMELIST&quot;</span>     <span class="comment">// List of names (labels)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_PATCHES    <span class="meta-string">L&quot;PATCHES&quot;</span>      <span class="comment">// List of patches</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_PROFILE    <span class="meta-string">L&quot;PROFILE&quot;</span>      <span class="comment">// Profile window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_REGISTERS  <span class="meta-string">L&quot;REGISTERS&quot;</span>    <span class="comment">// Registers, including CPU</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_SEARCH     <span class="meta-string">L&quot;SEARCH&quot;</span>       <span class="comment">// Search tabs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_SOURCE     <span class="meta-string">L&quot;SOURCE&quot;</span>       <span class="comment">// Source code window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_SRCLIST    <span class="meta-string">L&quot;SRCLIST&quot;</span>      <span class="comment">// List of source files</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_STACK      <span class="meta-string">L&quot;STACK&quot;</span>        <span class="comment">// CPU Stack pane</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_THREADS    <span class="meta-string">L&quot;THREADS&quot;</span>      <span class="comment">// Threads window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_TRACE      <span class="meta-string">L&quot;TRACE&quot;</span>        <span class="comment">// Run trace window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_WATCH      <span class="meta-string">L&quot;WATCH&quot;</span>        <span class="comment">// Watches</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PWM_WINDOWS    <span class="meta-string">L&quot;WINDOWS&quot;</span>      <span class="comment">// List of windows</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="keyword">int</span>  <span class="title">MENUFUNC</span><span class="params">(struct t_table *,<span class="keyword">wchar_t</span> *,ulong,<span class="keyword">int</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_menu</span> &#123;</span>                <span class="comment">// Menu descriptor</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        *name;                <span class="comment">// Menu command</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        *help;                <span class="comment">// Explanation of command</span></span><br><span class="line">  <span class="keyword">int</span>            shortcutid;           <span class="comment">// Shortcut identifier, K_xxx</span></span><br><span class="line">  MENUFUNC       *menufunc;            <span class="comment">// Function that executes menu command</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">t_menu</span>  *<span class="title">submenu</span>;</span>             <span class="comment">// Pointer to descriptor of popup menu</span></span><br><span class="line">  <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">    ulong        index;                <span class="comment">// Argument passed to menu function</span></span><br><span class="line">    HMENU        hsubmenu;             <span class="comment">// Handle of pulldown menu</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125; t_menu;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">int</span>)     Callmenufunction(struct t_table *pt,t_menu *pm,</span><br><span class="line">                   MENUFUNC *menufunc,ulong index);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">///////////////////////////// MAIN OLLYDBG WINDOW //////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> <span class="title">t_status</span> &#123;</span>                <span class="comment">// Thread/process status</span></span><br><span class="line">  STAT_IDLE,                           <span class="comment">// No process to debug</span></span><br><span class="line">  STAT_LOADING,                        <span class="comment">// Loading new process</span></span><br><span class="line">  STAT_ATTACHING,                      <span class="comment">// Attaching to the running process</span></span><br><span class="line">  STAT_RUNNING,                        <span class="comment">// All threads are running</span></span><br><span class="line">  STAT_RUNTHR,                         <span class="comment">// Single thread is running</span></span><br><span class="line">  STAT_STEPIN,                         <span class="comment">// Stepping into, single thread</span></span><br><span class="line">  STAT_STEPOVER,                       <span class="comment">// Stepping over, single thread</span></span><br><span class="line">  STAT_ANIMIN,                         <span class="comment">// Animating into, single thread</span></span><br><span class="line">  STAT_ANIMOVER,                       <span class="comment">// Animating over, single thread</span></span><br><span class="line">  STAT_TRACEIN,                        <span class="comment">// Tracing into, single thread</span></span><br><span class="line">  STAT_TRACEOVER,                      <span class="comment">// Tracing over, single thread</span></span><br><span class="line">  STAT_SFXRUN,                         <span class="comment">// SFX using run trace, single thread</span></span><br><span class="line">  STAT_SFXHIT,                         <span class="comment">// SFX using hit trace, single thread</span></span><br><span class="line">  STAT_SFXKNOWN,                       <span class="comment">// SFX to known entry, single thread</span></span><br><span class="line">  STAT_TILLRET,                        <span class="comment">// Stepping until return, single thread</span></span><br><span class="line">  STAT_OVERRET,                        <span class="comment">// Stepping over return, single thread</span></span><br><span class="line">  STAT_TILLUSER,                       <span class="comment">// Stepping till user code, single thread</span></span><br><span class="line">  STAT_PAUSING,                        <span class="comment">// Process is requested to pause</span></span><br><span class="line">  STAT_PAUSED,                         <span class="comment">// Process paused on debugging event</span></span><br><span class="line">  STAT_FINISHED,                       <span class="comment">// Process is terminated but in memory</span></span><br><span class="line">  STAT_CLOSING                         <span class="comment">// Process is requested to close/detach</span></span><br><span class="line">&#125; t_status;</span><br><span class="line"></span><br><span class="line">varapi (<span class="keyword">void</span>)    Info(<span class="keyword">wchar_t</span> *format,...);</span><br><span class="line">varapi (<span class="keyword">void</span>)    Message(ulong addr,<span class="keyword">wchar_t</span> *format,...);</span><br><span class="line">varapi (<span class="keyword">void</span>)    Tempinfo(<span class="keyword">wchar_t</span> *format,...);</span><br><span class="line">varapi (<span class="keyword">void</span>)    Flash(<span class="keyword">wchar_t</span> *format,...);</span><br><span class="line">varapi (<span class="keyword">void</span>)    Progress(<span class="keyword">int</span> promille,<span class="keyword">wchar_t</span> *format,...);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Moveprogress(<span class="keyword">int</span> promille);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Setstatus(t_status newstatus);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//////////////////////////////// DATA FUNCTIONS ////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Name and data types. Do not change order, it&#x27;s important! Always keep values</span></span><br><span class="line"><span class="comment">// of demangled names 1 higher than originals, and NM_ALIAS higher than</span></span><br><span class="line"><span class="comment">// NM_EXPORT - name search routines rely on these facts!</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_NONAME      0x00            <span class="comment">// Means that name is absent</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DT_NONE        0x00            <span class="comment">// Ditto</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_LABEL       0x21            <span class="comment">// User-defined label</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_EXPORT      0x22            <span class="comment">// Exported name</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_DEEXP       (NM_EXPORT+1)   <span class="comment">// Demangled exported name</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DT_EORD        (NM_EXPORT+2)   <span class="comment">// Exported ordinal (ulong)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_ALIAS       (NM_EXPORT+3)   <span class="comment">// Alias of NM_EXPORT</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_IMPORT      0x26            <span class="comment">// Imported name (module.function)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_DEIMP       (NM_IMPORT+1)   <span class="comment">// Demangled imported name</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DT_IORD        (NM_IMPORT+2)   <span class="comment">// Imported ordinal (struct dt_iord)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_DEBUG       0x29            <span class="comment">// Name from debug data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_DEDEBUG     (NM_DEBUG+1)    <span class="comment">// Demangled name from debug data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_ANLABEL     0x2B            <span class="comment">// Name added by Analyser</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_COMMENT     0x30            <span class="comment">// User-defined comment</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_ANALYSE     0x31            <span class="comment">// Comment added by Analyser</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_MARK        0x32            <span class="comment">// Important parameter</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_CALLED      0x33            <span class="comment">// Name of called function</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DT_ARG         0x34            <span class="comment">// Name and type of argument or data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DT_NARG        0x35            <span class="comment">// Guessed number of arguments at CALL</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_RETTYPE     0x36            <span class="comment">// Type of data returned in EAX</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_MODCOMM     0x37            <span class="comment">// Automatical module comments</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_TRICK       0x38            <span class="comment">// Parentheses of tricky sequences</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DT_SWITCH      0x40            <span class="comment">// Switch descriptor (struct dt_switch)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DT_CASE        0x41            <span class="comment">// Case descriptor (struct dt_case)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DT_MNEMO       0x42            <span class="comment">// Alternative mnemonics data (dt_mnemo)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_DLLPARMS    0x44            <span class="comment">// Parameters of Call DLL dialog</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DT_DLLDATA     0x45            <span class="comment">// Parameters of Call DLL dialog</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DT_DBGPROC     0x4A            <span class="comment">// t_function from debug, don&#x27;t save!</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_INT3BASE    0x51            <span class="comment">// Base for INT3 breakpoint names</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   NM_INT3COND  (NM_INT3BASE+0) <span class="comment">// INT3 breakpoint condition</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   NM_INT3EXPR  (NM_INT3BASE+1) <span class="comment">// Expression to log at INT3 breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   NM_INT3TYPE  (NM_INT3BASE+2) <span class="comment">// Type used to decode expression</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_MEMBASE     0x54            <span class="comment">// Base for memory breakpoint names</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   NM_MEMCOND   (NM_MEMBASE+0)  <span class="comment">// Memory breakpoint condition</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   NM_MEMEXPR   (NM_MEMBASE+1)  <span class="comment">// Expression to log at memory break</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   NM_MEMTYPE   (NM_MEMBASE+2)  <span class="comment">// Type used to decode expression</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_HARDBASE    0x57            <span class="comment">// Base for hardware breakpoint names</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   NM_HARDCOND  (NM_HARDBASE+0) <span class="comment">// Hardware breakpoint condition</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   NM_HARDEXPR  (NM_HARDBASE+1) <span class="comment">// Expression to log at hardware break</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   NM_HARDTYPE  (NM_HARDBASE+2) <span class="comment">// Type used to decode expression</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_LABELSAV    0x60            <span class="comment">// NSTRINGS last user-defined labels</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_ASMSAV      0x61            <span class="comment">// NSTRINGS last assembled commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_ASRCHSAV    0x62            <span class="comment">// NSTRINGS last assemby searches</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_COMMSAV     0x63            <span class="comment">// NSTRINGS last user-defined comments</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_WATCHSAV    0x64            <span class="comment">// NSTRINGS last watch expressions</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_GOTOSAV     0x65            <span class="comment">// NSTRINGS last GOTO expressions</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DT_BINSAV      0x66            <span class="comment">// NSTRINGS last binary search patterns</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_CONSTSAV    0x67            <span class="comment">// NSTRINGS last constants to search</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_STRSAV      0x68            <span class="comment">// NSTRINGS last strings to search</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_ARGSAV      0x69            <span class="comment">// NSTRINGS last arguments (ARGLEN!)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_CURRSAV     0x6A            <span class="comment">// NSTRINGS last current dirs (MAXPATH!)</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_SEQSAV      0x6F            <span class="comment">// NSTRINGS last sequences (DATALEN!)</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_RTCOND1     0x70            <span class="comment">// First run trace pause condition</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_RTCOND2     0x71            <span class="comment">// Second run trace pause condition</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_RTCOND3     0x72            <span class="comment">// Third run trace pause condition</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_RTCOND4     0x73            <span class="comment">// Fourth run trace pause condition</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_RTCMD1      0x74            <span class="comment">// First run trace match command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_RTCMD2      0x75            <span class="comment">// Second run trace match command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_RANGE0      0x76            <span class="comment">// Low range limit</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NM_RANGE1      0x77            <span class="comment">// High range limit</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DT_ANYDATA     0xFF            <span class="comment">// Special marker, not a real data</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NMOFS_COND     0               <span class="comment">// Offset to breakpoint condition</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NMOFS_EXPR     1               <span class="comment">// Offset to breakpoint log expression</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NMOFS_TYPE     2               <span class="comment">// Offset to expression decoding type</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">dt_iord</span> &#123;</span>               <span class="comment">// Descriptor of DT_IORD data</span></span><br><span class="line">  ulong          ord;                  <span class="comment">// Ordinal</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        modname[SHORTNAME];   <span class="comment">// Short name of the module</span></span><br><span class="line">&#125; dt_iord;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NSWEXIT        256             <span class="comment">// Max no. of switch exits, incl. default</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NSWCASE        128             <span class="comment">// Max no. of cases in exit</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Types of switches and switch exits.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CASE_CASCADED  0x00000001      <span class="comment">// Cascaded IF</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CASE_HUGE      0x00000002      <span class="comment">// Huge switch, some cases are lost</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CASE_DEFAULT   0x00000004      <span class="comment">// Has default (is default for dt_case)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CASE_TYPEMASK  0x00000070      <span class="comment">// Mask to extract case type</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   CASE_ASCII   0x00000010      <span class="comment">// Intreprete cases as ASCII characters</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   CASE_MSG     0x00000020      <span class="comment">// Interprete cases as WM_xxx</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   CASE_EXCPTN  0x00000040      <span class="comment">// Interprete cases as exception codes</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CASE_SIGNED    0x00000080      <span class="comment">// Interprete cases as signed</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">dt_switch</span> &#123;</span>             <span class="comment">// Switch descriptor DT_SWITCH</span></span><br><span class="line">  ulong          casemin;              <span class="comment">// Minimal case</span></span><br><span class="line">  ulong          casemax;              <span class="comment">// Maximal case</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Switch type, set of CASE_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            nexit;                <span class="comment">// Number of exits including default</span></span><br><span class="line">  ulong          exitaddr[NSWEXIT];    <span class="comment">// List of exits (point to dt_case)</span></span><br><span class="line">&#125; dt_switch;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">dt_case</span> &#123;</span>               <span class="comment">// Switch exit descriptor DT_CASE</span></span><br><span class="line">  ulong          swbase;               <span class="comment">// Address of a switch descriptor</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Switch type, set of CASE_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            ncase;                <span class="comment">// Number of cases (1..64, 0: default)</span></span><br><span class="line">  ulong          value[NSWCASE];       <span class="comment">// List of cases for exit</span></span><br><span class="line">&#125; dt_case;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Flags indicating alternative forms of assembler mnemonics.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MF_JZ          0x01            <span class="comment">// JZ, JNZ instead of JE, JNE</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MF_JC          0x02            <span class="comment">// JC, JNC instead of JAE, JB</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">dt_mnemo</span> &#123;</span>              <span class="comment">// Mnemonics decoding DT_MNEMO</span></span><br><span class="line">  uchar          flags;                <span class="comment">// Set of MF_xxx</span></span><br><span class="line">&#125; dt_mnemo;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">int</span>)     Insertdata(ulong addr,<span class="keyword">int</span> type,<span class="keyword">void</span> *data,ulong datasize);</span><br><span class="line">stdapi (ulong)   Finddata(ulong addr,<span class="keyword">int</span> type,<span class="keyword">void</span> *data,ulong datasize);</span><br><span class="line">stdapi (<span class="keyword">void</span> *)  Finddataptr(ulong addr,<span class="keyword">int</span> type,ulong *datasize);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Startnextdata(ulong addr0,ulong addr1,<span class="keyword">int</span> type);</span><br><span class="line">stdapi (ulong)   Findnextdata(ulong *addr,<span class="keyword">void</span> *data,ulong datasize);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Startnextdatalist(ulong addr0,ulong addr1,<span class="keyword">int</span> *<span class="built_in">list</span>,<span class="keyword">int</span> n);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Findnextdatalist(ulong *addr,<span class="keyword">int</span> *type,</span><br><span class="line">                   <span class="keyword">void</span> *data,ulong datasize);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Isdataavailable(ulong addr,<span class="keyword">int</span> type1,<span class="keyword">int</span> type2,<span class="keyword">int</span> type3);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Isdatainrange(ulong addr0,ulong addr1,</span><br><span class="line">                   <span class="keyword">int</span> type1,<span class="keyword">int</span> type2,<span class="keyword">int</span> type3);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Deletedatarange(ulong addr0,ulong addr1,</span><br><span class="line">                   <span class="keyword">int</span> type1,<span class="keyword">int</span> type2,<span class="keyword">int</span> type3);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Deletedatarangelist(ulong addr0,ulong addr1,<span class="keyword">int</span> *<span class="built_in">list</span>,<span class="keyword">int</span> n);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Quickinsertdata(ulong addr,<span class="keyword">int</span> type,</span><br><span class="line">                   <span class="keyword">void</span> *data,ulong datasize);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Mergequickdata(<span class="keyword">void</span>);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     DemanglenameW(<span class="keyword">wchar_t</span> *name,<span class="keyword">wchar_t</span> *undecorated,<span class="keyword">int</span> recurs);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     InsertnameW(ulong addr,<span class="keyword">int</span> type,<span class="keyword">wchar_t</span> *s);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     QuickinsertnameW(ulong addr,<span class="keyword">int</span> type,<span class="keyword">wchar_t</span> *s);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     FindnameW(ulong addr,<span class="keyword">int</span> type,<span class="keyword">wchar_t</span> *name,<span class="keyword">int</span> nname);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     FindnextnameW(ulong *addr,<span class="keyword">wchar_t</span> *name,<span class="keyword">int</span> nname);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Startnextnamelist(ulong addr0,ulong addr1,<span class="keyword">int</span> *<span class="built_in">list</span>,<span class="keyword">int</span> n);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     FindnextnamelistW(ulong *addr,<span class="keyword">int</span> *type,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *name,<span class="keyword">int</span> nname);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Findlabel(ulong addr,<span class="keyword">wchar_t</span> *name,<span class="keyword">int</span> firsttype);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     FindaddressW(<span class="keyword">wchar_t</span> *name,struct t_module *pmod,</span><br><span class="line">                   ulong *addr,<span class="keyword">wchar_t</span> *errtxt);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">///////////////////////////// SIMPLE DATA FUNCTIONS ////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_simple</span> &#123;</span>              <span class="comment">// Simple data container</span></span><br><span class="line">  uchar          *heap;                <span class="comment">// Data heap</span></span><br><span class="line">  ulong          itemsize;             <span class="comment">// Size of data element, bytes</span></span><br><span class="line">  <span class="keyword">int</span>            maxitem;              <span class="comment">// Size of allocated data heap, items</span></span><br><span class="line">  <span class="keyword">int</span>            nitem;                <span class="comment">// Actual number of data items</span></span><br><span class="line">  <span class="keyword">int</span>            sorted;               <span class="comment">// Whether data is sorted</span></span><br><span class="line">&#125; t_simple;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">void</span>)    Destroysimpledata(t_simple *pdat);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Createsimpledata(t_simple *pdat,ulong itemsize);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Addsimpledata(t_simple *pdat,<span class="keyword">void</span> *data);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Sortsimpledata(t_simple *pdat);</span><br><span class="line">stdapi (<span class="keyword">void</span> *)  Findsimpledata(t_simple *pdat,ulong addr);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getsimpledataindexbyaddr(t_simple *pdat,ulong addr);</span><br><span class="line">stdapi (<span class="keyword">void</span> *)  Getsimpledatabyindex(t_simple *pdat,<span class="keyword">int</span> index);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Deletesimpledatarange(t_simple *pdat,ulong addr0,ulong addr1);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Bits that describe the state of predicted data, similar to PST_xxx.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PRED_SHORTSP   0x8000          <span class="comment">// Offset of ESP is 1 byte, .udd only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PRED_SHORTBP   0x4000          <span class="comment">// Offset of EBP is 1 byte, .udd only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PRED_ESPRET    0x0400          <span class="comment">// Offset of ESP backtraced from return</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PRED_ESPOK     0x0200          <span class="comment">// Offset of ESP valid</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PRED_EBPOK     0x0100          <span class="comment">// Offset of EBP valid</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PRED_REL       0x0080          <span class="comment">// Result constant fixuped or relative</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PRED_RESMASK   0x003F          <span class="comment">// Mask to extract description of result</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PRED_VALID   0x0020          <span class="comment">// Result constant valid</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PRED_ADDR    0x0010          <span class="comment">// Result is address</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PRED_ORIG    0x0008          <span class="comment">// Result is based on original register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PRED_OMASK   0x0007          <span class="comment">// Mask to extract original register</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PRED_ESPKNOWN  (PRED_ESPRET|PRED_ESPOK)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">sd_pred</span> &#123;</span>               <span class="comment">// Descriptor of predicted data</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Address of predicted command</span></span><br><span class="line">  ushort         mode;                 <span class="comment">// Combination of PRED_xxx</span></span><br><span class="line">  <span class="keyword">long</span>           espconst;             <span class="comment">// Offset of ESP to original ESP</span></span><br><span class="line">  <span class="keyword">long</span>           ebpconst;             <span class="comment">// Offset of EBP to original ESP</span></span><br><span class="line">  ulong          resconst;             <span class="comment">// Constant in result of execution</span></span><br><span class="line">&#125; sd_pred;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">///////////////////////////////// SORTED DATA //////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SDM_INDEXED    0x00000001      <span class="comment">// Indexed sorted data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SDM_EXTADDR    0x00000002      <span class="comment">// Address is extended by TY_AEXTMASK</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SDM_NOSIZE     0x00000004      <span class="comment">// Header without size and type</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SDM_NOEXTEND   0x00000008      <span class="comment">// Don&#x27;t reallocate memory, fail instead</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Address extension.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TY_AEXTMASK    0x000000FF      <span class="comment">// Mask to extract address extension</span></span></span><br><span class="line"><span class="comment">// General item types.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TY_NEW         0x00000100      <span class="comment">// Item is new</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TY_CONFIRMED   0x00000200      <span class="comment">// Item still exists</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TY_EXTADDR     0x00000400      <span class="comment">// Address extension active</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TY_SELECTED    0x00000800      <span class="comment">// Reserved for multiple selection</span></span></span><br><span class="line"><span class="comment">// Module-related item types (used in t_module and t_premod).</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD_MAIN       0x00010000      <span class="comment">// Main module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD_SFX        0x00020000      <span class="comment">// Self-extractable file</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MOD_SFXDONE  0x00040000      <span class="comment">// SFX file extracted</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD_RUNDLL     0x00080000      <span class="comment">// DLL loaded by LOADDLL.EXE</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD_SYSTEMDLL  0x00100000      <span class="comment">// System DLL</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD_SUPERSYS   0x00200000      <span class="comment">// System DLL that uses special commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD_DBGDATA    0x00400000      <span class="comment">// Debugging data is available</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD_ANALYSED   0x00800000      <span class="comment">// Module is already analysed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD_NODATA     0x01000000      <span class="comment">// Module data is not yet available</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD_HIDDEN     0x02000000      <span class="comment">// Module is loaded in stealth mode</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD_NETAPP     0x04000000      <span class="comment">// .NET application</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD_RESOLVED   0x40000000      <span class="comment">// All static imports are resolved</span></span></span><br><span class="line"><span class="comment">// Memory-related item types (used in t_memory), see also t_memory.special.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MEM_ANYMEM     0x0FFFF000      <span class="comment">// Mask for memory attributes</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MEM_CODE     0x00001000      <span class="comment">// Contains image of code section</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MEM_DATA     0x00002000      <span class="comment">// Contains image of data section</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MEM_SFX      0x00004000      <span class="comment">// Contains self-extractor</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MEM_IMPDATA  0x00008000      <span class="comment">// Contains import data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MEM_EXPDATA  0x00010000      <span class="comment">// Contains export data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MEM_RSRC     0x00020000      <span class="comment">// Contains resources</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MEM_RELOC    0x00040000      <span class="comment">// Contains relocation data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MEM_STACK    0x00080000      <span class="comment">// Contains stack of some thread</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MEM_STKGUARD 0x00100000      <span class="comment">// Guarding page of the stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MEM_THREAD   0x00200000      <span class="comment">// Contains data block of some thread</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MEM_HEADER   0x00400000      <span class="comment">// Contains COFF header</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MEM_DEFHEAP  0x00800000      <span class="comment">// Contains default heap</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MEM_HEAP     0x01000000      <span class="comment">// Contains non-default heap</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MEM_NATIVE   0x02000000      <span class="comment">// Contains JIT-compiled native code</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MEM_GAP      0x08000000      <span class="comment">// Free or reserved space</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MEM_SECTION    0x10000000      <span class="comment">// Section of the executable file</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MEM_GUARDED    0x40000000      <span class="comment">// NT only: guarded memory block</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MEM_TEMPGUARD  0x80000000      <span class="comment">// NT only: temporarily guarded block</span></span></span><br><span class="line"><span class="comment">// Thread-related item types (used in t_thread).</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> THR_MAIN       0x00010000      <span class="comment">// Main thread</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> THR_NETDBG     0x00020000      <span class="comment">// .NET debug helper thread</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> THR_ORGHANDLE  0x00100000      <span class="comment">// Original thread&#x27;s handle, don&#x27;t close</span></span></span><br><span class="line"><span class="comment">// Window-related item types (used in t_window).</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WN_UNICODE     0x00010000      <span class="comment">// UNICODE window</span></span></span><br><span class="line"><span class="comment">// Procedure-related item types (used in t_procdata).</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PD_CALLBACK    0x00001000      <span class="comment">// Used as a callback</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PD_RETSIZE     0x00010000      <span class="comment">// Return size valid</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PD_TAMPERRET   0x00020000      <span class="comment">// Tampers with the return address</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PD_NORETURN    0x00040000      <span class="comment">// Calls function without return</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PD_PURE        0x00080000      <span class="comment">// Doesn&#x27;t modify memory &amp; make calls</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PD_ESPALIGN    0x00100000      <span class="comment">// Aligns ESP on entry</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PD_ARGMASK     0x07E00000      <span class="comment">// Mask indicating valid narg</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PD_FIXARG    0x00200000      <span class="comment">// narg is fixed number of arguments</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PD_FORMATA   0x00400000      <span class="comment">// narg-1 is ASCII printf format</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PD_FORMATW   0x00800000      <span class="comment">// narg-1 is UNICODE printf format</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PD_SCANA     0x01000000      <span class="comment">// narg-1 is ASCII scanf format</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PD_SCANW     0x02000000      <span class="comment">// narg-1 is UNICODE scanf format</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PD_COUNT     0x04000000      <span class="comment">// narg-1 is count of following args</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PD_GUESSED     0x08000000      <span class="comment">// narg and type are guessed, not known</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PD_NGUESS      0x10000000      <span class="comment">// nguess valid</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PD_VARGUESS    0x20000000      <span class="comment">// nguess variable, set to minimum!=0</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PD_NPUSH       0x40000000      <span class="comment">// npush valid</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PD_VARPUSH     0x80000000      <span class="comment">// npush valid, set to maximum</span></span></span><br><span class="line"><span class="comment">// Argument prediction-related types (used in t_predict).</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PR_PUSHBP      0x00010000      <span class="comment">// PUSH EBP or ENTER executed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PR_MOVBPSP     0x00020000      <span class="comment">// MOV EBP,ESP or ENTER executed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PR_SETSEH      0x00040000      <span class="comment">// Structured exception handler set</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PR_RETISJMP    0x00100000      <span class="comment">// Return is (mis)used as a jump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PR_DIFFRET     0x00200000      <span class="comment">// Return changed, destination unknown</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PR_JMPTORET    0x00400000      <span class="comment">// Jump to original return address</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PR_TAMPERRET   0x00800000      <span class="comment">// Retaddr on stack accessed or modified</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PR_BADESP      0x01000000      <span class="comment">// ESP of actual generation is invalid</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PR_RET         0x02000000      <span class="comment">// Return from subroutine</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PR_STEPINTO    0x10000000      <span class="comment">// Step into CALL command</span></span></span><br><span class="line"><span class="comment">// Breakpoint-related types (used in t_bpoint, t_bpmem and t_bphard).</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BP_BASE        0x0000F000      <span class="comment">// Mask to extract basic breakpoint type</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_MANUAL    0x00001000      <span class="comment">// Permanent breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_ONESHOT   0x00002000      <span class="comment">// Stop and reset this bit</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_TEMP      0x00004000      <span class="comment">// Reset this bit and continue</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_TRACE     0x00008000      <span class="comment">// Used for hit trace</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BP_SET         0x00010000      <span class="comment">// Code INT3 is in memory, cmd is valid</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BP_DISABLED    0x00020000      <span class="comment">// Permanent breakpoint is disabled</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BP_COND        0x00040000      <span class="comment">// Conditional breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BP_PERIODICAL  0x00080000      <span class="comment">// Periodical (pauses each passcount)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BP_ACCESSMASK  0x00E00000      <span class="comment">// Access conditions (memory+hard)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_READ      0x00200000      <span class="comment">// Break on read memory access</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_WRITE     0x00400000      <span class="comment">// Break on write memory access</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_EXEC      0x00800000      <span class="comment">// Break on code execution</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BP_BREAKMASK   0x03000000      <span class="comment">// When to pause execution</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_NOBREAK   0x00000000      <span class="comment">// No pause</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_CONDBREAK 0x01000000      <span class="comment">// Pause if condition is true</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_BREAK     0x03000000      <span class="comment">// Pause always</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BP_LOGMASK     0x0C000000      <span class="comment">// When to log value of expression</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_NOLOG     0x00000000      <span class="comment">// Don&#x27;t log expression</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_CONDLOG   0x04000000      <span class="comment">// Log expression if condition is true</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_LOG       0x0C000000      <span class="comment">// Log expression always</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BP_ARGMASK     0x30000000      <span class="comment">// When to log arguments of a function</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_NOARG     0x00000000      <span class="comment">// Don&#x27;t log arguments</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_CONDARG   0x10000000      <span class="comment">// Log arguments if condition is true</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_ARG       0x30000000      <span class="comment">// Log arguments always</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BP_RETMASK     0xC0000000      <span class="comment">// When to log return value of a function</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_NORET     0x00000000      <span class="comment">// Don&#x27;t log return value</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_CONDRET   0x40000000      <span class="comment">// Log return value if condition is true</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BP_RET       0xC0000000      <span class="comment">// Log return value always</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BP_MANMASK (BP_PERIODICAL|BP_BREAKMASK|BP_LOGMASK|BP_ARGMASK|BP_RETMASK)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BP_CONFIRM     TY_CONFIRMED    <span class="comment">// Internal OllyDbg use</span></span></span><br><span class="line"><span class="comment">// Search-related types (used in t_search).</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SE_ORIGIN      0x00010000      <span class="comment">// Search origin</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SE_STRING      0x00020000      <span class="comment">// Data contains string address</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SE_FLOAT       0x00040000      <span class="comment">// Data contains floating constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SE_GUID        0x00080000      <span class="comment">// Data contains GUID</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SE_CONST       0x01000000      <span class="comment">// Constant, not referencing command</span></span></span><br><span class="line"><span class="comment">// Source-related types (used in t_source).</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SRC_ABSENT     0x00010000      <span class="comment">// Source file is absent</span></span></span><br><span class="line"><span class="comment">// Namelist-related types (used in t_namelist).</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NL_EORD        0x00010000      <span class="comment">// Associated export ordinal available</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NL_IORD        0x00020000      <span class="comment">// Associated import ordinal available</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_sorthdr</span> &#123;</span>             <span class="comment">// Header of sorted data item</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Base address of the entry</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Size of the entry</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Type and address extension, TY_xxx</span></span><br><span class="line">&#125; t_sorthdr;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_sorthdr_nosize</span> &#123;</span>      <span class="comment">// Header of SDM_NOSIZE item</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Base address of the entry</span></span><br><span class="line">&#125; t_sorthdr_nosize;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="keyword">int</span>  <span class="title">SORTFUNC</span><span class="params">(<span class="keyword">const</span> t_sorthdr *,<span class="keyword">const</span> t_sorthdr *,<span class="keyword">const</span> <span class="keyword">int</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="keyword">void</span> <span class="title">DESTFUNC</span><span class="params">(t_sorthdr *)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AUTOARRANGE    ((SORTFUNC *)1) <span class="comment">// Autoarrangeable sorted data</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NBLOCK         2048            <span class="comment">// Max number of data blocks</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BLOCKSIZE      1048576         <span class="comment">// Size of single data block, bytes</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_sorted</span> &#123;</span>              <span class="comment">// Descriptor of sorted data</span></span><br><span class="line">  <span class="keyword">int</span>            n;                    <span class="comment">// Actual number of entries</span></span><br><span class="line">  <span class="keyword">int</span>            nmax;                 <span class="comment">// Maximal number of entries</span></span><br><span class="line">  ulong          itemsize;             <span class="comment">// Size of single entry</span></span><br><span class="line">  <span class="keyword">int</span>            mode;                 <span class="comment">// Storage mode, set of SDM_xxx</span></span><br><span class="line">  <span class="keyword">void</span>           *data;                <span class="comment">// Sorted data, NULL if SDM_INDEXED</span></span><br><span class="line">  <span class="keyword">void</span>           **block;              <span class="comment">// NBLOCK sorted data blocks, or NULL</span></span><br><span class="line">  <span class="keyword">int</span>            nblock;               <span class="comment">// Number of allocated blocks</span></span><br><span class="line">  ulong          version;              <span class="comment">// Changes on each modification</span></span><br><span class="line">  <span class="keyword">void</span>           **dataptr;            <span class="comment">// Pointers to data, sorted by address</span></span><br><span class="line">  <span class="keyword">int</span>            selected;             <span class="comment">// Index of selected entry</span></span><br><span class="line">  ulong          seladdr;              <span class="comment">// Base address of selected entry</span></span><br><span class="line">  ulong          selsubaddr;           <span class="comment">// Subaddress of selected entry</span></span><br><span class="line">  SORTFUNC       *sortfunc;            <span class="comment">// Function which sorts data or NULL</span></span><br><span class="line">  DESTFUNC       *destfunc;            <span class="comment">// Destructor function or NULL</span></span><br><span class="line">  <span class="keyword">int</span>            sort;                 <span class="comment">// Sorting criterium (column)</span></span><br><span class="line">  <span class="keyword">int</span>            sorted;               <span class="comment">// Whether indexes are sorted</span></span><br><span class="line">  <span class="keyword">int</span>            *sortindex;           <span class="comment">// Indexes, sorted by criterium</span></span><br><span class="line">&#125; t_sorted;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">void</span>)    Destroysorteddata(t_sorted *sd);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Createsorteddata(t_sorted *sd,ulong itemsize,<span class="keyword">int</span> nexp,</span><br><span class="line">                   SORTFUNC *sortfunc,DESTFUNC *destfunc,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Deletesorteddata(t_sorted *sd,ulong addr,ulong subaddr);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Deletesorteddatarange(t_sorted *sd,ulong addr0,ulong addr1);</span><br><span class="line">stdapi (<span class="keyword">void</span> *)  Addsorteddata(t_sorted *sd,<span class="keyword">void</span> *item);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Replacesorteddatarange(t_sorted *sd,<span class="keyword">void</span> *data,<span class="keyword">int</span> n,</span><br><span class="line">                   ulong addr0,ulong addr1);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Renumeratesorteddata(t_sorted *sd);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Confirmsorteddata(t_sorted *sd,<span class="keyword">int</span> confirm);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Deletenonconfirmedsorteddata(t_sorted *sd);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Unmarknewsorteddata(t_sorted *sd);</span><br><span class="line">stdapi (<span class="keyword">void</span> *)  Findsorteddata(t_sorted *sd,ulong addr,ulong subaddr);</span><br><span class="line">stdapi (<span class="keyword">void</span> *)  Findsorteddatarange(t_sorted *sd,ulong addr0,ulong addr1);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Findsortedindexrange(t_sorted *sd,ulong addr0,ulong addr1);</span><br><span class="line">stdapi (<span class="keyword">void</span> *)  Getsortedbyindex(t_sorted *sd,<span class="keyword">int</span> index);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Sortsorteddata(t_sorted *sd,<span class="keyword">int</span> sort);</span><br><span class="line">stdapi (<span class="keyword">void</span> *)  Getsortedbyselection(t_sorted *sd,<span class="keyword">int</span> index);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Issortedinit(t_sorted *sd);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">///////////////////////// SORTED DATA WINDOWS (TABLES) /////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NBAR           17              <span class="comment">// Max allowed number of segments in bar</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BAR_FLAT       0x00000000      <span class="comment">// Flat segment</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BAR_BUTTON     0x00000001      <span class="comment">// Segment sends WM_USER_BAR</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BAR_SORT       0x00000002      <span class="comment">// Segment re-sorts sorted data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BAR_DISABLED   0x00000004      <span class="comment">// Bar segment disabled</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BAR_NORESIZE   0x00000008      <span class="comment">// Bar column cannot be resized</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BAR_SHIFTSEL   0x00000010      <span class="comment">// Selection shifted 1/2 char to left</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BAR_WIDEFONT   0x00000020      <span class="comment">// Twice as wide characters</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BAR_SEP        0x00000040      <span class="comment">// Treat &#x27;|&#x27; as separator</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BAR_ARROWS     0x00000080      <span class="comment">// Arrows if segment is shifted</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BAR_PRESSED    0x00000100      <span class="comment">// Bar segment pressed, used internally</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BAR_SPMASK     0x0000F000      <span class="comment">// Mask to extract speech type</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BAR_SPSTD    0x00000000      <span class="comment">// Standard speech with all conversions</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BAR_SPASM    0x00001000      <span class="comment">// Disassembler-oriented speech</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BAR_SPEXPR   0x00002000      <span class="comment">// Expression-oriented speech</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BAR_SPEXACT  0x00003000      <span class="comment">// Pass to speech engine as is</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BAR_SPELL    0x00004000      <span class="comment">// Text, spell symbol by symbol</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BAR_SPHEX    0x00005000      <span class="comment">// Hexadecimal, spell symbol by symbol</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   BAR_SPNONE   0x0000F000      <span class="comment">// Column is excluded from speech</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_bar</span> &#123;</span>                 <span class="comment">// Descriptor of columns in table window</span></span><br><span class="line">  <span class="comment">// These variables must be filled before table window is created.</span></span><br><span class="line">  <span class="keyword">int</span>            nbar;                 <span class="comment">// Number of columns</span></span><br><span class="line">  <span class="keyword">int</span>            visible;              <span class="comment">// Bar visible</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        *name[NBAR];          <span class="comment">// Column names (may be NULL)</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        *expl[NBAR];          <span class="comment">// Explanations of columns</span></span><br><span class="line">  <span class="keyword">int</span>            mode[NBAR];           <span class="comment">// Combination of bits BAR_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            defdx[NBAR];          <span class="comment">// Default widths of columns, chars</span></span><br><span class="line">  <span class="comment">// These variables are initialized by window creation function.</span></span><br><span class="line">  <span class="keyword">int</span>            dx[NBAR];             <span class="comment">// Actual widths of columns, pixels</span></span><br><span class="line">  <span class="keyword">int</span>            captured;             <span class="comment">// One of CAPT_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            active;               <span class="comment">// Info about where mouse was captured</span></span><br><span class="line">  <span class="keyword">int</span>            scrollvx;             <span class="comment">// X scrolling speed</span></span><br><span class="line">  <span class="keyword">int</span>            scrollvy;             <span class="comment">// Y scrolling speed</span></span><br><span class="line">  <span class="keyword">int</span>            prevx;                <span class="comment">// Previous X mouse coordinate</span></span><br><span class="line">  <span class="keyword">int</span>            prevy;                <span class="comment">// Previous Y mouse coordinate</span></span><br><span class="line">&#125; t_bar;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_USERDEF  0x00000001      <span class="comment">// User-drawn table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_STDSCR   0x00000002      <span class="comment">// User-drawn but standard scrolling</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_SIMPLE   0x00000004      <span class="comment">// Non-sorted, address is line number</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_DIR      0x00000008      <span class="comment">// Bottom-to-top table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_COLSEL   0x00000010      <span class="comment">// Column-wide selection</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_BYTE     0x00000020      <span class="comment">// Allows for bytewise scrolling</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_FASTSEL  0x00000040      <span class="comment">// Update when selection changes</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_RIGHTSEL 0x00000080      <span class="comment">// Right click can select items</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_RFOCUS   0x00000100      <span class="comment">// Right click sets focus</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_NOHSCR   0x00000200      <span class="comment">// Table contains no horizontal scroll</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_NOVSCR   0x00000400      <span class="comment">// Table contains no vertical scroll</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_NOBAR    0x00000800      <span class="comment">// Bar is always hidden</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_STATUS   0x00001000      <span class="comment">// Table contains status bar</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_MMOVX    0x00002000      <span class="comment">// Table is moveable by mouse in X</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_MMOVY    0x00004000      <span class="comment">// Table is moveable by mouse in Y</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_WANTCHAR 0x00008000      <span class="comment">// Table processes characters</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_SAVEAPP  0x00010000      <span class="comment">// Save appearance to .ini</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_SAVEPOS  0x00020000      <span class="comment">// Save position to .ini</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_SAVECOL  0x00040000      <span class="comment">// Save width of columns to .ini</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_SAVESORT 0x00080000      <span class="comment">// Save sort criterium to .ini</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_SAVECUST 0x00100000      <span class="comment">// Save table-specific data to .ini</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_GRAYTEXT 0x00200000      <span class="comment">// Text in table is grayed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_NOGRAY   0x00400000      <span class="comment">// Text in pane is never grayed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_UPDFOCUS 0x00800000      <span class="comment">// Update frame pane on focus change</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_AUTOUPD  0x01000000      <span class="comment">// Table allows periodical autoupdate</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_SYNTAX   0x02000000      <span class="comment">// Table allows syntax highlighting</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_PROPWID  0x04000000      <span class="comment">// Column width means proportional width</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_INFRAME  0x10000000      <span class="comment">// Table belongs to the frame window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_BORDER   0x20000000      <span class="comment">// Table has sunken border</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_KEEPOFFS 0x80000000      <span class="comment">// Keep xshift, offset, colsel</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_MOUSEMV  (TABLE_MMOVX|TABLE_MMOVY)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABLE_SAVEALL (TABLE_SAVEAPP|TABLE_SAVEPOS|TABLE_SAVECOL|TABLE_SAVESORT)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRAW_COLOR     0x0000001F      <span class="comment">// Mask to extract colour/bkgnd index</span></span></span><br><span class="line"><span class="comment">// Direct colour/background pairs.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_NORMAL  0x00000000      <span class="comment">// Normal text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_HILITE  0x00000001      <span class="comment">// Highlighted text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_GRAY    0x00000002      <span class="comment">// Grayed text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_EIP     0x00000003      <span class="comment">// Actual EIP</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_BREAK   0x00000004      <span class="comment">// Unconditional breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_COND    0x00000005      <span class="comment">// Conditional breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_BDIS    0x00000006      <span class="comment">// Disabled breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_IPBREAK 0x00000007      <span class="comment">// Breakpoint at actual EIP</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_AUX     0x00000008      <span class="comment">// Auxiliary colours</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_SELUL   0x00000009      <span class="comment">// Selection and underlining</span></span></span><br><span class="line"><span class="comment">// Indirect pairs used to highlight commands.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_PLAIN   0x0000000C      <span class="comment">// Plain commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_JUMP    0x0000000D      <span class="comment">// Unconditional jump commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_CJMP    0x0000000E      <span class="comment">// Conditional jump commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_PUSHPOP 0x0000000F      <span class="comment">// PUSH/POP commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_CALL    0x00000010      <span class="comment">// CALL commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_RET     0x00000011      <span class="comment">// RET commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_FPU     0x00000012      <span class="comment">// FPU, MMX, 3DNow! and SSE commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_SUSPECT 0x00000013      <span class="comment">// Bad, system and privileged commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_FILL    0x00000014      <span class="comment">// Filling commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_MOD     0x00000015      <span class="comment">// Modified commands</span></span></span><br><span class="line"><span class="comment">// Indirect pairs used to highlight operands.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_IREG    0x00000018      <span class="comment">// General purpose registers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_FREG    0x00000019      <span class="comment">// FPU, MMX and SSE registers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_SYSREG  0x0000001A      <span class="comment">// Segment and system registers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_STKMEM  0x0000001B      <span class="comment">// Memory accessed over ESP or EBP</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_MEM     0x0000001C      <span class="comment">// Any other memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_MCONST  0x0000001D      <span class="comment">// Constant pointing to memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_CONST   0x0000001E      <span class="comment">// Any other constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRAW_APP       0x00000060      <span class="comment">// Mask to extract appearance</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_TEXT    0x00000000      <span class="comment">// Plain text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_ULTEXT  0x00000020      <span class="comment">// Underlined text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DRAW_GRAPH   0x00000060      <span class="comment">// Graphics (text consists of G_xxx)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRAW_SELECT    0x00000080      <span class="comment">// Use selection background</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRAW_MASK      0x00000100      <span class="comment">// Mask in use</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRAW_VARWIDTH  0x00000200      <span class="comment">// Variable width possible</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRAW_EXTSEL    0x00000800      <span class="comment">// Extend mask till end of column</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRAW_TOP       0x00001000      <span class="comment">// Draw upper half of the two-line text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRAW_BOTTOM    0x00002000      <span class="comment">// Draw lower half of the two-line text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRAW_INACTIVE  0x00004000      <span class="comment">// Gray everything except hilited text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRAW_RAWDATA   0x00008000      <span class="comment">// Don&#x27;t convert glyphs and multibytes</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DRAW_NEW       0x00010000      <span class="comment">// Use highlighted foreground</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_drawheader</span> &#123;</span>          <span class="comment">// Draw descriptor for TABLE_USERDEF</span></span><br><span class="line">  <span class="keyword">int</span>            line;                 <span class="comment">// Line in window</span></span><br><span class="line">  <span class="keyword">int</span>            n;                    <span class="comment">// Total number of visible lines</span></span><br><span class="line">  ulong          nextaddr;             <span class="comment">// First address on next line, or 0</span></span><br><span class="line">  <span class="comment">// Following elements can be freely used by drawing routine. They do not</span></span><br><span class="line">  <span class="comment">// change between calls within one table.</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Custom data</span></span><br><span class="line">  uchar          s[TEXTLEN];           <span class="comment">// Custom data</span></span><br><span class="line">&#125; t_drawheader;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Constants used for scrolling and selection.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOVETOP        0x8000          <span class="comment">// Move selection to top of table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MOVEBOTTOM     0x7FFF          <span class="comment">// Move selection to bottom of table</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DF_CACHESIZE   (-4)            <span class="comment">// Request for draw cache size</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DF_FILLCACHE   (-3)            <span class="comment">// Request to fill draw cache</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DF_FREECACHE   (-2)            <span class="comment">// Request to free cached resources</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DF_NEWROW      (-1)            <span class="comment">// Request to start new row in window</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Reasons why t_table.tableselfunc() was called.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TSC_KEY        1               <span class="comment">// Keyboard key pressed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TSC_MOUSE      2               <span class="comment">// Selection changed by mouse</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TSC_CALL       3               <span class="comment">// Call to selection move function</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="title">TABFUNC</span><span class="params">(struct t_table *,HWND,UINT,WPARAM,LPARAM)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="keyword">int</span>  <span class="title">UPDATEFUNC</span><span class="params">(struct t_table *)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="keyword">int</span>  <span class="title">DRAWFUNC</span><span class="params">(<span class="keyword">wchar_t</span> *,uchar *,<span class="keyword">int</span> *,struct t_table *,</span></span></span><br><span class="line"><span class="function"><span class="params">  t_sorthdr *,<span class="keyword">int</span>,<span class="keyword">void</span> *)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="keyword">void</span> <span class="title">TABSELFUNC</span><span class="params">(struct t_table *,<span class="keyword">int</span>,<span class="keyword">int</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_table</span> &#123;</span>               <span class="comment">// Window with sorted data and bar</span></span><br><span class="line">  <span class="comment">// These variables must be filled before table window is created.</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        name[SHORTNAME];      <span class="comment">// Name used to save/restore position</span></span><br><span class="line">  <span class="keyword">int</span>            mode;                 <span class="comment">// Combination of bits TABLE_xxx</span></span><br><span class="line">  t_sorted       sorted;               <span class="comment">// Sorted data</span></span><br><span class="line">  <span class="keyword">int</span>            subtype;              <span class="comment">// User-defined subtype</span></span><br><span class="line">  t_bar          bar;                  <span class="comment">// Description of bar</span></span><br><span class="line">  <span class="keyword">int</span>            bottomspace;          <span class="comment">// Height of free space on the bottom</span></span><br><span class="line">  <span class="keyword">int</span>            minwidth;             <span class="comment">// Minimal width of the table, pixels</span></span><br><span class="line">  TABFUNC        *tabfunc;             <span class="comment">// Custom message function or NULL</span></span><br><span class="line">  UPDATEFUNC     *updatefunc;          <span class="comment">// Data update function or NULL</span></span><br><span class="line">  DRAWFUNC       *drawfunc;            <span class="comment">// Drawing function</span></span><br><span class="line">  TABSELFUNC     *tableselfunc;        <span class="comment">// Callback indicating selection change</span></span><br><span class="line">  t_menu         *menu;                <span class="comment">// Menu descriptor</span></span><br><span class="line">  <span class="comment">// Table functions neither initialize nor use these variables.</span></span><br><span class="line">  ulong          custommode;           <span class="comment">// User-defined custom data</span></span><br><span class="line">  <span class="keyword">void</span>           *customdata;          <span class="comment">// Pointer to more custom data</span></span><br><span class="line">  <span class="comment">// These variables are initialized and/or used by table functions.</span></span><br><span class="line">  HWND           hparent;              <span class="comment">// Handle of MDI container or NULL</span></span><br><span class="line">  HWND           hstatus;              <span class="comment">// Handle of status bar or NULL</span></span><br><span class="line">  HWND           hw;                   <span class="comment">// Handle of child table or NULL</span></span><br><span class="line">  HWND           htooltip;             <span class="comment">// Handle of tooltip window or NULL</span></span><br><span class="line">  <span class="keyword">int</span>            font;                 <span class="comment">// Index of font used by window</span></span><br><span class="line">  <span class="keyword">int</span>            scheme;               <span class="comment">// Colour scheme used by window</span></span><br><span class="line">  <span class="keyword">int</span>            hilite;               <span class="comment">// Highlighting scheme used by window</span></span><br><span class="line">  <span class="keyword">int</span>            hscroll;              <span class="comment">// Whether horizontal scroll visible</span></span><br><span class="line">  <span class="keyword">int</span>            xshift;               <span class="comment">// Shift in X direction, pixels</span></span><br><span class="line">  <span class="keyword">int</span>            offset;               <span class="comment">// First displayed row</span></span><br><span class="line">  <span class="keyword">int</span>            colsel;               <span class="comment">// Column in TABLE_COLSEL window</span></span><br><span class="line">  ulong          version;              <span class="comment">// Version of sorted on last update</span></span><br><span class="line">  ulong          timerdraw;            <span class="comment">// Timer redraw is active (period, ms)</span></span><br><span class="line">  RECT           rcprev;               <span class="comment">// Temporary storage for old position</span></span><br><span class="line">  <span class="keyword">int</span>            rtback;               <span class="comment">// Back step in run trace, 0 - actual</span></span><br><span class="line">&#125; t_table;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GWL_USR_TABLE  0               <span class="comment">// Offset to pointer to t_table</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Custom messages.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_CREATE (WM_USER+100)   <span class="comment">// Table window is created</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_HSCR   (WM_USER+101)   <span class="comment">// Update horizontal scroll</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_VSCR   (WM_USER+102)   <span class="comment">// Update vertical scroll</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_MOUSE  (WM_USER+103)   <span class="comment">// Mouse moves, set custom cursor</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_VINC   (WM_USER+104)   <span class="comment">// Scroll contents of window by lines</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_VPOS   (WM_USER+105)   <span class="comment">// Scroll contents of window by position</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_VBYTE  (WM_USER+106)   <span class="comment">// Scroll contents of window by bytes</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_SETS   (WM_USER+107)   <span class="comment">// Start selection in window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_CNTS   (WM_USER+108)   <span class="comment">// Continue selection in window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_MMOV   (WM_USER+109)   <span class="comment">// Move window&#x27;s contents by mouse</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_MOVS   (WM_USER+110)   <span class="comment">// Keyboard scrolling and selection</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_KEY    (WM_USER+111)   <span class="comment">// Key pressed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_BAR    (WM_USER+112)   <span class="comment">// Message from bar segment as button</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_DBLCLK (WM_USER+113)   <span class="comment">// Doubleclick in column</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_SELXY  (WM_USER+114)   <span class="comment">// Get coordinates of selection</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_FOCUS  (WM_USER+115)   <span class="comment">// Set focus to child of frame window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_UPD    (WM_USER+116)   <span class="comment">// Autoupdate contents of the window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_MTAB   (WM_USER+117)   <span class="comment">// Middle click on tab in tab parent</span></span></span><br><span class="line"><span class="comment">// Custom broadcasts and notifications.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_CHGALL (WM_USER+132)   <span class="comment">// Update all windows</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_CHGCPU (WM_USER+133)   <span class="comment">// CPU thread has changed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_CHGMEM (WM_USER+134)   <span class="comment">// List of memory blocks has changed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_BKUP   (WM_USER+135)   <span class="comment">// Global backup is changed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_FILE   (WM_USER+136)   <span class="comment">// Query for file dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_NAMES  (WM_USER+137)   <span class="comment">// Query for namelist window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_SAVE   (WM_USER+138)   <span class="comment">// Query for unsaved data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_CLEAN  (WM_USER+139)   <span class="comment">// End of process, close related windows</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_HERE   (WM_USER+140)   <span class="comment">// Query for windows to restore</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WM_USER_CLOSE  (WM_USER+141)   <span class="comment">// Internal substitute for WM_CLOSE</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> KEY_ALT        0x04            <span class="comment">// Alt key pressed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> KEY_CTRL       0x02            <span class="comment">// Ctrl key pressed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> KEY_SHIFT      0x01            <span class="comment">// Shift key pressed</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Control alignment modes for Createtablechild().</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ALIGN_MASK     0xC000          <span class="comment">// Mask to extract control alignment</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   ALIGN_LEFT   0x0000          <span class="comment">// Control doesn&#x27;t move</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   ALIGN_RIGHT  0x4000          <span class="comment">// Control moves with right border</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   ALIGN_WIDTH  0x8000          <span class="comment">// Control resizes with right border</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ALIGN_IDMASK   0x0FFF          <span class="comment">// Mask to extract control ID</span></span></span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">void</span>)    Processwmmousewheel(HWND hw,WPARAM wp);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getcharacterwidth(t_table *pt,<span class="keyword">int</span> column);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Defaultbar(t_table *pt);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Linecount(t_table *pt);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Gettabletext(t_table *pt,<span class="keyword">int</span> row,<span class="keyword">int</span> column,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *text,uchar *tmask,<span class="keyword">int</span> *tselect);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Gettableselectionxy(t_table *pt,<span class="keyword">int</span> column,POINT *coord);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Maketableareavisible(t_table *pt,<span class="keyword">int</span> column,</span><br><span class="line">                   <span class="keyword">int</span> x0,<span class="keyword">int</span> y0,<span class="keyword">int</span> x1,<span class="keyword">int</span> y1);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Movetableselection(t_table *pt,<span class="keyword">int</span> n);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Settableselection(t_table *pt,<span class="keyword">int</span> selected);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Removetableselection(t_table *pt);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Updatetable(t_table *pt,<span class="keyword">int</span> force);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Delayedtableredraw(t_table *pt);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Setautoupdate(t_table *pt,<span class="keyword">int</span> autoupdate);</span><br><span class="line">stdapi (HGLOBAL) Copytableselection(t_table *pt,<span class="keyword">int</span> column);</span><br><span class="line">stdapi (HGLOBAL) Copywholetable(t_table *pt,<span class="keyword">int</span> compatible);</span><br><span class="line">stdapi (HWND)    Createottablewindow(HWND hparent,t_table *pt,RECT *rpos);</span><br><span class="line">stdapi (HWND)    Createtablewindow(t_table *pt,<span class="keyword">int</span> nrow,<span class="keyword">int</span> ncolumn,</span><br><span class="line">                   HINSTANCE hi,<span class="keyword">wchar_t</span> *icon,<span class="keyword">wchar_t</span> *title);</span><br><span class="line">stdapi (HWND)    Activatetablewindow(t_table *pt);</span><br><span class="line">stdapi (HWND)    Createtablechild(t_table *pt,<span class="keyword">wchar_t</span> *classname,<span class="keyword">wchar_t</span> *name,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *help,ulong style,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> dx,<span class="keyword">int</span> dy,</span><br><span class="line">                   <span class="keyword">int</span> idalign);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//////////////////////////// FRAME AND TAB WINDOWS /////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BLK_NONE       0               <span class="comment">// Mouse outside the dividing line</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BLK_HDIV       1               <span class="comment">// Divide horizontally</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BLK_VDIV       2               <span class="comment">// Divide vertically</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BLK_TABLE      3               <span class="comment">// Leaf that describes table window</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_block</span> &#123;</span>               <span class="comment">// Block descriptor</span></span><br><span class="line">  <span class="keyword">int</span>            index;                <span class="comment">// Index of pos record in the .ini file</span></span><br><span class="line">  <span class="keyword">int</span>            type;                 <span class="comment">// One of BLK_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            percent;              <span class="comment">// Percent of block in left/top subblock</span></span><br><span class="line">  <span class="keyword">int</span>            offset;               <span class="comment">// Offset of dividing line, pixels</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">t_block</span> *<span class="title">blk1</span>;</span>                <span class="comment">// Top/left subblock, NULL if leaf</span></span><br><span class="line">  <span class="keyword">int</span>            minp1;                <span class="comment">// Min size of 1st subblock, pixels</span></span><br><span class="line">  <span class="keyword">int</span>            maxc1;                <span class="comment">// Max size of 1st subblock, chars, or 0</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">t_block</span> *<span class="title">blk2</span>;</span>                <span class="comment">// Bottom/right subblock, NULL if leaf</span></span><br><span class="line">  <span class="keyword">int</span>            minp2;                <span class="comment">// Min size of 2nd subblock, pixels</span></span><br><span class="line">  <span class="keyword">int</span>            maxc2;                <span class="comment">// Max size of 2nd subblock, chars, or 0</span></span><br><span class="line">  t_table        *table;               <span class="comment">// Descriptor of table window</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        tabname[SHORTNAME];   <span class="comment">// Tab (tab window only)</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        title[TEXTLEN];       <span class="comment">// Title (tab window) or speech name</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        status[TEXTLEN];      <span class="comment">// Status (tab window only)</span></span><br><span class="line">&#125; t_block;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_frame</span> &#123;</span>               <span class="comment">// Descriptor of frame or tab window</span></span><br><span class="line">  <span class="comment">// These variables must be filled before frame window is created.</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        name[SHORTNAME];      <span class="comment">// Name used to save/restore position</span></span><br><span class="line">  <span class="keyword">int</span>            herebit;              <span class="comment">// Must be 0 for plugins</span></span><br><span class="line">  <span class="keyword">int</span>            mode;                 <span class="comment">// Combination of bits TABLE_xxx</span></span><br><span class="line">  t_block        *block;               <span class="comment">// Pointer to block tree</span></span><br><span class="line">  t_menu         *menu;                <span class="comment">// Menu descriptor (tab window only)</span></span><br><span class="line">  <span class="keyword">int</span>            scheme;               <span class="comment">// Colour scheme used by window</span></span><br><span class="line">  <span class="comment">// These variables are initialized by frame creation function.</span></span><br><span class="line">  HWND           hw;                   <span class="comment">// Handle of MDI container or NULL</span></span><br><span class="line">  HWND           htab;                 <span class="comment">// Handle of tab control</span></span><br><span class="line">  WNDPROC        htabwndproc;          <span class="comment">// Original WndProc of tab control</span></span><br><span class="line">  <span class="keyword">int</span>            capturedtab;          <span class="comment">// Tab captured on middle mouse click</span></span><br><span class="line">  HWND           hstatus;              <span class="comment">// Handle of status bar or NULL</span></span><br><span class="line">  t_block        *active;              <span class="comment">// Active table (has focus) or NULL</span></span><br><span class="line">  t_block        *captured;            <span class="comment">// Block that captured mouse or NULL</span></span><br><span class="line">  <span class="keyword">int</span>            captureoffset;        <span class="comment">// Offset on mouse capture</span></span><br><span class="line">  <span class="keyword">int</span>            capturex;             <span class="comment">// Mouse screen X coordinate on capture</span></span><br><span class="line">  <span class="keyword">int</span>            capturey;             <span class="comment">// Mouse screen Y coordinate on capture</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        title[TEXTLEN];       <span class="comment">// Frame or tab window title</span></span><br><span class="line">&#125; t_frame;</span><br><span class="line"></span><br><span class="line">stdapi (HWND)    Createframewindow(t_frame *pf,<span class="keyword">wchar_t</span> *icon,<span class="keyword">wchar_t</span> *title);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Updateframe(t_frame *pf,<span class="keyword">int</span> redrawnow);</span><br><span class="line">stdapi (t_table *) Getactiveframe(t_frame *pf);</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">int</span>)     Updatetabs(t_frame *pf);</span><br><span class="line">stdapi (HWND)    Createtabwindow(t_frame *pf,<span class="keyword">wchar_t</span> *icon,<span class="keyword">wchar_t</span> *title);</span><br><span class="line">stdapi (t_table *) Getactivetab(t_frame *pf);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Gettabcount(t_frame *pf,<span class="keyword">int</span> *index);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Setactivetab(t_frame *pf,<span class="keyword">int</span> index);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////////////////// FONTS AND GRAPHICS //////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FIXEDFONT      0               <span class="comment">// Indices of fixed fonts used in tables</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TERMINAL6      1               <span class="comment">// Note: fonts may be changed by user!</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FIXEDSYS       2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> COURIERFONT    3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LUCIDACONS     4</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FONT5          5</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FONT6          6</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FONT7          7</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NFIXFONTS      8               <span class="comment">// Total number of fixed fonts</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BLACKWHITE     0               <span class="comment">// Colour schemes used by OllyDbg</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BLUEGOLD       1               <span class="comment">// Note: colours may be changed by user!</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SKYWIND        2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NIGHTSTARS     3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCHEME4        4</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCHEME5        5</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCHEME6        6</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCHEME7        7</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NSCHEMES       8               <span class="comment">// Number of predefined colour schemes</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NDRAW          32              <span class="comment">// Number of fg/bg pairs in scheme</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NOHILITE       0               <span class="comment">// Highlighting schemes used by OllyDbg</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> XMASHILITE     1               <span class="comment">// Note: colours may be changed by user!</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> JUMPHILITE     2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MEMHILITE      3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HILITE4        4</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HILITE5        5</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HILITE6        6</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HILITE7        7</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NHILITE        8               <span class="comment">// Number of predefined hilite schemes</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BLACK          0               <span class="comment">// Indexes of colours used by OllyDbg</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BLUE           1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GREEN          2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CYAN           3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RED            4</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAGENTA        5</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BROWN          6</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LIGHTGRAY      7</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DARKGRAY       8</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LIGHTBLUE      9</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LIGHTGREEN     10</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LIGHTCYAN      11</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LIGHTRED       12</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LIGHTMAGENTA   13</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> YELLOW         14</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WHITE          15</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MINT           16</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SKYBLUE        17</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IVORY          18</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GRAY           19</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NFIXCOLORS     20              <span class="comment">// Number of colors fixed in OllyDbg</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NCOLORS        (NFIXCOLORS+16) <span class="comment">// Number of available colours</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Symbolic names for graphical characters. Any other graphical symbol is</span></span><br><span class="line"><span class="comment">// interpreted as a space. Use only symbols in range [0x01..0x3F], high bits</span></span><br><span class="line"><span class="comment">// are reserved for the future!</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_SPACE        0x01            <span class="comment">// Space</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_SEP          0x02            <span class="comment">// Thin separating line</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_POINT        0x03            <span class="comment">// Point</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_BIGPOINT     0x04            <span class="comment">// Big point</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_JMPDEST      0x05            <span class="comment">// Jump destination</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_CALLDEST     0x06            <span class="comment">// Call destination</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_QUESTION     0x07            <span class="comment">// Question mark</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_JMPUP        0x10            <span class="comment">// Jump upstairs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_JMPOUT       0x11            <span class="comment">// Jump to same location or outside</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_JMPDN        0x12            <span class="comment">// Jump downstairs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_SWUP         0x13            <span class="comment">// Switch upstairs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_SWBOTH       0x14            <span class="comment">// Switch in both directions</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_SWDOWN       0x15            <span class="comment">// Switch down</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_BEGIN        0x18            <span class="comment">// Begin of procedure or scope</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_BODY         0x19            <span class="comment">// Body of procedure or scope</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_ENTRY        0x1A            <span class="comment">// Loop entry point</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_LEAF         0x1B            <span class="comment">// Intermediate leaf on a tree</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_END          0x1C            <span class="comment">// End of procedure or scope</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_SINGLE       0x1D            <span class="comment">// Single-line scope</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_ENDBEG       0x1E            <span class="comment">// End and begin of stack scope</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_PATHUP       0x21            <span class="comment">// Jump path start upstairs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_PATH         0x22            <span class="comment">// Jump path through</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_PATHDN       0x23            <span class="comment">// Jump path start downstairs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_PATHUPDN     0x24            <span class="comment">// Two-sided jump path start</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_THROUGHUP    0x25            <span class="comment">// Jump entry upstairs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_THROUGHDN    0x26            <span class="comment">// Jump entry downstairs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_PATHUPEND    0x27            <span class="comment">// End of path upstairs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_PATHDNEND    0x28            <span class="comment">// End of path downstairs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_PATHBIEND    0x29            <span class="comment">// Two-sided end of path</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_THRUUPEND    0x2A            <span class="comment">// Intermediate end upstairs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_THRUDNEND    0x2B            <span class="comment">// Intermediate end downstairs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_ARRLEFT      0x2C            <span class="comment">// Left arrow</span></span></span><br><span class="line"><span class="comment">// Graphical elements used to draw frames in the command help.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_HL           0x30            <span class="comment">// Horizontal line</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_LT           0x31            <span class="comment">// Left top corner</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_CT           0x32            <span class="comment">// Central top element</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_RT           0x33            <span class="comment">// Right top corner</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_LM           0x34            <span class="comment">// Left middle element</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_CM           0x35            <span class="comment">// Central cross</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_RM           0x36            <span class="comment">// Right middle element</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_LB           0x37            <span class="comment">// Left bottom corner</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_CB           0x38            <span class="comment">// Central bottom element</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_RB           0x39            <span class="comment">// Right bottom corner</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_VL           0x3A            <span class="comment">// Vertical line</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_LA           0x3B            <span class="comment">// Horizontal line with left arrow</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_RA           0x3C            <span class="comment">// Horizontal line with right arrow</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G_DA           0x3D            <span class="comment">// Vertical line with down arrow</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_font</span> &#123;</span>                <span class="comment">// Font descriptor</span></span><br><span class="line">  LOGFONT        logfont;              <span class="comment">// System font description</span></span><br><span class="line">  <span class="keyword">int</span>            stockindex;           <span class="comment">// Index for system stock fonts</span></span><br><span class="line">  <span class="keyword">int</span>            hadjtop;              <span class="comment">// Height adjustment on top, pixels</span></span><br><span class="line">  <span class="keyword">int</span>            hadjbot;              <span class="comment">// Height adjustment on bottom, pixels</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        name[TEXTLEN];        <span class="comment">// Internal font name</span></span><br><span class="line">  HFONT          hfont;                <span class="comment">// Font handle</span></span><br><span class="line">  <span class="keyword">int</span>            isstock;              <span class="comment">// Don&#x27;t destroy hfont, taken from stock</span></span><br><span class="line">  <span class="keyword">int</span>            isfullunicode;        <span class="comment">// Whether UNICODE is fully supported</span></span><br><span class="line">  <span class="keyword">int</span>            width;                <span class="comment">// Average font width</span></span><br><span class="line">  <span class="keyword">int</span>            height;               <span class="comment">// Font height</span></span><br><span class="line">&#125; t_font;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_scheme</span> &#123;</span>              <span class="comment">// Descriptor of colour scheme</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        name[TEXTLEN];        <span class="comment">// Internal scheme name</span></span><br><span class="line">  COLORREF       textcolor[NDRAW];     <span class="comment">// Foreground colours (in DRAW_COLOR)</span></span><br><span class="line">  COLORREF       bkcolor[NDRAW];       <span class="comment">// Background colours (in DRAW_COLOR)</span></span><br><span class="line">  <span class="keyword">int</span>            hiliteoperands;       <span class="comment">// Used only by highlighting schemes</span></span><br><span class="line">  <span class="keyword">int</span>            hilitemodified;       <span class="comment">// Used only by highlighting schemes</span></span><br><span class="line">  HBRUSH         bkbrush;              <span class="comment">// Ordinary background brush</span></span><br><span class="line">  HBRUSH         selbkbrush;           <span class="comment">// Selected background brush</span></span><br><span class="line">  HBRUSH         auxbrush;             <span class="comment">// Auxiliary brush</span></span><br><span class="line">  HPEN           graphpen;             <span class="comment">// Pen for normal graphical elements</span></span><br><span class="line">  HPEN           lopen;                <span class="comment">// Pen for grayed graphical elements</span></span><br><span class="line">  HPEN           hipen;                <span class="comment">// Pen for hilited graphical elements</span></span><br><span class="line">  HPEN           auxpen;               <span class="comment">// Pen for auxiliary graphical elements</span></span><br><span class="line">  HPEN           ulpen;                <span class="comment">// Pen to underline text</span></span><br><span class="line">&#125; t_scheme;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getmonitorrect(<span class="keyword">int</span> x,<span class="keyword">int</span> y,RECT *rc);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Sunkenframe(HDC dc,RECT *rc,<span class="keyword">int</span> flags);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Findstockobject(ulong gdihandle,<span class="keyword">wchar_t</span> *name,<span class="keyword">int</span> nname);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">/////////////////////////////// MEMORY FUNCTIONS ///////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Mode bits used in calls to Readmemory(), Readmemoryex() and Writememory().</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM_REPORT      0x0000          <span class="comment">// Display error message if unreadable</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM_SILENT      0x0001          <span class="comment">// Don&#x27;t display error message</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM_NORESTORE   0x0002          <span class="comment">// Don&#x27;t remove/set INT3 breakpoints</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM_PARTIAL     0x0004          <span class="comment">// Allow less data than requested</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM_WRITETHRU   0x0008          <span class="comment">// Write immediately to memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM_REMOVEINT3  0x0010          <span class="comment">// Writememory(): remove INT3 breaks</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM_ADJUSTINT3  0x0020          <span class="comment">// Writememory(): adjust INT3 breaks</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM_FAILGUARD   0x0040          <span class="comment">// Fail if memory is guarded</span></span></span><br><span class="line"><span class="comment">// Mode bits used in calls to Readmemoryex().</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MM_BPMASK      BP_ACCESSMASK   <span class="comment">// Mask to extract memory breakpoints</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MM_BPREAD    BP_READ         <span class="comment">// Fail if memory break on read is set</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MM_BPWRITE   BP_WRITE        <span class="comment">// Fail if memory break on write is set</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   MM_BPEXEC    BP_EXEC         <span class="comment">// Fail if memory break on exec is set</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Special types of memory block.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MSP_NONE       0               <span class="comment">// Not a special memory block</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MSP_PEB        1               <span class="comment">// Contains Process Environment Block</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MSP_SHDATA     2               <span class="comment">// Contains KUSER_SHARED_DATA</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MSP_PROCPAR    3               <span class="comment">// Contains Process Parameters</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MSP_ENV        4               <span class="comment">// Contains environment</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_memory</span> &#123;</span>              <span class="comment">// Descriptor of memory block</span></span><br><span class="line">  ulong          base;                 <span class="comment">// Base address of memory block</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Size of memory block</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Service information, TY_xxx+MEM_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            special;              <span class="comment">// Extension of type, one of MSP_xxx</span></span><br><span class="line">  ulong          owner;                <span class="comment">// Address of owner of the memory</span></span><br><span class="line">  ulong          initaccess;           <span class="comment">// Initial read/write access</span></span><br><span class="line">  ulong          access;               <span class="comment">// Actual status and read/write access</span></span><br><span class="line">  ulong          threadid;             <span class="comment">// Block belongs to this thread or 0</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        sectname[SHORTNAME];  <span class="comment">// Null-terminated section name</span></span><br><span class="line">  uchar          *copy;                <span class="comment">// Copy used in CPU window or NULL</span></span><br><span class="line">  uchar          *decode;              <span class="comment">// Decoding information or NULL</span></span><br><span class="line">&#125; t_memory;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">void</span>)    Flushmemorycache(<span class="keyword">void</span>);</span><br><span class="line">stdapi (ulong)   Readmemory(<span class="keyword">void</span> *buf,ulong addr,ulong size,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (ulong)   Readmemoryex(<span class="keyword">void</span> *buf,ulong addr,ulong size,<span class="keyword">int</span> mode,</span><br><span class="line">                   ulong threadid);</span><br><span class="line">stdapi (ulong)   Writememory(<span class="keyword">const</span> <span class="keyword">void</span> *buf,ulong addr,ulong size,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (t_memory *) Findmemory(ulong addr);</span><br><span class="line">stdapi (uchar *) Finddecode(ulong addr,ulong *psize);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Guardmemory(ulong base,ulong size,<span class="keyword">int</span> guard);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Listmemory(<span class="keyword">void</span>);</span><br><span class="line">stdapi (HGLOBAL) Copymemoryhex(ulong addr,ulong size);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Pastememoryhex(ulong addr,ulong size,</span><br><span class="line">                   <span class="keyword">int</span> ensurebackup,<span class="keyword">int</span> removeanalysis);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Editmemory(HWND hparent,ulong addr,ulong size,</span><br><span class="line">                   <span class="keyword">int</span> ensurebackup,<span class="keyword">int</span> removeanalysis,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> font);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////////////////////// JUMP DATA ///////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Types of recognized jumps and calls.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> JT_TYPE        0x000F          <span class="comment">// Mask to extract data type</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   JT_UNDEF     0x0000          <span class="comment">// End of jump table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   JT_JUMP      0x0001          <span class="comment">// Unconditional jump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   JT_COND      0x0002          <span class="comment">// Conditional jump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   JT_SWITCH    0x0003          <span class="comment">// Jump via switch table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   JT_RET       0x0004          <span class="comment">// RET misused as jump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   JT_CALL      0x0005          <span class="comment">// Call</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   JT_SWCALL    0x0006          <span class="comment">// Call via switch table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   JT_NETJUMP   0x0008          <span class="comment">// Unconditional jump in CIL code</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   JT_NETCOND   0x0009          <span class="comment">// Conditional jump in CIL code</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   JT_NETSW     0x000A          <span class="comment">// Switch jump in CIL code</span></span></span><br><span class="line"><span class="comment">// Used as flag to Addjump, absent in the jump table.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> JT_NOSORT      0x8000          <span class="comment">// Do not sort data implicitly</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Note that these macros work both with t_jmp and t_jmpcall.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Isjump(jmp)    (((jmp)-&gt;type&gt;=JT_JUMP &amp;&amp; (jmp)-&gt;type&lt;=JT_RET) ||       \</span></span><br><span class="line">                       ((jmp)-&gt;type&gt;=JT_NETJUMP &amp;&amp; (jmp)-&gt;type&lt;=JT_NETSW))</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Iscall(jmp)    ((jmp)-&gt;type==JT_CALL || (jmp)-&gt;type==JT_SWCALL)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_jmp</span> &#123;</span>                 <span class="comment">// Descriptor of recognized jump or call</span></span><br><span class="line">  ulong          from;                 <span class="comment">// Address of jump/call command</span></span><br><span class="line">  ulong          dest;                 <span class="comment">// Adress of jump/call destination</span></span><br><span class="line">  uchar          type;                 <span class="comment">// Jump/call type, one of JT_xxx</span></span><br><span class="line">&#125; t_jmp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_exe</span> &#123;</span>                 <span class="comment">// Description of executable module</span></span><br><span class="line">  ulong          base;                 <span class="comment">// Module base</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Module size</span></span><br><span class="line">  <span class="keyword">int</span>            adjusted;             <span class="comment">// Whether base is already adjusted</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        path[MAXPATH];        <span class="comment">// Full module path</span></span><br><span class="line">&#125; t_exe;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_jmpdata</span> &#123;</span>             <span class="comment">// Jump table</span></span><br><span class="line">  ulong          modbase;              <span class="comment">// Base of module owning jump table</span></span><br><span class="line">  ulong          modsize;              <span class="comment">// Size of module owning jump table</span></span><br><span class="line">  t_jmp          *jmpdata;             <span class="comment">// Jump data, sorted by source</span></span><br><span class="line">  <span class="keyword">int</span>            *jmpindex;            <span class="comment">// Indices to jmpdata, sorted by dest</span></span><br><span class="line">  <span class="keyword">int</span>            maxjmp;               <span class="comment">// Total number of elements in arrays</span></span><br><span class="line">  <span class="keyword">int</span>            njmp;                 <span class="comment">// Number of used elements in arrays</span></span><br><span class="line">  <span class="keyword">int</span>            nsorted;              <span class="comment">// Number of sorted elements in arrays</span></span><br><span class="line">  <span class="keyword">int</span>            dontsort;             <span class="comment">// Do not sort data implicitly</span></span><br><span class="line">  t_exe          *exe;                 <span class="comment">// Pointed modules, unsorted</span></span><br><span class="line">  <span class="keyword">int</span>            maxexe;               <span class="comment">// Allocated number of elements in exe</span></span><br><span class="line">  <span class="keyword">int</span>            nexe;                 <span class="comment">// Number of used elements in exe</span></span><br><span class="line">&#125; t_jmpdata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_jmpcall</span> &#123;</span>             <span class="comment">// Descriptor of found jump or call</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Source or destination address</span></span><br><span class="line">  <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span>          type;                 <span class="comment">// Jump/call type, one of JT_xxx</span></span><br><span class="line">    ulong        swcase;               <span class="comment">// First switch case</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125; t_jmpcall;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">int</span>)     Addjump(t_jmpdata *pdat,ulong from,ulong dest,<span class="keyword">int</span> type);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Sortjumpdata(t_jmpdata *pdat);</span><br><span class="line">stdapi (t_jmp *) Findjumpfrom(ulong from);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Findlocaljumpsto(ulong dest,ulong *buf,<span class="keyword">int</span> nbuf);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Findlocaljumpscallsto(ulong dest,t_jmpcall *jmpcall,</span><br><span class="line">                   <span class="keyword">int</span> njmpcall);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Arelocaljumpscallstorange(ulong addr0,ulong addr1);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Findglobalcallsto(ulong dest,ulong *buf,<span class="keyword">int</span> nbuf);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Findglobaljumpscallsto(ulong dest,t_jmpcall *jmpcall,</span><br><span class="line">                   <span class="keyword">int</span> njmpcall);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//////////////////////////////// SETS OF RANGES ////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_range</span> &#123;</span></span><br><span class="line">  ulong        rmin;                   <span class="comment">// Low range limit</span></span><br><span class="line">  ulong        rmax;                   <span class="comment">// High range limit (INCLUDED!)</span></span><br><span class="line">&#125; t_range;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">int</span>)     Initset(t_range *<span class="built_in">set</span>,ulong nmax);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Fullrange(t_range *<span class="built_in">set</span>);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Emptyrange(t_range *<span class="built_in">set</span>);</span><br><span class="line">stdapi (ulong)   Getsetcount(<span class="keyword">const</span> t_range *<span class="built_in">set</span>);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getrangecount(<span class="keyword">const</span> t_range *<span class="built_in">set</span>);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Isinset(<span class="keyword">const</span> t_range *<span class="built_in">set</span>,ulong value);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getrangebymember(<span class="keyword">const</span> t_range *<span class="built_in">set</span>,ulong value,</span><br><span class="line">                   ulong *rmin,ulong *rmax);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getrangebyindex(<span class="keyword">const</span> t_range *<span class="built_in">set</span>,<span class="keyword">int</span> index,</span><br><span class="line">                   ulong *rmin,ulong *rmax);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Addrange(t_range *<span class="built_in">set</span>,ulong rmin,ulong rmax);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Removerange(t_range *<span class="built_in">set</span>,ulong rmin,ulong rmax);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">///////////////////////////////// NESTED DATA //////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// General item types related to nested data.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ND_LEVELMASK   0x000000FF      <span class="comment">// Mask to extract nesting level</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ND_OPENTOP     0x00000100      <span class="comment">// Range is open on the top</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ND_OPENBOTTOM  0x00000200      <span class="comment">// Range is open on the bottom</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ND_NESTHILITE  0x00000400      <span class="comment">// Highlighted bracket</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ND_NESTGRAY    0x00000800      <span class="comment">// Grayed bracket</span></span></span><br><span class="line"><span class="comment">// Types specific to loop data t_loopnest:</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ND_MOREVARS    0x00010000      <span class="comment">// List of loop variables overflowed</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXNEST        32              <span class="comment">// Limit of displayed nesting levels</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_nesthdr</span> &#123;</span>             <span class="comment">// Header of nested data range</span></span><br><span class="line">  ulong          addr0;                <span class="comment">// First address occupied by range</span></span><br><span class="line">  ulong          addr1;                <span class="comment">// Last occupied address (included!)</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Level and user-defined type, TY_xxx</span></span><br><span class="line">  ulong          aprev;                <span class="comment">// First address of previous range</span></span><br><span class="line">&#125; t_nesthdr;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="keyword">void</span> <span class="title">NDDEST</span><span class="params">(t_nesthdr *)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_nested</span> &#123;</span>              <span class="comment">// Descriptor of nested data</span></span><br><span class="line">  <span class="keyword">int</span>            n;                    <span class="comment">// Actual number of elements</span></span><br><span class="line">  <span class="keyword">int</span>            nmax;                 <span class="comment">// Maximal number of elements</span></span><br><span class="line">  ulong          itemsize;             <span class="comment">// Size of single element</span></span><br><span class="line">  <span class="keyword">void</span>           *data;                <span class="comment">// Ordered nested data</span></span><br><span class="line">  ulong          version;              <span class="comment">// Changes on each modification</span></span><br><span class="line">  NDDEST         *destfunc;            <span class="comment">// Destructor function or NULL</span></span><br><span class="line">&#125; t_nested;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">void</span>)    Destroynesteddata(t_nested *nd);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Createnesteddata(t_nested *nd,ulong itemsize,<span class="keyword">int</span> nexp,</span><br><span class="line">                   NDDEST *destfunc);</span><br><span class="line">stdapi (<span class="keyword">void</span> *)  Addnesteddata(t_nested *nd,<span class="keyword">void</span> *item);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Deletenestedrange(t_nested *nd,ulong addr0,ulong addr1);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getnestingpattern(t_nested *nd,ulong addr,<span class="keyword">wchar_t</span> *pat,</span><br><span class="line">                   <span class="keyword">int</span> npat,uchar *mask,<span class="keyword">int</span> showentry,<span class="keyword">int</span> *isend);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getnestingdepth(t_nested *nd,ulong addr);</span><br><span class="line">stdapi (<span class="keyword">void</span> *)  Findnesteddata(t_nested *nd,ulong addr,<span class="keyword">int</span> level);</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">void</span> *)  Nesteddatatoudd(t_nested *nd,ulong base,ulong *datasize);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Uddtonesteddata(t_nested *nd,<span class="keyword">void</span> *data,ulong base,ulong size);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">/////////////////////////////////// MODULES ////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SHT_MERGENEXT  0x00000001      <span class="comment">// Merge section with the next</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NCALLMOD       24              <span class="comment">// Max number of saved called modules</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// .NET stream identifiers. Don&#x27;t change the order and the values of the</span></span><br><span class="line"><span class="comment">// first three items (NS_STRINGS, NS_GUID and NS_BLOB)!</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NS_STRINGS     0               <span class="comment">// Stream with ASCII strings</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NS_GUID        1               <span class="comment">// Stream with GUIDs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NS_BLOB        2               <span class="comment">// Data referenced by MetaData</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NS_US          3               <span class="comment">// Stream with UNICODE strings</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NS_META        4               <span class="comment">// Stream with MetaData tables</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NETSTREAM      5               <span class="comment">// Number of default .NET streams</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Indices of .NET MetaData tables.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_MODULE     0               <span class="comment">// Module table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_TYPEREF    1               <span class="comment">// TypeRef table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_TYPEDEF    2               <span class="comment">// TypeDef table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_FIELDPTR   3               <span class="comment">// FieldPtr table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_FIELD      4               <span class="comment">// Field table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_METHODPTR  5               <span class="comment">// MethodPtr table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_METHOD     6               <span class="comment">// MethodDef table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_PARAMPTR   7               <span class="comment">// ParamPtr table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_PARAM      8               <span class="comment">// Param table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_INTERFACE  9               <span class="comment">// InterfaceImpl table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_MEMBERREF  10              <span class="comment">// MemberRef table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_CONSTANT   11              <span class="comment">// Constant table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_CUSTATTR   12              <span class="comment">// CustomAttribute table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_MARSHAL    13              <span class="comment">// FieldMarshal table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_DECLSEC    14              <span class="comment">// DeclSecurity table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_CLASSLAY   15              <span class="comment">// ClassLayout table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_FIELDLAY   16              <span class="comment">// FieldLayout table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_SIGNATURE  17              <span class="comment">// StandAloneSig table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_EVENTMAP   18              <span class="comment">// EventMap table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_EVENTPTR   19              <span class="comment">// EventPtr table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_EVENT      20              <span class="comment">// Event table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_PROPMAP    21              <span class="comment">// PropertyMap table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_PROPPTR    22              <span class="comment">// PropertyPtr table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_PROPERTY   23              <span class="comment">// Property table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_METHSEM    24              <span class="comment">// MethodSemantics table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_METHIMPL   25              <span class="comment">// MethodImpl table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_MODREF     26              <span class="comment">// ModuleRef table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_TYPESPEC   27              <span class="comment">// TypeSpec table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_IMPLMAP    28              <span class="comment">// ImplMap table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_RVA        29              <span class="comment">// FieldRVA table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_ENCLOG     30              <span class="comment">// ENCLog table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_ENCMAP     31              <span class="comment">// ENCMap table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_ASSEMBLY   32              <span class="comment">// Assembly table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_ASMPROC    33              <span class="comment">// AssemblyProcessor table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_ASMOS      34              <span class="comment">// AssemblyOS table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_ASMREF     35              <span class="comment">// AssemblyRef table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_REFPROC    36              <span class="comment">// AssemblyRefProcessor table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_REFOS      37              <span class="comment">// AssemblyRefOS table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_FILE       38              <span class="comment">// File table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_EXPORT     39              <span class="comment">// ExportedType table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_RESOURCE   40              <span class="comment">// ManifestResource table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_NESTED     41              <span class="comment">// NestedClass table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_GENPARM    42              <span class="comment">// GenericParam table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_METHSPEC   43              <span class="comment">// MethodSpec table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_CONSTR     44              <span class="comment">// GenericParamConstraint table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDT_UNUSED     63              <span class="comment">// Used only in midx[]</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MDTCOUNT       64              <span class="comment">// Number of .NET MetaData tables</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_secthdr</span> &#123;</span>             <span class="comment">// Extract from IMAGE_SECTION_HEADER</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        sectname[<span class="number">12</span>];         <span class="comment">// Null-terminated section name</span></span><br><span class="line">  ulong          base;                 <span class="comment">// Address of section in memory</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Size of section loaded into memory</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Set of SHT_xxx</span></span><br><span class="line">  ulong          fileoffset;           <span class="comment">// Offset of section in file</span></span><br><span class="line">  ulong          rawsize;              <span class="comment">// Size of section in file</span></span><br><span class="line">  ulong          characteristics;      <span class="comment">// Set of IMAGE_SCN_xxx</span></span><br><span class="line">&#125; t_secthdr;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_premod</span> &#123;</span>              <span class="comment">// Preliminary module descriptor</span></span><br><span class="line">  ulong          base;                 <span class="comment">// Base address of the module</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Size of module or 1</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Service information, TY_xxx+MOD_xxx</span></span><br><span class="line">  ulong          entry;                <span class="comment">// Address of &lt;ModuleEntryPoint&gt; or 0</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        path[MAXPATH];        <span class="comment">// Full name of the module</span></span><br><span class="line">&#125; t_premod;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_netstream</span> &#123;</span>           <span class="comment">// Location of default .NET stream</span></span><br><span class="line">  ulong          base;                 <span class="comment">// Base address in memory</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Stream size, bytes</span></span><br><span class="line">&#125; t_netstream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_metadata</span> &#123;</span>            <span class="comment">// Descriptor of .NET MetaData table</span></span><br><span class="line">  ulong          base;                 <span class="comment">// Location in memory or NULL if absent</span></span><br><span class="line">  ulong          rowcount;             <span class="comment">// Number of rows or 0 if absent</span></span><br><span class="line">  ulong          rowsize;              <span class="comment">// Size of single row, bytes, or 0</span></span><br><span class="line">  ushort         nameoffs;             <span class="comment">// Offset of name field</span></span><br><span class="line">  ushort         namesize;             <span class="comment">// Size of name or 0 if absent</span></span><br><span class="line">&#125; t_metadata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_module</span> &#123;</span>              <span class="comment">// Descriptor of executable module</span></span><br><span class="line">  ulong          base;                 <span class="comment">// Base address of module</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Size of memory occupied by module</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Service information, TY_xxx+MOD_xxx</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        modname[SHORTNAME];   <span class="comment">// Short name of the module</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        path[MAXPATH];        <span class="comment">// Full name of the module</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        version[TEXTLEN];     <span class="comment">// Version of executable file</span></span><br><span class="line">  ulong          fixupbase;            <span class="comment">// Base of image in executable file</span></span><br><span class="line">  ulong          codebase;             <span class="comment">// Base address of module code block</span></span><br><span class="line">  ulong          codesize;             <span class="comment">// Size of module code block</span></span><br><span class="line">  ulong          entry;                <span class="comment">// Address of &lt;ModuleEntryPoint&gt; or 0</span></span><br><span class="line">  ulong          sfxentry;             <span class="comment">// Address of SFX-packed entry or 0</span></span><br><span class="line">  ulong          winmain;              <span class="comment">// Address of WinMain or 0</span></span><br><span class="line">  ulong          database;             <span class="comment">// Base address of module data block</span></span><br><span class="line">  ulong          edatabase;            <span class="comment">// Base address of export data table</span></span><br><span class="line">  ulong          edatasize;            <span class="comment">// Size of export data table</span></span><br><span class="line">  ulong          idatatable;           <span class="comment">// Base address of import data table</span></span><br><span class="line">  ulong          iatbase;              <span class="comment">// Base of Import Address Table</span></span><br><span class="line">  ulong          iatsize;              <span class="comment">// Size of IAT</span></span><br><span class="line">  ulong          relocbase;            <span class="comment">// Base address of relocation table</span></span><br><span class="line">  ulong          relocsize;            <span class="comment">// Size of relocation table</span></span><br><span class="line">  ulong          resbase;              <span class="comment">// Base address of resources</span></span><br><span class="line">  ulong          ressize;              <span class="comment">// Size of resources</span></span><br><span class="line">  ulong          tlsbase;              <span class="comment">// Base address of TLS directory table</span></span><br><span class="line">  ulong          tlssize;              <span class="comment">// Size of TLS directory table</span></span><br><span class="line">  ulong          tlscallback;          <span class="comment">// Address of first TLS callback or 0</span></span><br><span class="line">  ulong          netentry;             <span class="comment">// .NET entry (MOD_NETAPP only)</span></span><br><span class="line">  ulong          clibase;              <span class="comment">// .NET CLI header base (MOD_NETAPP)</span></span><br><span class="line">  ulong          clisize;              <span class="comment">// .NET CLI header base (MOD_NETAPP)</span></span><br><span class="line">  t_netstream    netstr[NETSTREAM];    <span class="comment">// Locations of default .NET streams</span></span><br><span class="line">  t_metadata     metadata[MDTCOUNT];   <span class="comment">// Descriptors of .NET MetaData tables</span></span><br><span class="line">  ulong          sfxbase;              <span class="comment">// Base of memory block with SFX</span></span><br><span class="line">  ulong          sfxsize;              <span class="comment">// Size of memory block with SFX</span></span><br><span class="line">  ulong          rawhdrsize;           <span class="comment">// Size of PE header in file</span></span><br><span class="line">  ulong          memhdrsize;           <span class="comment">// Size of PE header in memory</span></span><br><span class="line">  <span class="keyword">int</span>            nsect;                <span class="comment">// Number of sections in the module</span></span><br><span class="line">  t_secthdr      *sect;                <span class="comment">// Extract from section headers</span></span><br><span class="line">  <span class="keyword">int</span>            nfixup;               <span class="comment">// Number of 32-bit fixups</span></span><br><span class="line">  ulong          *fixup;               <span class="comment">// Array of 32-bit fixups</span></span><br><span class="line">  t_jmpdata      jumps;                <span class="comment">// Jumps and calls from this module</span></span><br><span class="line">  t_nested       loopnest;             <span class="comment">// Loop brackets</span></span><br><span class="line">  t_nested       argnest;              <span class="comment">// Call argument brackets</span></span><br><span class="line">  t_simple       predict;              <span class="comment">// Predicted ESP, EBP &amp; results (sd_pred)</span></span><br><span class="line">  t_sorted       strings;              <span class="comment">// Resource strings (t_string)</span></span><br><span class="line">  <span class="keyword">int</span>            saveudd;              <span class="comment">// UDD-relevant data is changed</span></span><br><span class="line">  <span class="keyword">int</span>            ncallmod;             <span class="comment">// No. of called modules (max. NCALLMOD)</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        callmod[NCALLMOD][SHORTNAME]; <span class="comment">// List of called modules</span></span><br><span class="line">&#125; t_module;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Keep t_aqueue identical with the header of t_module!</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_aqueue</span> &#123;</span>              <span class="comment">// Descriptor of module to be analysed</span></span><br><span class="line">  ulong          base;                 <span class="comment">// Base address of module</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Size of memory occupied by module</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Service information, TY_xxx+MOD_xxx</span></span><br><span class="line">&#125; t_aqueue;</span><br><span class="line"></span><br><span class="line">stdapi (t_module *) Findmodule(ulong addr);</span><br><span class="line">stdapi (t_module *) Findmodulebyname(<span class="keyword">wchar_t</span> *shortname);</span><br><span class="line">stdapi (t_module *) Findmainmodule(<span class="keyword">void</span>);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Issystem(ulong addr);</span><br><span class="line">stdapi (ulong *) Findfixup(t_module *pmod,ulong addr);</span><br><span class="line">stdapi (ulong)   Findfileoffset(t_module *pmod,ulong addr);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Decoderange(<span class="keyword">wchar_t</span> *s,ulong addr,ulong size);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getexeversion(<span class="keyword">wchar_t</span> *path,<span class="keyword">wchar_t</span> *version);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getexportfrommemory(ulong addr,<span class="keyword">wchar_t</span> *s);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////////////// LIST OF DEBUGGEE&#x27;S WINDOWS //////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_window</span> &#123;</span>              <span class="comment">// Description of window</span></span><br><span class="line">  ulong          hwnd;                 <span class="comment">// Window&#x27;s handle</span></span><br><span class="line">  ulong          dummy;                <span class="comment">// Must be 1</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Type of window, TY_xxx+WN_xxx</span></span><br><span class="line">  ulong          parenthw;             <span class="comment">// Handle of parent or 0</span></span><br><span class="line">  ulong          winproc;              <span class="comment">// Address of WinProc or 0</span></span><br><span class="line">  ulong          threadid;             <span class="comment">// ID of the owning thread</span></span><br><span class="line">  ulong          exstyle;              <span class="comment">// Extended style</span></span><br><span class="line">  ulong          style;                <span class="comment">// Style</span></span><br><span class="line">  ulong          id;                   <span class="comment">// Identifier</span></span><br><span class="line">  ulong          classproc;            <span class="comment">// Address of default (class) WinProc</span></span><br><span class="line">  RECT           windowrect;           <span class="comment">// Window position, screen coordinates</span></span><br><span class="line">  RECT           clientrect;           <span class="comment">// Client position, screen coordinates</span></span><br><span class="line">  <span class="keyword">int</span>            child;                <span class="comment">// Index of next child</span></span><br><span class="line">  <span class="keyword">int</span>            sibling;              <span class="comment">// Index of next sibling</span></span><br><span class="line">  <span class="keyword">int</span>            byparent;             <span class="comment">// Index when sorted by parent</span></span><br><span class="line">  <span class="keyword">int</span>            level;                <span class="comment">// Level in genealogy (0: topmost)</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        title[TEXTLEN];       <span class="comment">// Window&#x27;s title or text</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        classname[TEXTLEN];   <span class="comment">// Class name</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        tree[MAXNEST];        <span class="comment">// Tree display</span></span><br><span class="line">&#125; t_window;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">/////////////////////////////// NAMELIST WINDOWS ///////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Types of action in WM_USER_NAMES broadcasts (parameter wp).</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NA_FIND        0               <span class="comment">// Check if namelist is already open</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NA_UPDATE      1               <span class="comment">// Update namelist</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NA_CLOSE       2               <span class="comment">// Close namelist</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NA_CLOSEALL    3               <span class="comment">// Close all namelists</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_namecast</span> &#123;</span>            <span class="comment">// Structure passed on broadcast</span></span><br><span class="line">  ulong          base;                 <span class="comment">// Module base, 0 - list of all names</span></span><br><span class="line">  t_table        *table;               <span class="comment">// Filled when broadcast stops</span></span><br><span class="line">&#125; t_namecast;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_namelist</span> &#123;</span>            <span class="comment">// Element of namelist sorted data</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Base address of the entry</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Size of the entry, always 1</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Type &amp; addr extension, TY_xxx+NL_xxx</span></span><br><span class="line">&#125; t_namelist;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////////////////////// RESOURCES ///////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_string</span> &#123;</span>              <span class="comment">// Descriptor of resource string</span></span><br><span class="line">  ulong          id;                   <span class="comment">// Identifier associated with the string</span></span><br><span class="line">  ulong          dummy;                <span class="comment">// Always 1</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Address of string in memory</span></span><br><span class="line">  ulong          count;                <span class="comment">// String size, UNICODE characters!</span></span><br><span class="line">  <span class="keyword">int</span>            language;             <span class="comment">// Language, one of LANG_xxx</span></span><br><span class="line">&#125; t_string;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getmodulestring(t_module *pm,ulong id,<span class="keyword">wchar_t</span> *s);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////////////////////// UDD FILES ///////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SAVEMAGIC      0xFEDCBA98      <span class="comment">// Indicator of savearea validity</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Attention, for the sake of the compatibility between the different OllyDbg</span></span><br><span class="line"><span class="comment">// versions, never, ever change existing elements, only add new!</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_savearea</span> &#123;</span></span><br><span class="line">  ulong          magic;                <span class="comment">// Validity marker, must be SAVEMAGIC</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        dumpstr[SHORTNAME];   <span class="comment">// Last structure decoding in dump</span></span><br><span class="line">&#125; t_savearea;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//////////////////////////// THREADS AND REGISTERS /////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NREG           8               <span class="comment">// Number of registers (of any type)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NSEG           6               <span class="comment">// Number of valid segment registers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NHARD          4               <span class="comment">// Number of hardware breakpoints</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Event ignoring list.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IGNO_INT3      0x00000001      <span class="comment">// Ignore INT3 breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IGNO_ACCESS    0x00000002      <span class="comment">// Ignore memory access violation</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IGNO_HW        0x00000004      <span class="comment">// Ignore hardware breakpoint</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Register displaying mode.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RDM_MODE       0x0000000F      <span class="comment">// Mask to extract display mode</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   RDM_FPU      0x00000000      <span class="comment">// Decode FPU registers as floats</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   RDM_MMX      0x00000001      <span class="comment">// Decode FPU registers as MMX</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   RDM_3DN      0x00000002      <span class="comment">// Decode FPU registers as 3DNow!</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   RDM_DBG      0x00000003      <span class="comment">// Decode debug registers instead of FPU</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RDM_SSEMODE    0x000000F0      <span class="comment">// Mask to extract SSE decoding mode</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   RDM_SSEI32   0x00000000      <span class="comment">// Decode SSE as 4x32-bit hex numbers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   RDM_SSEF32   0x00000010      <span class="comment">// Decode SSE as 4x32-bit floats</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   RDM_SSEF64   0x00000020      <span class="comment">// Decode SSE as 2x64-bit floats</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Status of registers.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RV_MODIFIED    0x00000001      <span class="comment">// Update CONTEXT before run</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RV_USERMOD     0x00000002      <span class="comment">// Registers modified by user</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RV_SSEVALID    0x00000004      <span class="comment">// Whether SSE registers are valid</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RV_SSEMOD      0x00000008      <span class="comment">// Update SSE registers before run</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RV_ERRVALID    0x00000010      <span class="comment">// Whether last thread error is valid</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RV_ERRMOD      0x00000020      <span class="comment">// Update last thread error before run</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RV_MEMVALID    0x00000040      <span class="comment">// Whether memory fields are valid</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RV_DBGMOD      0x00000080      <span class="comment">// Update debugging registers before run</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// CPU flags.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FLAG_C         0x00000001      <span class="comment">// Carry flag</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FLAG_P         0x00000004      <span class="comment">// Parity flag</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FLAG_A         0x00000010      <span class="comment">// Auxiliary carry flag</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FLAG_Z         0x00000040      <span class="comment">// Zero flag</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FLAG_S         0x00000080      <span class="comment">// Sign flag</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FLAG_T         0x00000100      <span class="comment">// Single-step trap flag</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FLAG_D         0x00000400      <span class="comment">// Direction flag</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FLAG_O         0x00000800      <span class="comment">// Overflow flag</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Attention, number of memory fields is limited by the run trace!</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NMEMFIELD      2               <span class="comment">// Number of memory fields in t_reg</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_memfield</span> &#123;</span>            <span class="comment">// Descriptor of memory field</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Address of data in memory</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Data size (0 - no data)</span></span><br><span class="line">  uchar          data[<span class="number">16</span>];             <span class="comment">// Data</span></span><br><span class="line">&#125; t_memfield;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Thread registers.</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_reg</span> &#123;</span>                 <span class="comment">// Excerpt from context</span></span><br><span class="line">  ulong          status;               <span class="comment">// Status of registers, set of RV_xxx</span></span><br><span class="line">  ulong          threadid;             <span class="comment">// ID of thread that owns registers</span></span><br><span class="line">  ulong          ip;                   <span class="comment">// Instruction pointer (EIP)</span></span><br><span class="line">  ulong          r[NREG];              <span class="comment">// EAX,ECX,EDX,EBX,ESP,EBP,ESI,EDI</span></span><br><span class="line">  ulong          flags;                <span class="comment">// Flags</span></span><br><span class="line">  ulong          s[NSEG];              <span class="comment">// Segment registers ES,CS,SS,DS,FS,GS</span></span><br><span class="line">  ulong          base[NSEG];           <span class="comment">// Segment bases</span></span><br><span class="line">  ulong          limit[NSEG];          <span class="comment">// Segment limits</span></span><br><span class="line">  uchar          big[NSEG];            <span class="comment">// Default size (0-16, 1-32 bit)</span></span><br><span class="line">  uchar          dummy[<span class="number">2</span>];             <span class="comment">// Reserved, used for data alignment</span></span><br><span class="line">  <span class="keyword">int</span>            top;                  <span class="comment">// Index of top-of-stack</span></span><br><span class="line">  <span class="keyword">long</span> <span class="keyword">double</span>    f[NREG];              <span class="comment">// Float registers, f[top] - top of stack</span></span><br><span class="line">  uchar          tag[NREG];            <span class="comment">// Float tags (0x3 - empty register)</span></span><br><span class="line">  ulong          fst;                  <span class="comment">// FPU status word</span></span><br><span class="line">  ulong          fcw;                  <span class="comment">// FPU control word</span></span><br><span class="line">  ulong          ferrseg;              <span class="comment">// Selector of last detected FPU error</span></span><br><span class="line">  ulong          feroffs;              <span class="comment">// Offset of last detected FPU error</span></span><br><span class="line">  ulong          dr[NREG];             <span class="comment">// Debug registers</span></span><br><span class="line">  ulong          lasterror;            <span class="comment">// Last thread error or 0xFFFFFFFF</span></span><br><span class="line">  uchar          ssereg[NREG][<span class="number">16</span>];     <span class="comment">// SSE registers</span></span><br><span class="line">  ulong          mxcsr;                <span class="comment">// SSE control and status register</span></span><br><span class="line">  t_memfield     mem[NMEMFIELD];       <span class="comment">// Known memory fields from run trace</span></span><br><span class="line">&#125; t_reg;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_thread</span> &#123;</span>              <span class="comment">// Information about active threads</span></span><br><span class="line">  ulong          threadid;             <span class="comment">// Thread identifier</span></span><br><span class="line">  ulong          dummy;                <span class="comment">// Always 1</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Service information, TY_xxx+THR_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            ordinal;              <span class="comment">// Thread&#x27;s ordinal number (1-based)</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        name[SHORTNAME];      <span class="comment">// Short name of the thread</span></span><br><span class="line">  HANDLE         thread;               <span class="comment">// Thread handle, for OllyDbg only!</span></span><br><span class="line">  ulong          tib;                  <span class="comment">// Thread Information Block</span></span><br><span class="line">  ulong          entry;                <span class="comment">// Thread entry point</span></span><br><span class="line">  CONTEXT        context;              <span class="comment">// Actual context of the thread</span></span><br><span class="line">  t_reg          reg;                  <span class="comment">// Actual contents of registers</span></span><br><span class="line">  <span class="keyword">int</span>            regvalid;             <span class="comment">// Whether reg and context are valid</span></span><br><span class="line">  t_reg          oldreg;               <span class="comment">// Previous contents of registers</span></span><br><span class="line">  <span class="keyword">int</span>            oldregvalid;          <span class="comment">// Whether oldreg is valid</span></span><br><span class="line">  <span class="keyword">int</span>            suspendrun;           <span class="comment">// Suspended for run (0 or 1)</span></span><br><span class="line">  <span class="keyword">int</span>            suspendcount;         <span class="comment">// Temporarily suspended (0..inf)</span></span><br><span class="line">  <span class="keyword">int</span>            suspenduser;          <span class="comment">// Suspended by user (0 or 1)</span></span><br><span class="line">  <span class="keyword">int</span>            trapset;              <span class="comment">// Single-step trap set by OllyDbg</span></span><br><span class="line">  <span class="keyword">int</span>            trapincontext;        <span class="comment">// Trap is catched in exception context</span></span><br><span class="line">  ulong          rtprotocoladdr;       <span class="comment">// Address of destination to protocol</span></span><br><span class="line">  <span class="keyword">int</span>            ignoreonce;           <span class="comment">// Ignore list, IGNO_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            drvalid;              <span class="comment">// Contents of dr is valid</span></span><br><span class="line">  ulong          dr[NREG];             <span class="comment">// Expected state of DR0..3,7</span></span><br><span class="line">  <span class="keyword">int</span>            hwmasked;             <span class="comment">// Temporarily masked hardware breaks</span></span><br><span class="line">  <span class="keyword">int</span>            hwreported;           <span class="comment">// Reported breakpoint expressions</span></span><br><span class="line">  <span class="comment">// Thread-related information gathered by Updatethreaddata().</span></span><br><span class="line">  HWND           hw;                   <span class="comment">// One of windows owned by thread</span></span><br><span class="line">  ulong          usertime;             <span class="comment">// Time in user mode, 100u units or -1</span></span><br><span class="line">  ulong          systime;              <span class="comment">// Time in system mode, 100u units or -1</span></span><br><span class="line">  <span class="comment">// Thread-related information gathered by Listmemory().</span></span><br><span class="line">  ulong          stacktop;             <span class="comment">// Top of thread&#x27;s stack</span></span><br><span class="line">  ulong          stackbottom;          <span class="comment">// Bottom of thread&#x27;s stack</span></span><br><span class="line">&#125; t_thread;</span><br><span class="line"></span><br><span class="line">stdapi (t_thread *) Findthread(ulong threadid);</span><br><span class="line">stdapi (t_thread *) Findthreadbyordinal(<span class="keyword">int</span> ordinal);</span><br><span class="line">stdapi (t_reg *) Threadregisters(ulong threadid);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Decodethreadname(<span class="keyword">wchar_t</span> *s,ulong threadid,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Registermodifiedbyuser(t_thread *pthr);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////////////// ASSEMBLER AND DISASSEMBLER //////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXCMDSIZE     16              <span class="comment">// Maximal length of valid 80x86 command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXSEQSIZE     256             <span class="comment">// Maximal length of command sequence</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INT3           0xCC            <span class="comment">// Code of 1-byte INT3 breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NOP            0x90            <span class="comment">// Code of 1-byte NOP command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NOPERAND       4               <span class="comment">// Maximal allowed number of operands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NEGLIMIT       (-16384)        <span class="comment">// Limit to decode offsets as negative</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DECLIMIT       65536           <span class="comment">// Limit to decode integers as decimal</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Registers.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_UNDEF      (-1)            <span class="comment">// Codes of general purpose registers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_EAX        0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_ECX        1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_EDX        2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_EBX        3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_ESP        4</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_EBP        5</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_ESI        6</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_EDI        7</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_BYTE       0x80            <span class="comment">// Flag used in switch analysis</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_AL         0               <span class="comment">// Symbolic indices of 8-bit registers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_CL         1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_DL         2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_BL         3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_AH         4</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_CH         5</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_DH         6</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_BH         7</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEG_UNDEF      (-1)            <span class="comment">// Codes of segment/selector registers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEG_ES         0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEG_CS         1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEG_SS         2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEG_DS         3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEG_FS         4</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEG_GS         5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Pseudoregisters, used in search for assembler commands.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_R8         NREG            <span class="comment">// 8-bit pseudoregister R8</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_R16        NREG            <span class="comment">// 16-bit pseudoregister R16</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_R32        NREG            <span class="comment">// 32-bit pseudoregister R32</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_ANY        NREG            <span class="comment">// Pseudoregister FPUREG, MMXREG etc.</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEG_ANY        NREG            <span class="comment">// Segment pseudoregister SEG</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_RA         (NREG+1)        <span class="comment">// 32-bit semi-defined pseudoregister RA</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REG_RB         (NREG+2)        <span class="comment">// 32-bit semi-defined pseudoregister RB</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NPSEUDO        (NREG+3)        <span class="comment">// Total count of resisters &amp; pseudoregs</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IS_REAL(r)     ((r)&lt;REG_R32)   <span class="comment">// Checks for real register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IS_PSEUDO(r)   ((r)&gt;=REG_R32)  <span class="comment">// Checks for pseudoregister (undefined)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> IS_SEMI(r)     ((r)&gt;=REG_RA)   <span class="comment">// Checks for semi-defined register</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_NONE         0x00000000      <span class="comment">// No special features</span></span></span><br><span class="line"><span class="comment">// General type of command, only one is allowed.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_CMDTYPE      0x0000001F      <span class="comment">// Mask to extract type of command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_CMD        0x00000000      <span class="comment">// Ordinary (none of listed below)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_MOV        0x00000001      <span class="comment">// Move to or from integer register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_MOVC       0x00000002      <span class="comment">// Conditional move to integer register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_SETC       0x00000003      <span class="comment">// Conditional set integer register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_TEST       0x00000004      <span class="comment">// Used to test data (CMP, TEST, AND...)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_STRING     0x00000005      <span class="comment">// String command with REPxxx prefix</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_JMP        0x00000006      <span class="comment">// Unconditional near jump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_JMPFAR     0x00000007      <span class="comment">// Unconditional far jump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_JMC        0x00000008      <span class="comment">// Conditional jump on flags</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_JMCX       0x00000009      <span class="comment">// Conditional jump on (E)CX (and flags)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_PUSH       0x0000000A      <span class="comment">// PUSH exactly 1 (d)word of data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_POP        0x0000000B      <span class="comment">// POP exactly 1 (d)word of data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_CALL       0x0000000C      <span class="comment">// Plain near call</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_CALLFAR    0x0000000D      <span class="comment">// Far call</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_INT        0x0000000E      <span class="comment">// Interrupt</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_RET        0x0000000F      <span class="comment">// Plain near return from call</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_RETFAR     0x00000010      <span class="comment">// Far return or IRET</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_FPU        0x00000011      <span class="comment">// FPU command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_MMX        0x00000012      <span class="comment">// MMX instruction, incl. SSE extensions</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_3DNOW      0x00000013      <span class="comment">// 3DNow! instruction</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_SSE        0x00000014      <span class="comment">// SSE, SSE2, SSE3 etc. instruction</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_IO         0x00000015      <span class="comment">// Accesses I/O ports</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_SYS        0x00000016      <span class="comment">// Legal but useful in system code only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_PRIVILEGED 0x00000017      <span class="comment">// Privileged (non-Ring3) command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_DATA       0x0000001C      <span class="comment">// Data recognized by Analyser</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_PSEUDO     0x0000001D      <span class="comment">// Pseudocommand, for search models only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_PREFIX     0x0000001E      <span class="comment">// Standalone prefix</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_BAD        0x0000001F      <span class="comment">// Bad or unrecognized command</span></span></span><br><span class="line"><span class="comment">// Additional parts of the command.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_SIZE01       0x00000020      <span class="comment">// Bit 0x01 in last cmd is data size</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_POSTBYTE     0x00000040      <span class="comment">// Command continues in postbyte</span></span></span><br><span class="line"><span class="comment">// For string commands, either long or short form can be selected.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_LONGFORM     0x00000080      <span class="comment">// Long form of string command</span></span></span><br><span class="line"><span class="comment">// Decoding of some commands depends on data or address size.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_SIZEMASK     0x00000F00      <span class="comment">// Mask for data/address size dependence</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_DATA16     0x00000100      <span class="comment">// Requires 16-bit data size</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_DATA32     0x00000200      <span class="comment">// Requires 32-bit data size</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_ADDR16     0x00000400      <span class="comment">// Requires 16-bit address size</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_ADDR32     0x00000800      <span class="comment">// Requires 32-bit address size</span></span></span><br><span class="line"><span class="comment">// Prefixes that command may, must or must not possess.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_MUSTMASK     0x0000F000      <span class="comment">// Mask for fixed set of prefixes</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_NOMUST     0x00000000      <span class="comment">// No obligatory prefixes (default)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_MUST66     0x00001000      <span class="comment">// (SSE) Requires 66, no F2 or F3</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_MUSTF2     0x00002000      <span class="comment">// (SSE) Requires F2, no 66 or F3</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_MUSTF3     0x00003000      <span class="comment">// (SSE) Requires F3, no 66 or F2</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_MUSTNONE   0x00004000      <span class="comment">// (MMX,SSE) Requires no 66, F2 or F3</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_NEEDF2     0x00005000      <span class="comment">// (SSE) Requires F2, no F3</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_NEEDF3     0x00006000      <span class="comment">// (SSE) Requires F3, no F2</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_NOREP      0x00007000      <span class="comment">// Must not include F2 or F3</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_MUSTREP    0x00008000      <span class="comment">// Must include F3 (REP)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_MUSTREPE   0x00009000      <span class="comment">// Must include F3 (REPE)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_MUSTREPNE  0x0000A000      <span class="comment">// Must include F2 (REPNE)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_LOCKABLE     0x00010000      <span class="comment">// Allows for F0 (LOCK, memory only)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_BHINT        0x00020000      <span class="comment">// Allows for branch hints (2E, 3E)</span></span></span><br><span class="line"><span class="comment">// Decoding of some commands with ModRM-SIB depends whether register or memory.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_MEMORY       0x00040000      <span class="comment">// Mod field must indicate memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_REGISTER     0x00080000      <span class="comment">// Mod field must indicate register</span></span></span><br><span class="line"><span class="comment">// Side effects caused by command.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_FLAGMASK     0x00700000      <span class="comment">// Mask to extract modified flags</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_NOFLAGS    0x00000000      <span class="comment">// Flags S,Z,P,O,C remain unchanged</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_ALLFLAGS   0x00100000      <span class="comment">// Modifies flags S,Z,P,O,C</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_FLAGZ      0x00200000      <span class="comment">// Modifies flag Z only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_FLAGC      0x00300000      <span class="comment">// Modifies flag C only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_FLAGSCO    0x00400000      <span class="comment">// Modifies flag C and O only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_FLAGD      0x00500000      <span class="comment">// Modifies flag D only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_FLAGSZPC   0x00600000      <span class="comment">// Modifies flags Z, P and C only (FPU)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_NOCFLAG    0x00700000      <span class="comment">// S,Z,P,O modified, C unaffected</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_FPUMASK      0x01800000      <span class="comment">// Mask for effects on FPU stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_FPUSAME    0x00000000      <span class="comment">// Doesn&#x27;t rotate FPU stack (default)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_FPUPOP     0x00800000      <span class="comment">// Pops FPU stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_FPUPOP2    0x01000000      <span class="comment">// Pops FPU stack twice</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_FPUPUSH    0x01800000      <span class="comment">// Pushes FPU stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_CHGESP       0x02000000      <span class="comment">// Command indirectly modifies ESP</span></span></span><br><span class="line"><span class="comment">// Command features.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_HLADIR       0x04000000      <span class="comment">// Nonstandard order of operands in HLA</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_WILDCARD     0x08000000      <span class="comment">// Mnemonics contains W/D wildcard (&#x27;*&#x27;)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_COND         0x10000000      <span class="comment">// Conditional (action depends on flags)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_USESCARRY    0x20000000      <span class="comment">// Uses Carry flag</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D_USEMASK      0xC0000000      <span class="comment">// Mask to detect unusual commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_RARE       0x40000000      <span class="comment">// Rare or obsolete in Win32 apps</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_SUSPICIOUS 0x80000000      <span class="comment">// Suspicious command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   D_UNDOC      0xC0000000      <span class="comment">// Undocumented command</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Extension of D_xxx.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DX_ZEROMASK    0x00000003      <span class="comment">// How to decode FLAGS.Z flag</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DX_JE        0x00000001      <span class="comment">// JE, JNE instead of JZ, JNZ</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DX_JZ        0x00000002      <span class="comment">// JZ, JNZ instead of JE, JNE</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DX_CARRYMASK   0x0000000C      <span class="comment">// How to decode FLAGS.C flag</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DX_JB        0x00000004      <span class="comment">// JAE, JB instead of JC, JNC</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DX_JC        0x00000008      <span class="comment">// JC, JNC instead of JAE, JB</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DX_WONKYTRAP   0x00000100      <span class="comment">// Don&#x27;t single-step this command</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Type of operand, only one is allowed.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> B_ARGMASK      0x000000FF      <span class="comment">// Mask to extract type of argument</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_NONE       0x00000000      <span class="comment">// Operand absent</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_AL         0x00000001      <span class="comment">// Register AL</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_AH         0x00000002      <span class="comment">// Register AH</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_AX         0x00000003      <span class="comment">// Register AX</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_CL         0x00000004      <span class="comment">// Register CL</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_CX         0x00000005      <span class="comment">// Register CX</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_DX         0x00000006      <span class="comment">// Register DX</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_DXPORT     0x00000007      <span class="comment">// Register DX as I/O port address</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_EAX        0x00000008      <span class="comment">// Register EAX</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_EBX        0x00000009      <span class="comment">// Register EBX</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_ECX        0x0000000A      <span class="comment">// Register ECX</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_EDX        0x0000000B      <span class="comment">// Register EDX</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_ACC        0x0000000C      <span class="comment">// Accumulator (AL/AX/EAX)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_STRCNT     0x0000000D      <span class="comment">// Register CX or ECX as REPxx counter</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_DXEDX      0x0000000E      <span class="comment">// Register DX or EDX in DIV/MUL</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_BPEBP      0x0000000F      <span class="comment">// Register BP or EBP in ENTER/LEAVE</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_REG        0x00000010      <span class="comment">// 8/16/32-bit register in Reg</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_REG16      0x00000011      <span class="comment">// 16-bit register in Reg</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_REG32      0x00000012      <span class="comment">// 32-bit register in Reg</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_REGCMD     0x00000013      <span class="comment">// 16/32-bit register in last cmd byte</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_REGCMD8    0x00000014      <span class="comment">// 8-bit register in last cmd byte</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_ANYREG     0x00000015      <span class="comment">// Reg field is unused, any allowed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_INT        0x00000016      <span class="comment">// 8/16/32-bit register/memory in ModRM</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_INT8       0x00000017      <span class="comment">// 8-bit register/memory in ModRM</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_INT16      0x00000018      <span class="comment">// 16-bit register/memory in ModRM</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_INT32      0x00000019      <span class="comment">// 32-bit register/memory in ModRM</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_INT1632    0x0000001A      <span class="comment">// 16/32-bit register/memory in ModRM</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_INT64      0x0000001B      <span class="comment">// 64-bit integer in ModRM, memory only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_INT128     0x0000001C      <span class="comment">// 128-bit integer in ModRM, memory only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_IMMINT     0x0000001D      <span class="comment">// 8/16/32-bit int at immediate addr</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_INTPAIR    0x0000001E      <span class="comment">// Two signed 16/32 in ModRM, memory only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SEGOFFS    0x0000001F      <span class="comment">// 16:16/16:32 absolute address in memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_STRDEST    0x00000020      <span class="comment">// 8/16/32-bit string dest, [ES:(E)DI]</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_STRDEST8   0x00000021      <span class="comment">// 8-bit string destination, [ES:(E)DI]</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_STRSRC     0x00000022      <span class="comment">// 8/16/32-bit string source, [(E)SI]</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_STRSRC8    0x00000023      <span class="comment">// 8-bit string source, [(E)SI]</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_XLATMEM    0x00000024      <span class="comment">// 8-bit memory in XLAT, [(E)BX+AL]</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_EAXMEM     0x00000025      <span class="comment">// Reference to memory addressed by [EAX]</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_LONGDATA   0x00000026      <span class="comment">// Long data in ModRM, mem only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_ANYMEM     0x00000027      <span class="comment">// Reference to memory, data unimportant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_STKTOP     0x00000028      <span class="comment">// 16/32-bit int top of stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_STKTOPFAR  0x00000029      <span class="comment">// Top of stack (16:16/16:32 far addr)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_STKTOPEFL  0x0000002A      <span class="comment">// 16/32-bit flags on top of stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_STKTOPA    0x0000002B      <span class="comment">// 16/32-bit top of stack all registers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_PUSH       0x0000002C      <span class="comment">// 16/32-bit int push to stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_PUSHRET    0x0000002D      <span class="comment">// 16/32-bit push of return address</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_PUSHRETF   0x0000002E      <span class="comment">// 16:16/16:32-bit push of far retaddr</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_PUSHA      0x0000002F      <span class="comment">// 16/32-bit push all registers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_EBPMEM     0x00000030      <span class="comment">// 16/32-bit int at [EBP]</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SEG        0x00000031      <span class="comment">// Segment register in Reg</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SEGNOCS    0x00000032      <span class="comment">// Segment register in Reg, but not CS</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SEGCS      0x00000033      <span class="comment">// Segment register CS</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SEGDS      0x00000034      <span class="comment">// Segment register DS</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SEGES      0x00000035      <span class="comment">// Segment register ES</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SEGFS      0x00000036      <span class="comment">// Segment register FS</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SEGGS      0x00000037      <span class="comment">// Segment register GS</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SEGSS      0x00000038      <span class="comment">// Segment register SS</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_ST         0x00000039      <span class="comment">// 80-bit FPU register in last cmd byte</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_ST0        0x0000003A      <span class="comment">// 80-bit FPU register ST0</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_ST1        0x0000003B      <span class="comment">// 80-bit FPU register ST1</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_FLOAT32    0x0000003C      <span class="comment">// 32-bit float in ModRM, memory only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_FLOAT64    0x0000003D      <span class="comment">// 64-bit float in ModRM, memory only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_FLOAT80    0x0000003E      <span class="comment">// 80-bit float in ModRM, memory only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_BCD        0x0000003F      <span class="comment">// 80-bit BCD in ModRM, memory only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_MREG8x8    0x00000040      <span class="comment">// MMX register as 8 8-bit integers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_MMX8x8     0x00000041      <span class="comment">// MMX reg/memory as 8 8-bit integers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_MMX8x8DI   0x00000042      <span class="comment">// MMX 8 8-bit integers at [DS:(E)DI]</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_MREG16x4   0x00000043      <span class="comment">// MMX register as 4 16-bit integers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_MMX16x4    0x00000044      <span class="comment">// MMX reg/memory as 4 16-bit integers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_MREG32x2   0x00000045      <span class="comment">// MMX register as 2 32-bit integers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_MMX32x2    0x00000046      <span class="comment">// MMX reg/memory as 2 32-bit integers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_MREG64     0x00000047      <span class="comment">// MMX register as 1 64-bit integer</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_MMX64      0x00000048      <span class="comment">// MMX reg/memory as 1 64-bit integer</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_3DREG      0x00000049      <span class="comment">// 3DNow! register as 2 32-bit floats</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_3DNOW      0x0000004A      <span class="comment">// 3DNow! reg/memory as 2 32-bit floats</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_XMM0I32x4  0x0000004B      <span class="comment">// XMM0 as 4 32-bit integers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_XMM0I64x2  0x0000004C      <span class="comment">// XMM0 as 2 64-bit integers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_XMM0I8x16  0x0000004D      <span class="comment">// XMM0 as 16 8-bit integers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SREGF32x4  0x0000004E      <span class="comment">// SSE register as 4 32-bit floats</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SREGF32L   0x0000004F      <span class="comment">// Low 32-bit float in SSE register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SREGF32x2L 0x00000050      <span class="comment">// Low 2 32-bit floats in SSE register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SSEF32x4   0x00000051      <span class="comment">// SSE reg/memory as 4 32-bit floats</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SSEF32L    0x00000052      <span class="comment">// Low 32-bit float in SSE reg/memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SSEF32x2L  0x00000053      <span class="comment">// Low 2 32-bit floats in SSE reg/memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SREGF64x2  0x00000054      <span class="comment">// SSE register as 2 64-bit floats</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SREGF64L   0x00000055      <span class="comment">// Low 64-bit float in SSE register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SSEF64x2   0x00000056      <span class="comment">// SSE reg/memory as 2 64-bit floats</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SSEF64L    0x00000057      <span class="comment">// Low 64-bit float in SSE reg/memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SREGI8x16  0x00000058      <span class="comment">// SSE register as 16 8-bit sigints</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SSEI8x16   0x00000059      <span class="comment">// SSE reg/memory as 16 8-bit sigints</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SSEI8x16DI 0x0000005A      <span class="comment">// SSE 16 8-bit sigints at [DS:(E)DI]</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SSEI8x8L   0x0000005B      <span class="comment">// Low 8 8-bit ints in SSE reg/memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SSEI8x4L   0x0000005C      <span class="comment">// Low 4 8-bit ints in SSE reg/memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SSEI8x2L   0x0000005D      <span class="comment">// Low 2 8-bit ints in SSE reg/memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SREGI16x8  0x0000005E      <span class="comment">// SSE register as 8 16-bit sigints</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SSEI16x8   0x0000005F      <span class="comment">// SSE reg/memory as 8 16-bit sigints</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SSEI16x4L  0x00000060      <span class="comment">// Low 4 16-bit ints in SSE reg/memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SSEI16x2L  0x00000061      <span class="comment">// Low 2 16-bit ints in SSE reg/memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SREGI32x4  0x00000062      <span class="comment">// SSE register as 4 32-bit sigints</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SREGI32L   0x00000063      <span class="comment">// Low 32-bit sigint in SSE register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SREGI32x2L 0x00000064      <span class="comment">// Low 2 32-bit sigints in SSE register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SSEI32x4   0x00000065      <span class="comment">// SSE reg/memory as 4 32-bit sigints</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SSEI32x2L  0x00000066      <span class="comment">// Low 2 32-bit sigints in SSE reg/memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SREGI64x2  0x00000067      <span class="comment">// SSE register as 2 64-bit sigints</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SSEI64x2   0x00000068      <span class="comment">// SSE reg/memory as 2 64-bit sigints</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SREGI64L   0x00000069      <span class="comment">// Low 64-bit sigint in SSE register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_EFL        0x0000006A      <span class="comment">// Flags register EFL</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_FLAGS8     0x0000006B      <span class="comment">// Flags (low byte)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_OFFSET     0x0000006C      <span class="comment">// 16/32 const offset from next command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_BYTEOFFS   0x0000006D      <span class="comment">// 8-bit sxt const offset from next cmd</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_FARCONST   0x0000006E      <span class="comment">// 16:16/16:32 absolute address constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_DESCR      0x0000006F      <span class="comment">// 16:32 descriptor in ModRM</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_1          0x00000070      <span class="comment">// Immediate constant 1</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_CONST8     0x00000071      <span class="comment">// Immediate 8-bit constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_CONST8_2   0x00000072      <span class="comment">// Immediate 8-bit const, second in cmd</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_CONST16    0x00000073      <span class="comment">// Immediate 16-bit constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_CONST      0x00000074      <span class="comment">// Immediate 8/16/32-bit constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_CONSTL     0x00000075      <span class="comment">// Immediate 16/32-bit constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SXTCONST   0x00000076      <span class="comment">// Immediate 8-bit sign-extended to size</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_CR         0x00000077      <span class="comment">// Control register in Reg</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_CR0        0x00000078      <span class="comment">// Control register CR0</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_DR         0x00000079      <span class="comment">// Debug register in Reg</span></span></span><br><span class="line"><span class="comment">// Type modifiers, used for interpretation of contents, only one is allowed.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> B_MODMASK      0x000F0000      <span class="comment">// Mask to extract type modifier</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_NONSPEC    0x00000000      <span class="comment">// Non-specific operand</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_UNSIGNED   0x00010000      <span class="comment">// Decode as unsigned decimal</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SIGNED     0x00020000      <span class="comment">// Decode as signed decimal</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_BINARY     0x00030000      <span class="comment">// Decode as binary (full hex) data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_BITCNT     0x00040000      <span class="comment">// Bit count</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_SHIFTCNT   0x00050000      <span class="comment">// Shift count</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_COUNT      0x00060000      <span class="comment">// General-purpose count</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_NOADDR     0x00070000      <span class="comment">// Not an address</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_JMPCALL    0x00080000      <span class="comment">// Near jump/call/return destination</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_JMPCALLFAR 0x00090000      <span class="comment">// Far jump/call/return destination</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_STACKINC   0x000A0000      <span class="comment">// Unsigned stack increment/decrement</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   B_PORT       0x000B0000      <span class="comment">// I/O port</span></span></span><br><span class="line"><span class="comment">// Validity markers.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> B_MEMORY       0x00100000      <span class="comment">// Memory only, reg version different</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> B_REGISTER     0x00200000      <span class="comment">// Register only, mem version different</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> B_MEMONLY      0x00400000      <span class="comment">// Warn if operand in register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> B_REGONLY      0x00800000      <span class="comment">// Warn if operand in memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> B_32BITONLY    0x01000000      <span class="comment">// Warn if 16-bit operand</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> B_NOESP        0x02000000      <span class="comment">// ESP is not allowed</span></span></span><br><span class="line"><span class="comment">// Miscellaneous options.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> B_SHOWSIZE     0x08000000      <span class="comment">// Always show argument size in disasm</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> B_CHG          0x10000000      <span class="comment">// Changed, old contents is not used</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> B_UPD          0x20000000      <span class="comment">// Modified using old contents</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> B_PSEUDO       0x40000000      <span class="comment">// Pseoudooperand, not in assembler cmd</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> B_NOSEG        0x80000000      <span class="comment">// Don&#x27;t add offset of selector</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Analysis data. Note that DEC_PBODY==DEC_PROC|DEC_PEND; this allows for</span></span><br><span class="line"><span class="comment">// automatical merging of overlapping procedures. Also note that DEC_NET is</span></span><br><span class="line"><span class="comment">// followed, if necessary, by a sequence of DEC_NEXTDATA and not DEC_NEXTCODE!</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DEC_TYPEMASK   0x1F            <span class="comment">// Type of analyzed byte</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_UNKNOWN  0x00            <span class="comment">// Not analyzed, treat as command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_NEXTCODE 0x01            <span class="comment">// Next byte of command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_NEXTDATA 0x02            <span class="comment">// Next byte of data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_FILLDATA 0x03            <span class="comment">// Not recognized, treat as byte data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_INT      0x04            <span class="comment">// First byte of integer</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_SWITCH   0x05            <span class="comment">// First byte of switch item or count</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_DATA     0x06            <span class="comment">// First byte of integer data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_DB       0x07            <span class="comment">// First byte of byte string</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_DUMP     0x08            <span class="comment">// First byte of byte string with dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_ASCII    0x09            <span class="comment">// First byte of ASCII string</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_ASCCNT   0x0A            <span class="comment">// Next chunk of ASCII string</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_UNICODE  0x0B            <span class="comment">// First byte of UNICODE string</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_UNICNT   0x0C            <span class="comment">// Next chunk of UNICODE string</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_FLOAT    0x0D            <span class="comment">// First byte of floating number</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_GUID     0x10            <span class="comment">// First byte of GUID</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_NETCMD   0x18            <span class="comment">// First byte of .NET (CIL) command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_JMPNET   0x19            <span class="comment">// First byte of .NET at jump destination</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_CALLNET  0x1A            <span class="comment">// First byte of .NET at call destination</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_COMMAND  0x1C            <span class="comment">// First byte of ordinary command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_JMPDEST  0x1D            <span class="comment">// First byte of cmd at jump destination</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_CALLDEST 0x1E            <span class="comment">// First byte of cmd at call destination</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_FILLING  0x1F            <span class="comment">// Command used to fill gaps</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DEC_PROCMASK   0x60            <span class="comment">// Procedure analysis</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_NOPROC   0x00            <span class="comment">// Outside the procedure</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_PROC     0x20            <span class="comment">// Start of procedure</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_PEND     0x40            <span class="comment">// End of procedure</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DEC_PBODY    0x60            <span class="comment">// Body of procedure</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DEC_TRACED     0x80            <span class="comment">// Hit when traced</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Full type of predicted data.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PST_GENMASK    0xFFFFFC00      <span class="comment">// Mask for ESP generation</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PST_GENINC   0x00000400      <span class="comment">// Increment of ESP generation</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PST_UNCERT     0x00000200      <span class="comment">// Uncertain, probably modified by call</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PST_NONSTACK   0x00000100      <span class="comment">// Not a stack, internal use only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PST_REL        0x00000080      <span class="comment">// Fixup/reladdr counter of constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PST_BASE       0x0000007F      <span class="comment">// Mask for basical description</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PST_SPEC     0x00000040      <span class="comment">// Special contents, type in PST_GENMASK</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PST_VALID    0x00000020      <span class="comment">// Contents valid</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PST_ADDR     0x00000010      <span class="comment">// Contents is in memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PST_ORIG     0x00000008      <span class="comment">// Based on reg contents at entry point</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PST_OMASK    0x00000007      <span class="comment">// Mask to extract original register</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Types of special contents when PST_SPEC is set.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PSS_SPECMASK   PST_GENMASK     <span class="comment">// Mask for type of special contents</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PSS_SEHPTR   0x00000400      <span class="comment">// Pointer to SEH chain</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NSTACK         12              <span class="comment">// Number of predicted stack entries</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NSTKMOD        24              <span class="comment">// Max no. of predicted stack mod addr</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NMEM           2               <span class="comment">// Number of predicted memory locations</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_modrm</span> &#123;</span>               <span class="comment">// ModRM decoding</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Total size with SIB and disp, bytes</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">t_modrm</span> *<span class="title">psib</span>;</span>                <span class="comment">// Pointer to SIB table or NULL</span></span><br><span class="line">  ulong          dispsize;             <span class="comment">// Size of displacement or 0 if none</span></span><br><span class="line">  ulong          features;             <span class="comment">// Operand features, set of OP_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            reg;                  <span class="comment">// Register index or REG_UNDEF</span></span><br><span class="line">  <span class="keyword">int</span>            defseg;               <span class="comment">// Default selector (SEG_xxx)</span></span><br><span class="line">  uchar          scale[NREG];          <span class="comment">// Scales of registers in memory address</span></span><br><span class="line">  ulong          aregs;                <span class="comment">// List of registers used in address</span></span><br><span class="line">  <span class="keyword">int</span>            basereg;              <span class="comment">// Register used as base or REG_UNDEF</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        ardec[SHORTNAME];     <span class="comment">// Register part of address, INTEL fmt</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        aratt[SHORTNAME];     <span class="comment">// Register part of address, AT&amp;T fmt</span></span><br><span class="line">&#125; t_modrm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_predict</span> &#123;</span>             <span class="comment">// Prediction of execution</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Predicted EIP or NULL if uncertain</span></span><br><span class="line">  ulong          one;                  <span class="comment">// Must be 1</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Type, TY_xxx/PR_xxx</span></span><br><span class="line">  ushort         flagsmeaning;         <span class="comment">// Set of DX_ZEROMASK|DX_CARRYMASK</span></span><br><span class="line">  ulong          rstate[NREG];         <span class="comment">// State of register, set of PST_xxx</span></span><br><span class="line">  ulong          rconst[NREG];         <span class="comment">// Constant related to register</span></span><br><span class="line">  ulong          jmpstate;             <span class="comment">// State of EIP after jump or return</span></span><br><span class="line">  ulong          jmpconst;             <span class="comment">// Constant related to jump or return</span></span><br><span class="line">  ulong          espatpushbp;          <span class="comment">// Offset of ESP at PUSH EBP</span></span><br><span class="line">  <span class="keyword">int</span>            nstack;               <span class="comment">// Number of valid stack entries</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">long</span>         soffset;              <span class="comment">// Offset of data on stack (signed!)</span></span><br><span class="line">    ulong        sstate;               <span class="comment">// State of stack data, set of PST_xxx</span></span><br><span class="line">    ulong        sconst;               <span class="comment">// Constant related to stack data</span></span><br><span class="line">  &#125; <span class="built_in">stack</span>[NSTACK];</span><br><span class="line">  <span class="keyword">int</span>            nstkmod;              <span class="comment">// Number of valid stkmod addresses</span></span><br><span class="line">  ulong          stkmod[NSTKMOD];      <span class="comment">// Addresses of stack modifications</span></span><br><span class="line">  <span class="keyword">int</span>            nmem;                 <span class="comment">// Number of valid memory entries</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    ulong        maddr;                <span class="comment">// Address of doubleword variable</span></span><br><span class="line">    ulong        mstate;               <span class="comment">// State of memory, set of PST_xxx</span></span><br><span class="line">    ulong        mconst;               <span class="comment">// Constant related to memory data</span></span><br><span class="line">  &#125; mem[NMEM];</span><br><span class="line">  ulong          resstate;             <span class="comment">// State of result of command execution</span></span><br><span class="line">  ulong          resconst;             <span class="comment">// Constant related to result</span></span><br><span class="line">&#125; t_predict;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_callpredict</span> &#123;</span>         <span class="comment">// Simplified prediction</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Predicted EIP or NULL if uncertain</span></span><br><span class="line">  ulong          one;                  <span class="comment">// Must be 1</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Type of prediction, TY_xxx/PR_xxx</span></span><br><span class="line">  ulong          eaxstate;             <span class="comment">// State of EAX, set of PST_xxx</span></span><br><span class="line">  ulong          eaxconst;             <span class="comment">// Constant related to EAX</span></span><br><span class="line">  <span class="keyword">int</span>            nstkmod;              <span class="comment">// Number of valid stkmod addresses</span></span><br><span class="line">  ulong          stkmod[NSTKMOD];      <span class="comment">// Addresses of stack modifications</span></span><br><span class="line">  ulong          resstate;             <span class="comment">// State of result of command execution</span></span><br><span class="line">  ulong          resconst;             <span class="comment">// Constant related to result</span></span><br><span class="line">&#125; t_callpredict;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Location of operand, only one bit is allowed.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_SOMEREG     0x000000FF      <span class="comment">// Mask for any kind of register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   OP_REGISTER  0x00000001      <span class="comment">// Operand is a general-purpose register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   OP_SEGREG    0x00000002      <span class="comment">// Operand is a segment register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   OP_FPUREG    0x00000004      <span class="comment">// Operand is a FPU register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   OP_MMXREG    0x00000008      <span class="comment">// Operand is a MMX register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   OP_3DNOWREG  0x00000010      <span class="comment">// Operand is a 3DNow! register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   OP_SSEREG    0x00000020      <span class="comment">// Operand is a SSE register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   OP_CREG      0x00000040      <span class="comment">// Operand is a control register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   OP_DREG      0x00000080      <span class="comment">// Operand is a debug register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_MEMORY      0x00000100      <span class="comment">// Operand is in memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_CONST       0x00000200      <span class="comment">// Operand is an immediate constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_PORT        0x00000400      <span class="comment">// Operand is an I/O port</span></span></span><br><span class="line"><span class="comment">// Additional operand properties.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_INVALID     0x00001000      <span class="comment">// Invalid operand, like reg in mem-only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_PSEUDO      0x00002000      <span class="comment">// Pseudooperand (not in mnenonics)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_MOD         0x00004000      <span class="comment">// Command may change/update operand</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_MODREG      0x00008000      <span class="comment">// Memory, but modifies reg (POP,MOVSD)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_REL         0x00010000      <span class="comment">// Relative or fixuped const or address</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_IMPORT      0x00020000      <span class="comment">// Value imported from different module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_SELECTOR    0x00040000      <span class="comment">// Includes immediate selector</span></span></span><br><span class="line"><span class="comment">// Additional properties of memory address.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_INDEXED     0x00080000      <span class="comment">// Memory address contains registers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_OPCONST     0x00100000      <span class="comment">// Memory address contains constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_ADDR16      0x00200000      <span class="comment">// 16-bit memory address</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_ADDR32      0x00400000      <span class="comment">// Explicit 32-bit memory address</span></span></span><br><span class="line"><span class="comment">// Value of operand.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_OFFSOK      0x00800000      <span class="comment">// Offset to selector valid</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_ADDROK      0x01000000      <span class="comment">// Address valid</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_VALUEOK     0x02000000      <span class="comment">// Value (max. 16 bytes) valid</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_PREDADDR    0x04000000      <span class="comment">// Address predicted, not actual</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_PREDVAL     0x08000000      <span class="comment">// Value predicted, not actual</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_RTLOGMEM    0x10000000      <span class="comment">// Memory contents got from run trace</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   OP_ACTVALID  0x20000000      <span class="comment">// Actual value is valid</span></span></span><br><span class="line"><span class="comment">// Pseudooperands, used in assembler search models only.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_ANYMEM      0x40000000      <span class="comment">// Any memory location</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP_ANY         0x80000000      <span class="comment">// Any operand</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_operand</span> &#123;</span>             <span class="comment">// Description of disassembled operand</span></span><br><span class="line">  <span class="comment">// Description of operand.</span></span><br><span class="line">  ulong          features;             <span class="comment">// Operand features, set of OP_xxx</span></span><br><span class="line">  ulong          arg;                  <span class="comment">// Operand type, set of B_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            optype;               <span class="comment">// DEC_INT, DEC_FLOAT or DEC_UNKNOWN</span></span><br><span class="line">  <span class="keyword">int</span>            opsize;               <span class="comment">// Total size of data, bytes</span></span><br><span class="line">  <span class="keyword">int</span>            granularity;          <span class="comment">// Size of element (opsize exc. MMX/SSE)</span></span><br><span class="line">  <span class="keyword">int</span>            reg;                  <span class="comment">// REG_xxx (also ESP in POP) or REG_UNDEF</span></span><br><span class="line">  ulong          uses;                 <span class="comment">// List of used regs (not in address!)</span></span><br><span class="line">  ulong          modifies;             <span class="comment">// List of modified regs (not in addr!)</span></span><br><span class="line">  <span class="comment">// Description of memory address.</span></span><br><span class="line">  <span class="keyword">int</span>            seg;                  <span class="comment">// Selector (SEG_xxx)</span></span><br><span class="line">  uchar          scale[NREG];          <span class="comment">// Scales of registers in memory address</span></span><br><span class="line">  ulong          aregs;                <span class="comment">// List of registers used in address</span></span><br><span class="line">  ulong          opconst;              <span class="comment">// Constant or const part of address</span></span><br><span class="line">  <span class="comment">// Value of operand.</span></span><br><span class="line">  ulong          offset;               <span class="comment">// Offset to selector (usually addr)</span></span><br><span class="line">  ulong          selector;             <span class="comment">// Immediate selector in far jump/call</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Address of operand in memory</span></span><br><span class="line">  <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">    ulong        u;                    <span class="comment">// Value of operand (integer form)</span></span><br><span class="line">    <span class="keyword">signed</span> <span class="keyword">long</span>  s;                    <span class="comment">// Value of operand (signed form)</span></span><br><span class="line">    uchar        value[<span class="number">16</span>]; &#125;;         <span class="comment">// Value of operand (general form)</span></span><br><span class="line">  uchar          actual[<span class="number">16</span>];           <span class="comment">// Actual memory (if OP_ACTVALID)</span></span><br><span class="line">  <span class="comment">// Textual decoding.</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        text[TEXTLEN];        <span class="comment">// Operand, decoded to text</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        comment[TEXTLEN];     <span class="comment">// Commented address and contents</span></span><br><span class="line">&#125; t_operand;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Prefix list.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PF_SEGMASK     0x0000003F      <span class="comment">// Mask for segment override prefixes</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PF_ES        0x00000001      <span class="comment">// 0x26, ES segment override</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PF_CS        0x00000002      <span class="comment">// 0x2E, CS segment override</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PF_SS        0x00000004      <span class="comment">// 0x36, SS segment override</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PF_DS        0x00000008      <span class="comment">// 0x3E, DS segment override</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PF_FS        0x00000010      <span class="comment">// 0x64, FS segment override</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PF_GS        0x00000020      <span class="comment">// 0x65, GS segment override</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PF_DSIZE       0x00000040      <span class="comment">// 0x66, data size override</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PF_ASIZE       0x00000080      <span class="comment">// 0x67, address size override</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PF_LOCK        0x00000100      <span class="comment">// 0xF0, bus lock</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PF_REPMASK     0x00000600      <span class="comment">// Mask for repeat prefixes</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PF_REPNE     0x00000200      <span class="comment">// 0xF2, REPNE prefix</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PF_REP       0x00000400      <span class="comment">// 0xF3, REP/REPE prefix</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PF_BYTE        0x00000800      <span class="comment">// Size bit in command, used in cmdexec</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PF_MUSTMASK    D_MUSTMASK      <span class="comment">// Necessary prefixes, used in t_asmmod</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PF_66          PF_DSIZE        <span class="comment">// Alternative names for SSE prefixes</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PF_F2          PF_REPNE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PF_F3          PF_REP</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PF_HINT        (PF_CS|PF_DS)   <span class="comment">// Alternative names for branch hints</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PF_NOTTAKEN  PF_CS</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   PF_TAKEN     PF_DS</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Disassembling errors.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAE_NOERR      0x00000000      <span class="comment">// No error</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAE_BADCMD     0x00000001      <span class="comment">// Unrecognized command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAE_CROSS      0x00000002      <span class="comment">// Command crosses end of memory block</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAE_MEMORY     0x00000004      <span class="comment">// Register where only memory allowed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAE_REGISTER   0x00000008      <span class="comment">// Memory where only register allowed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAE_LOCK       0x00000010      <span class="comment">// LOCK prefix is not allowed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAE_BADSEG     0x00000020      <span class="comment">// Invalid segment register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAE_SAMEPREF   0x00000040      <span class="comment">// Two prefixes from the same group</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAE_MANYPREF   0x00000080      <span class="comment">// More than 4 prefixes</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAE_BADCR      0x00000100      <span class="comment">// Invalid CR register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAE_INTERN     0x00000200      <span class="comment">// Internal error</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Disassembling warnings.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_DATASIZE   0x00000001      <span class="comment">// Superfluous data size prefix</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_ADDRSIZE   0x00000002      <span class="comment">// Superfluous address size prefix</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_SEGPREFIX  0x00000004      <span class="comment">// Superfluous segment override prefix</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_REPPREFIX  0x00000008      <span class="comment">// Superfluous REPxx prefix</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_DEFSEG     0x00000010      <span class="comment">// Segment prefix coincides with default</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_JMP16      0x00000020      <span class="comment">// 16-bit jump, call or return</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_FARADDR    0x00000040      <span class="comment">// Far jump or call</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_SEGMOD     0x00000080      <span class="comment">// Modifies segment register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_PRIV       0x00000100      <span class="comment">// Privileged command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_IO         0x00000200      <span class="comment">// I/O command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_SHIFT      0x00000400      <span class="comment">// Shift out of range 1..31</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_LOCK       0x00000800      <span class="comment">// Command with valid LOCK prefix</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_STACK      0x00001000      <span class="comment">// Unaligned stack operation</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_NOESP      0x00002000      <span class="comment">// Suspicious use of stack pointer</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_RARE       0x00004000      <span class="comment">// Rare, seldom used command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_NONCLASS   0x00008000      <span class="comment">// Non-standard or non-documented code</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAW_INTERRUPT  0x00010000      <span class="comment">// Interrupt command</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Conditions of conditional commands.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAF_NOCOND     0x00000000      <span class="comment">// Unconditional command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAF_TRUE       0x00000001      <span class="comment">// Condition is true</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAF_FALSE      0x00000002      <span class="comment">// Condition is false</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DAF_ANYCOND    0x00000003      <span class="comment">// Condition is not predictable</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_disasm</span> &#123;</span>              <span class="comment">// Disassembled command</span></span><br><span class="line">  <span class="comment">// In the case that DA_HILITE flag is set, fill these members before calling</span></span><br><span class="line">  <span class="comment">// Disasm(). Parameter hilitereg has priority over hiliteindex.</span></span><br><span class="line">  ulong          hilitereg;            <span class="comment">// One of OP_SOMEREG if reg highlighting</span></span><br><span class="line">  <span class="keyword">int</span>            hiregindex;           <span class="comment">// Index of register to highlight</span></span><br><span class="line">  <span class="keyword">int</span>            hiliteindex;          <span class="comment">// Index of highlighting scheme (0: none)</span></span><br><span class="line">  <span class="comment">// Starting from this point, no need to initialize the members of t_disasm.</span></span><br><span class="line">  ulong          ip;                   <span class="comment">// Address of first command byte</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Full length of command, bytes</span></span><br><span class="line">  ulong          cmdtype;              <span class="comment">// Type of command, D_xxx</span></span><br><span class="line">  ulong          exttype;              <span class="comment">// More features, set of DX_xxx</span></span><br><span class="line">  ulong          prefixes;             <span class="comment">// List of prefixes, set of PF_xxx</span></span><br><span class="line">  ulong          nprefix;              <span class="comment">// Number of prefixes, including SSE2</span></span><br><span class="line">  ulong          memfixup;             <span class="comment">// Offset of first 4-byte fixup or -1</span></span><br><span class="line">  ulong          immfixup;             <span class="comment">// Offset of second 4-byte fixup or -1</span></span><br><span class="line">  <span class="keyword">int</span>            errors;               <span class="comment">// Set of DAE_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            warnings;             <span class="comment">// Set of DAW_xxx</span></span><br><span class="line">  <span class="comment">// Note that used registers are those which contents is necessary to create</span></span><br><span class="line">  <span class="comment">// result. Modified registers are those which value is changed. For example,</span></span><br><span class="line">  <span class="comment">// command MOV EAX,[EBX+ECX] uses EBX and ECX and modifies EAX. Command</span></span><br><span class="line">  <span class="comment">// ADD ESI,EDI uses ESI and EDI and modifies ESI.</span></span><br><span class="line">  ulong          uses;                 <span class="comment">// List of used registers</span></span><br><span class="line">  ulong          modifies;             <span class="comment">// List of modified registers</span></span><br><span class="line">  <span class="comment">// Useful shortcuts.</span></span><br><span class="line">  <span class="keyword">int</span>            condition;            <span class="comment">// Condition, one of DAF_xxx</span></span><br><span class="line">  ulong          jmpaddr;              <span class="comment">// Jump/call destination or 0</span></span><br><span class="line">  ulong          memconst;             <span class="comment">// Constant in memory address or 0</span></span><br><span class="line">  ulong          stackinc;             <span class="comment">// Data size in ENTER/RETN/RETF</span></span><br><span class="line">  <span class="comment">// Operands.</span></span><br><span class="line">  t_operand      op[NOPERAND];         <span class="comment">// Operands</span></span><br><span class="line">  <span class="comment">// Textual decoding.</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        dump[TEXTLEN];        <span class="comment">// Hex dump of the command</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        result[TEXTLEN];      <span class="comment">// Fully decoded command as text</span></span><br><span class="line">  uchar          mask[TEXTLEN];        <span class="comment">// Mask to highlight result</span></span><br><span class="line">  <span class="keyword">int</span>            maskvalid;            <span class="comment">// Mask corresponds to result</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        comment[TEXTLEN];     <span class="comment">// Comment that applies to whole command</span></span><br><span class="line">&#125; t_disasm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_opinfo</span> &#123;</span>              <span class="comment">// Operand in t_cmdinfo</span></span><br><span class="line">  ulong          features;             <span class="comment">// Operand features, set of OP_xxx</span></span><br><span class="line">  ulong          arg;                  <span class="comment">// Operand type, set of B_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            opsize;               <span class="comment">// Total size of data, bytes</span></span><br><span class="line">  <span class="keyword">int</span>            reg;                  <span class="comment">// REG_xxx (also ESP in POP) or REG_UNDEF</span></span><br><span class="line">  <span class="keyword">int</span>            seg;                  <span class="comment">// Selector (SEG_xxx)</span></span><br><span class="line">  uchar          scale[NREG];          <span class="comment">// Scales of registers in memory address</span></span><br><span class="line">  ulong          opconst;              <span class="comment">// Constant or const part of address</span></span><br><span class="line">&#125; t_opinfo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_cmdinfo</span> &#123;</span>             <span class="comment">// Information on command</span></span><br><span class="line">  ulong          ip;                   <span class="comment">// Address of first command byte</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Full length of command, bytes</span></span><br><span class="line">  ulong          cmdtype;              <span class="comment">// Type of command, D_xxx</span></span><br><span class="line">  ulong          prefixes;             <span class="comment">// List of prefixes, set of PF_xxx</span></span><br><span class="line">  ulong          nprefix;              <span class="comment">// Number of prefixes, including SSE2</span></span><br><span class="line">  ulong          memfixup;             <span class="comment">// Offset of first 4-byte fixup or -1</span></span><br><span class="line">  ulong          immfixup;             <span class="comment">// Offset of second 4-byte fixup or -1</span></span><br><span class="line">  <span class="keyword">int</span>            errors;               <span class="comment">// Set of DAE_xxx</span></span><br><span class="line">  ulong          jmpaddr;              <span class="comment">// Jump/call destination or 0</span></span><br><span class="line">  ulong          stackinc;             <span class="comment">// Data size in ENTER/RETN/RETF</span></span><br><span class="line">  t_opinfo       op[NOPERAND];         <span class="comment">// Operands</span></span><br><span class="line">&#125; t_cmdinfo;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ATTENTION, when making any changes to this structure, apply them to the</span></span><br><span class="line"><span class="comment">// file Cmdemul.asm, too!</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_emu</span> &#123;</span>                 <span class="comment">// Parameters passed to emulation routine</span></span><br><span class="line">  ulong          operand[NOPERAND];    <span class="comment">// I/O: Operands</span></span><br><span class="line">  ulong          opsize;               <span class="comment">// IN:  Size of operands</span></span><br><span class="line">  ulong          memaddr;              <span class="comment">// OUT: Save address, or 0 if none</span></span><br><span class="line">  ulong          memsize;              <span class="comment">// OUT: Save size (1, 2 or 4 bytes)</span></span><br><span class="line">  ulong          memdata;              <span class="comment">// OUT: Data to save</span></span><br><span class="line">&#125; t_emu;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="keyword">void</span> <span class="title">TRACEFUNC</span><span class="params">(ulong *,ulong *,t_predict *,t_disasm *)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="keyword">void</span> __cdecl <span class="title">EMUFUNC</span><span class="params">(t_emu *,t_reg *)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_bincmd</span> &#123;</span>              <span class="comment">// Description of 80x86 command</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        *name;                <span class="comment">// Symbolic name for this command</span></span><br><span class="line">  ulong          cmdtype;              <span class="comment">// Command&#x27;s features, set of D_xxx</span></span><br><span class="line">  ulong          exttype;              <span class="comment">// More features, set of DX_xxx</span></span><br><span class="line">  ulong          length;               <span class="comment">// Length of main code (before ModRM/SIB)</span></span><br><span class="line">  ulong          mask;                 <span class="comment">// Mask for first 4 bytes of the command</span></span><br><span class="line">  ulong          code;                 <span class="comment">// Compare masked bytes with this</span></span><br><span class="line">  ulong          postbyte;             <span class="comment">// Postbyte</span></span><br><span class="line">  ulong          arg[NOPERAND];        <span class="comment">// Types of arguments, set of B_xxx</span></span><br><span class="line">  TRACEFUNC      *trace;               <span class="comment">// Result prediction function</span></span><br><span class="line">  EMUFUNC        *emu;                 <span class="comment">// Command emulation function</span></span><br><span class="line">&#125; t_bincmd;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AMF_SAMEORDER  0x01            <span class="comment">// Same order of index registers in addr</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AMF_ANYSEG     0x02            <span class="comment">// Command has undefined segment prefix</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AMF_POSTBYTE   0x04            <span class="comment">// Includes postbyte</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AMF_IMPRECISE  0x08            <span class="comment">// Command is imprecise (search only)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AMF_ANYSIZE    0x10            <span class="comment">// Any operand size is acceptable</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AMF_NOSMALL    0x20            <span class="comment">// 16-bit address is not allowed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AMF_UNDOC      0x40            <span class="comment">// Undocumented command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AMF_NEWCMD     0x80            <span class="comment">// Marks new command in multiline</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AMP_REGISTER   0x01            <span class="comment">// Operand is a register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AMP_MEMORY     0x02            <span class="comment">// Operand is a memory location</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AMP_CONST      0x04            <span class="comment">// Operand is a constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AMP_IMPRECISE  0x08            <span class="comment">// Constant is imprecise</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AMP_ANYMEM     0x10            <span class="comment">// Any memory operand is acceptable</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AMP_ANYOP      0x20            <span class="comment">// Any operand is acceptable</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_modop</span> &#123;</span>               <span class="comment">// Operand in assembler model</span></span><br><span class="line">  uchar          features;             <span class="comment">// Operand features, set of AMP_xxx</span></span><br><span class="line">  uchar          reg;                  <span class="comment">// (Pseudo)register operand</span></span><br><span class="line">  uchar          scale[NPSEUDO];       <span class="comment">// Scales of (pseudo)registers in address</span></span><br><span class="line">  ulong          opconst;              <span class="comment">// Constant or const part of address</span></span><br><span class="line">&#125; t_modop;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Assembler command model.</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_asmmod</span> &#123;</span>              <span class="comment">// Description of assembled command</span></span><br><span class="line">  uchar          code[MAXCMDSIZE];     <span class="comment">// Binary code</span></span><br><span class="line">  uchar          mask[MAXCMDSIZE];     <span class="comment">// Mask for binary code (0: bit ignored)</span></span><br><span class="line">  ulong          prefixes;             <span class="comment">// List of prefixes, set of PF_xxx</span></span><br><span class="line">  uchar          ncode;                <span class="comment">// Length of code w/o prefixes, bytes</span></span><br><span class="line">  uchar          features;             <span class="comment">// Code features, set of AMF_xxx</span></span><br><span class="line">  uchar          postbyte;             <span class="comment">// Postbyte (if AMF_POSTBYTE set)</span></span><br><span class="line">  uchar          noperand;             <span class="comment">// Number of operands (no pseudooperands)</span></span><br><span class="line">  t_modop        op[NOPERAND];         <span class="comment">// Description of operands</span></span><br><span class="line">&#125; t_asmmod;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_asmlist</span> &#123;</span>             <span class="comment">// Descriptor of the sequence of models</span></span><br><span class="line">  t_asmmod       *pasm;                <span class="comment">// Pointer to the start of the sequence</span></span><br><span class="line">  <span class="keyword">int</span>            length;               <span class="comment">// Length of the sequence, models</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        comment[TEXTLEN];     <span class="comment">// Comment to the sequence</span></span><br><span class="line">&#125; t_asmlist;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DA_TEXT        0x00000001      <span class="comment">// Decode command to text and comment</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DA_HILITE    0x00000002      <span class="comment">// Use syntax highlighting (set t_disasm)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DA_OPCOMM      0x00000004      <span class="comment">// Comment operands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DA_DUMP        0x00000008      <span class="comment">// Dump command to hexadecimal text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DA_MEMORY      0x00000010      <span class="comment">// OK to read memory and use labels</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DA_NOIMPORT  0x00000020      <span class="comment">// When reading memory, hold the imports</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DA_RTLOGMEM  0x00000040      <span class="comment">// Use memory saved by run trace</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DA_NOSTACKP  0x00000080      <span class="comment">// Hide &quot;Stack&quot; prefix in comments</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DA_STEPINTO    0x00000100      <span class="comment">// Enter CALL when predicting registers</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DA_SHOWARG     0x00000200      <span class="comment">// Use predict if address ESP/EBP-based</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DA_NOPSEUDO    0x00000400      <span class="comment">// Skip pseudooperands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DA_FORHELP     0x00000800      <span class="comment">// Decode operands for command help</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> USEDECODE      ((uchar *)1)    <span class="comment">// Request to get decoding automatically</span></span></span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">int</span>)     Byteregtodwordreg(<span class="keyword">int</span> bytereg);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Printfloat4(<span class="keyword">wchar_t</span> *s,<span class="keyword">float</span> f);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Printfloat8(<span class="keyword">wchar_t</span> *s,<span class="keyword">double</span> d);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Printfloat10(<span class="keyword">wchar_t</span> *s,<span class="keyword">long</span> <span class="keyword">double</span> ext);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Printmmx(<span class="keyword">wchar_t</span> *s,uchar *data);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Commentcharacter(<span class="keyword">wchar_t</span> *s,<span class="keyword">int</span> c,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Nameoffloat(<span class="keyword">wchar_t</span> *s,uchar *data,ulong size);</span><br><span class="line">stdapi (ulong)   Disasm(uchar *cmd,ulong cmdsize,ulong ip,uchar *dec,</span><br><span class="line">                   t_disasm *da,<span class="keyword">int</span> mode,t_reg *reg,</span><br><span class="line">                   t_predict *predict);</span><br><span class="line">stdapi (ulong)   Cmdinfo(uchar *cmd,ulong cmdsize,ulong cmdip,</span><br><span class="line">                   t_cmdinfo *ci,<span class="keyword">int</span> cmdmode,t_reg *cmdreg);</span><br><span class="line">stdapi (ulong)   Disassembleforward(uchar *copy,ulong base,ulong size,</span><br><span class="line">                   ulong ip,ulong n,uchar *decode);</span><br><span class="line">stdapi (ulong)   Disassembleback(uchar *copy,ulong base,ulong size,</span><br><span class="line">                   ulong ip,ulong n,uchar *decode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Checkcondition(<span class="keyword">int</span> code,ulong flags);</span><br><span class="line">stdapi (ulong)   Setcondition(<span class="keyword">int</span> code,ulong flags);</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AM_ALLOWBAD    0x00000001      <span class="comment">// Allow bad or undocumented commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AM_IMPRECISE   0x00000002      <span class="comment">// Generate imprecise (search) forms</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   AM_MULTI     0x00000004      <span class="comment">// Multiple commands are allowed</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AM_SEARCH      AM_IMPRECISE</span></span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">int</span>)     Assembleallforms(<span class="keyword">wchar_t</span> *src,ulong ip,t_asmmod *model,</span><br><span class="line">                   <span class="keyword">int</span> maxmodel,<span class="keyword">int</span> mode,<span class="keyword">wchar_t</span> *errtxt);</span><br><span class="line">stdapi (ulong)   Assemble(<span class="keyword">wchar_t</span> *src,ulong ip,uchar *buf,ulong nbuf,<span class="keyword">int</span> mode,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *errtxt);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////////////////// .NET DISASSEMBLER ///////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// CIL command types.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N_CMDTYPE      0x0000001F      <span class="comment">// Mask to extract type of command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_CMD        0x00000000      <span class="comment">// Ordinary (none of listed below)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_JMP        0x00000001      <span class="comment">// Unconditional jump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_JMC        0x00000002      <span class="comment">// Conditional jump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_CALL       0x00000003      <span class="comment">// Call</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_RET        0x00000004      <span class="comment">// Return (also from exception)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_SWITCH     0x00000005      <span class="comment">// Switch, followed by N cases</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_PREFIX     0x00000006      <span class="comment">// Prefix, not a standalone command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_DATA       0x0000001E      <span class="comment">// Command is decoded as data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_BAD        0x0000001F      <span class="comment">// Bad command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N_POPMASK      0x00000F00      <span class="comment">// Mask to extract number of pops</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_POP0       0x00000000      <span class="comment">// Pops no arguments (default)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_POP1       0x00000100      <span class="comment">// Pops 1 argument from stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_POP2       0x00000200      <span class="comment">// Pops 2 arguments from stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_POP3       0x00000300      <span class="comment">// Pops 3 arguments from stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_POPX       0x00000F00      <span class="comment">// Pops variable arguments from stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N_PUSHMASK     0x0000F000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_PUSH0      0x00000000      <span class="comment">// Pushes no data (default)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_PUSH1      0x00001000      <span class="comment">// Pushes 1 argument into stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_PUSH2      0x00002000      <span class="comment">// Pushes 2 arguments into stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   N_PUSHX      0x0000F000      <span class="comment">// Pushes 0 or 1 argument into stack</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// CIL explicit operand types.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> A_ARGMASK      0x000000FF      <span class="comment">// Mask to extract type of argument</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_NONE       0x00000000      <span class="comment">// No operand</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_OFFSET     0x00000001      <span class="comment">// 32-bit offset from next command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_BYTEOFFS   0x00000002      <span class="comment">// 8-bit offset from next command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_METHOD     0x00000003      <span class="comment">// 32-bit method descriptor</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_SIGNATURE  0x00000004      <span class="comment">// 32-bit signature of call types</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_TYPE       0x00000005      <span class="comment">// 32-bit type descriptor</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_FIELD      0x00000006      <span class="comment">// 32-bit field descriptor</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_STRING     0x00000007      <span class="comment">// 32-bit string descriptor</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_TOKEN      0x00000008      <span class="comment">// 32-bit token descriptor</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_INDEX1     0x00000009      <span class="comment">// 8-bit immediate index constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_INDEX2     0x0000000A      <span class="comment">// 16-bit immediate index constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_SWCOUNT    0x0000000B      <span class="comment">// 32-bit immediate switch count</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_INT1S      0x0000000C      <span class="comment">// 8-bit immediate signed integer const</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_INT4       0x0000000D      <span class="comment">// 32-bit immediate integer constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_INT8       0x0000000E      <span class="comment">// 64-bit immediate integer constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_FLOAT4     0x0000000F      <span class="comment">// 32-bit immediate float constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_FLOAT8     0x00000010      <span class="comment">// 64-bit immediate float constant</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_NOLIST     0x00000011      <span class="comment">// 8-bit list following no. prefix</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   A_ALIGN      0x00000012      <span class="comment">// 8-bit alignment following unaligned.</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_netasm</span> &#123;</span>              <span class="comment">// Disassembled .NET CIL command</span></span><br><span class="line">  ulong          ip;                   <span class="comment">// Address of first command byte</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Full length of command, bytes</span></span><br><span class="line">  ulong          cmdtype;              <span class="comment">// Type of command, N_xxx</span></span><br><span class="line">  ulong          cmdsize;              <span class="comment">// Size of command, bytes</span></span><br><span class="line">  ulong          opsize;               <span class="comment">// Size of operand, bytes, or 0 if none</span></span><br><span class="line">  ulong          nswitch;              <span class="comment">// Size of following switch table, dwords</span></span><br><span class="line">  ulong          jmpaddr;              <span class="comment">// Single jump/call destination or 0</span></span><br><span class="line">  ulong          descriptor;           <span class="comment">// Descriptor (xx)xxxxxx or 0</span></span><br><span class="line">  ulong          dataaddr;             <span class="comment">// Address of pointed object/data or 0</span></span><br><span class="line">  <span class="keyword">int</span>            errors;               <span class="comment">// Set of DAE_xxx</span></span><br><span class="line">  <span class="comment">// Description of operand.</span></span><br><span class="line">  ulong          optype;               <span class="comment">// Operand type, set of A_xxx</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        optext[TEXTLEN];      <span class="comment">// Operand, decoded to text</span></span><br><span class="line">  <span class="comment">// Textual decoding.</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        dump[TEXTLEN];        <span class="comment">// Hex dump of the command</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        result[TEXTLEN];      <span class="comment">// Fully decoded command as text</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        comment[TEXTLEN];     <span class="comment">// Comment that applies to whole command</span></span><br><span class="line">&#125; t_netasm;</span><br><span class="line"></span><br><span class="line">stdapi (ulong)   Ndisasm(uchar *cmd,ulong size,ulong ip,t_netasm *da,</span><br><span class="line">                   <span class="keyword">int</span> mode,t_module *pmod);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">/////////////////////////////////// ANALYSIS ///////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXARG         256             <span class="comment">// Maximal sane number of arguments</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NGUESS         7               <span class="comment">// Max number of args in type analysis</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AA_MANUAL      0               <span class="comment">// No automatical analysis</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AA_MAINONLY    1               <span class="comment">// Automatically analyse main module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AA_NONSYS      2               <span class="comment">// Automatically analyse non-sys modules</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AA_ALL         3               <span class="comment">// Automatically analyse all modules</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AO_ISFORMATA   0x01            <span class="comment">// Argument is probable ASCII format</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AO_SIGFORMATA  0x02            <span class="comment">// Non-trivial ASCII format</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AO_ISFORMATW   0x04            <span class="comment">// Argument is probable UNICODE format</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AO_SIGFORMATW  0x08            <span class="comment">// Non-trivial UNICODE format</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AO_NOTFORMAT   0x10            <span class="comment">// Argument is not a format</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AO_ISCOUNT     0x20            <span class="comment">// Argument is count of remaining args</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AO_NOTCOUNT    0x40            <span class="comment">// Argument is not a count</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_procdata</span> &#123;</span>            <span class="comment">// Description of procedure</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Address of entry point</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Size of simple procedure or 1</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Type of procedure, TY_xxx/PD_xxx</span></span><br><span class="line">  ulong          retsize;              <span class="comment">// Size of return (if PD_RETSIZE)</span></span><br><span class="line">  ulong          localsize;            <span class="comment">// Size of reserved locals, 0 - unknown</span></span><br><span class="line">  ulong          savedebp;             <span class="comment">// Offset of cmd after PUSH EBP, 0 - none</span></span><br><span class="line">  ulong          features;             <span class="comment">// Type of known code, RAW_xxx</span></span><br><span class="line">  <span class="keyword">char</span>           generic[<span class="number">12</span>];          <span class="comment">// Generic name (without _INTERN_)</span></span><br><span class="line">  <span class="keyword">int</span>            narg;                 <span class="comment">// No. of stack DWORDs (PD_NARG/VARARG)</span></span><br><span class="line">  <span class="keyword">int</span>            nguess;               <span class="comment">// Number of guessed args (if PD_NGUESS)</span></span><br><span class="line">  <span class="keyword">int</span>            npush;                <span class="comment">// Number of pushed args (if PD_NPUSH)</span></span><br><span class="line">  <span class="keyword">int</span>            usedarg;              <span class="comment">// Min. number of accessed arguments</span></span><br><span class="line">  uchar          preserved;            <span class="comment">// Preserved registers</span></span><br><span class="line">  uchar          argopt[NGUESS];       <span class="comment">// Guessed argument options, AO_xxx</span></span><br><span class="line">&#125; t_procdata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_argnest</span> &#123;</span>             <span class="comment">// Header of call arguments bracket</span></span><br><span class="line">  ulong          addr0;                <span class="comment">// First address occupied by range</span></span><br><span class="line">  ulong          addr1;                <span class="comment">// Last occupied address (included!)</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Level and user-defined type, TY_xxx</span></span><br><span class="line">  ulong          aprev;                <span class="comment">// First address of previous range</span></span><br><span class="line">&#125; t_argnest;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NLOOPVAR       4               <span class="comment">// Max number of loop variables</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_loopnest</span> &#123;</span>            <span class="comment">// Header of loop bracket</span></span><br><span class="line">  ulong          addr0;                <span class="comment">// First address occupied by range</span></span><br><span class="line">  ulong          addr1;                <span class="comment">// Last occupied address (included!)</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Level and user-defined type, TY_xxx</span></span><br><span class="line">  ulong          aprev;                <span class="comment">// First address of previous range</span></span><br><span class="line">  ulong          eoffs;                <span class="comment">// Offset of entry point from addr0</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> &#123;</span>                             <span class="comment">// Loop registers and variables</span></span><br><span class="line">    uchar        type;                 <span class="comment">// Combination of PRED_xxx</span></span><br><span class="line">    <span class="keyword">long</span>         espoffset;            <span class="comment">// For locals, offset to original ESP</span></span><br><span class="line">    <span class="keyword">long</span>         increment;            <span class="comment">// Increment after loop</span></span><br><span class="line">  &#125; loopvar[NLOOPVAR];</span><br><span class="line">&#125; t_loopnest;</span><br><span class="line"></span><br><span class="line">stdapi (ulong)   Getpackednetint(uchar *code,ulong size,ulong *value);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Removeanalysis(ulong base,ulong size,<span class="keyword">int</span> keephittrace);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Maybecommand(ulong addr,<span class="keyword">int</span> requireanalysis);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////////////////////// STACK WALK //////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SF_FMUNREL     0x00000001      <span class="comment">// Predicted frame is unreliable</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SF_BPUNREL     0x00000002      <span class="comment">// Predicted EBP is unreliable</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SF_VIRTUAL     0x00000004      <span class="comment">// DBGHELP: EBP is undefined</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_sframe</span> &#123;</span>              <span class="comment">// Stack frame descriptor</span></span><br><span class="line">  <span class="comment">// Input parameters, fill before call to Findretaddrdata().</span></span><br><span class="line">  ulong          eip;                  <span class="comment">// Address of command that owns frame</span></span><br><span class="line">  ulong          esp;                  <span class="comment">// ESP at EIP</span></span><br><span class="line">  ulong          ebp;                  <span class="comment">// EBP at EIP, or 0 if unknown</span></span><br><span class="line">  <span class="comment">// Parameters used by DBGHELP.DLL, initialize only before the first call.</span></span><br><span class="line">  <span class="keyword">int</span>            firstcall;            <span class="comment">// First call to Findretaddrdata()</span></span><br><span class="line">  HANDLE         thread;               <span class="comment">// Thread handle</span></span><br><span class="line">  CONTEXT        context;              <span class="comment">// Copy of CONTEXT, fill on first call</span></span><br><span class="line">  <span class="keyword">int</span>            contextvalid;         <span class="comment">// Whether context contains valid data</span></span><br><span class="line">  <span class="comment">// Output parameters.</span></span><br><span class="line">  ulong          status;               <span class="comment">// Set of SF_xxx</span></span><br><span class="line">  ulong          oldeip;               <span class="comment">// Address of CALL or 0 if unknown</span></span><br><span class="line">  ulong          oldesp;               <span class="comment">// ESP at CALL or 0 if unknown</span></span><br><span class="line">  ulong          oldebp;               <span class="comment">// EBP at CALL or 0 if unknown</span></span><br><span class="line">  ulong          retpos;               <span class="comment">// Address of return in stack</span></span><br><span class="line">  ulong          procaddr;             <span class="comment">// Entry of current function or 0</span></span><br><span class="line">  <span class="comment">// Parameters used by DBGHELP.DLL, don&#x27;t initialize!</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">ifdef</span> STACKFRAME64                  <span class="comment">// Requires &lt;dbghelp.h&gt;</span></span></span><br><span class="line">    STACKFRAME64 sf;                   <span class="comment">// Stack frame for StackWalk64()</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">    uchar        dummy[<span class="number">264</span>];           <span class="comment">// Replaces STACKFRAME64</span></span><br><span class="line">  <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">&#125; t_sframe;</span><br><span class="line"></span><br><span class="line">stdapi (ulong)   Isretaddr(ulong retaddr,ulong *procaddr);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Findretaddrdata(t_sframe *pf,ulong base,ulong size);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">/////////////////////////////// KNOWN FUNCTIONS ////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NARG           24              <span class="comment">// Max number of arguments in a function</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADEC_VALID     0x00000001      <span class="comment">// Value valid</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADEC_PREDICTED 0x00000002      <span class="comment">// Value predicted</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADEC_CHGNAME   0x00000004      <span class="comment">// Allow name change of substituted arg</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ADEC_MARK      0x00000008      <span class="comment">// (out) Important parameter</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Type of argument in the description of function or structure. Note that</span></span><br><span class="line"><span class="comment">// ARG_STRUCT is allowed only in conjunction with ARG_POINTER.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ARG_POINTER    0x01            <span class="comment">// Argument is a pointer</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ARG_BASE       0x06            <span class="comment">// Mask to extract base type of argument</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   ARG_TYPE     0x00            <span class="comment">// Argument is a type</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   ARG_STRUCT   0x02            <span class="comment">// Argument is a structure</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   ARG_DIRECT   0x04            <span class="comment">// Argument is a direct string</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ARG_OUT        0x08            <span class="comment">// Pointer to data undefined at call</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ARG_MARK       0x10            <span class="comment">// Important parameter</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ARG_ELLIPSYS   0x20            <span class="comment">// Followed by ellipsys</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ARG_VALID      0x40            <span class="comment">// Must always be set to avoid argx=0</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ARG_TYPEMASK   (ARG_POINTER|ARG_BASE)    <span class="comment">// Mask to extract full type</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ARG_PTYPE      (ARG_POINTER|ARG_TYPE)    <span class="comment">// Pointer to type</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ARG_PSTRUCT    (ARG_POINTER|ARG_STRUCT)  <span class="comment">// Pointer to structure</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Bits used to define type of function.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_C           0x00000001      <span class="comment">// Does not remove arguments from stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_PASCAL      0x00000002      <span class="comment">// Removes arguments from stack on return</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_NORETURN    0x00000004      <span class="comment">// Does not return, like ExitProcess()</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_VARARG      0x00000008      <span class="comment">// Variable number of arguments</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_EAX         0x00000100      <span class="comment">// EAX on return is same as on entry</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_ECX         0x00000200      <span class="comment">// ECX on return is same as on entry</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_EDX         0x00000400      <span class="comment">// EDX on return is same as on entry</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_EBX         0x00000800      <span class="comment">// EBX on return is same as on entry</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_ESP         0x00001000      <span class="comment">// ESP on return is same as on entry</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_EBP         0x00002000      <span class="comment">// EBP on return is same as on entry</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_ESI         0x00004000      <span class="comment">// ESI on return is same as on entry</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_EDI         0x00008000      <span class="comment">// EDI on return is same as on entry</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_USES_EAX    0x00010000      <span class="comment">// EAX is used as register parameter</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_USES_ECX    0x00020000      <span class="comment">// ECX is used as register parameter</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_USES_EDX    0x00040000      <span class="comment">// EDX is used as register parameter</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_USES_EBX    0x00080000      <span class="comment">// EBX is used as register parameter</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_USES_ESP    0x00100000      <span class="comment">// ESP is used as register parameter</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_USES_EBP    0x00200000      <span class="comment">// EBP is used as register parameter</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_USES_ESI    0x00400000      <span class="comment">// ESI is used as register parameter</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_USES_EDI    0x00800000      <span class="comment">// EDI on return is same as on entry</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_FUNCTION    0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_STDFUNC     (FN_PASCAL|FN_EBX|FN_EBP|FN_ESI|FN_EDI)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FN_STDC        (FN_C|FN_EBX|FN_EBP|FN_ESI|FN_EDI)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_argdec</span> &#123;</span>              <span class="comment">// Descriptor of function argument</span></span><br><span class="line">  ulong          mode;                 <span class="comment">// Value descriptor, set of ADEC_xxx</span></span><br><span class="line">  ulong          value;                <span class="comment">// Value on the stack</span></span><br><span class="line">  ulong          pushaddr;             <span class="comment">// Address of command that pushed data</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        prtype[SHORTNAME];    <span class="comment">// Type of argument with ARG_xxx prefix</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        name[TEXTLEN];        <span class="comment">// Decoded name of argument</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        text[TEXTLEN];        <span class="comment">// Decoded value (if valid or predicted)</span></span><br><span class="line">&#125; t_argdec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_strdec</span> &#123;</span>              <span class="comment">// Decoded structure item</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Item size, bytes</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Address of the first byte</span></span><br><span class="line">  ulong          value;                <span class="comment">// Item value (only if size&lt;=4!)</span></span><br><span class="line">  uchar          valuevalid;           <span class="comment">// Whether value is valid</span></span><br><span class="line">  uchar          dec;                  <span class="comment">// One of DEC_TYPEMASK subfields</span></span><br><span class="line">  uchar          decsize;              <span class="comment">// Size of decoding element</span></span><br><span class="line">  uchar          reserved;             <span class="comment">// Reserved for the future</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        prtype[SHORTNAME];    <span class="comment">// Type of item with ARG_xxx prefix</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        name[TEXTLEN];        <span class="comment">// Name of item</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        text[TEXTLEN];        <span class="comment">// Decoded value</span></span><br><span class="line">&#125; t_strdec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_rawdata</span> &#123;</span>             <span class="comment">// Header of raw data block</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Data size, bytes</span></span><br><span class="line">  ulong          hasmask;              <span class="comment">// Data is followed by mask</span></span><br><span class="line">  ulong          features;             <span class="comment">// Data features</span></span><br><span class="line">&#125; t_rawdata;                           <span class="comment">// Data &amp; mask immediately follow header</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_argloc</span> &#123;</span>              <span class="comment">// Information about stack args &amp; locals</span></span><br><span class="line">  ulong          fntype;               <span class="comment">// Calling convention, set of FN_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            retfeatures;          <span class="comment">// Return features, set of ARG_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            retsize;              <span class="comment">// Size of returned value</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        rettype[SHORTNAME];   <span class="comment">// Type of the returned value</span></span><br><span class="line">  <span class="keyword">int</span>            argvalid;             <span class="comment">// Whether arg[] below is valid</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> &#123;</span>                             <span class="comment">// List of arguments</span></span><br><span class="line">    <span class="keyword">int</span>          features;             <span class="comment">// Argument features, set of ARG_xxx</span></span><br><span class="line">    <span class="keyword">int</span>          size;                 <span class="comment">// Size of argument on the stack</span></span><br><span class="line">    <span class="keyword">wchar_t</span>      name[TEXTLEN];        <span class="comment">// Name of the argument</span></span><br><span class="line">    <span class="keyword">wchar_t</span>      type[SHORTNAME];      <span class="comment">// Type of the argument</span></span><br><span class="line">  &#125; arg[NARG];</span><br><span class="line">&#125; t_argloc;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getconstantbyname(<span class="keyword">wchar_t</span> *name,ulong *value);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getconstantbyvalue(<span class="keyword">wchar_t</span> *groupname,</span><br><span class="line">                   ulong value,<span class="keyword">wchar_t</span> *name);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Decodetype(ulong data,<span class="keyword">wchar_t</span> *type,<span class="keyword">wchar_t</span> *text,<span class="keyword">int</span> ntext);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Fillcombowithgroup(HWND hw,<span class="keyword">wchar_t</span> *groupname,</span><br><span class="line">                   <span class="keyword">int</span> sortbyname,ulong select);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Fillcombowithstruct(HWND hw,<span class="keyword">wchar_t</span> *prefix,<span class="keyword">wchar_t</span> *select);</span><br><span class="line">stdapi (t_rawdata *) Getrawdata(<span class="keyword">wchar_t</span> *name);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Substitutehkeyprefix(<span class="keyword">wchar_t</span> *key);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Decodeknownbyname(<span class="keyword">wchar_t</span> *name,t_procdata *pd,</span><br><span class="line">                   t_argdec adec[NARG],<span class="keyword">wchar_t</span> *rettype,<span class="keyword">int</span> nexp);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Decodeknownbyaddr(ulong addr,t_procdata *pd,</span><br><span class="line">                   t_argdec adec[NARG],<span class="keyword">wchar_t</span> *rettype,<span class="keyword">wchar_t</span> *name,</span><br><span class="line">                   <span class="keyword">int</span> nexp,<span class="keyword">int</span> follow);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Isnoreturn(ulong addr);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Decodeargument(t_module *pmod,<span class="keyword">wchar_t</span> *prtype,<span class="keyword">void</span> *data,</span><br><span class="line">                   <span class="keyword">int</span> ndata,<span class="keyword">wchar_t</span> *text,<span class="keyword">int</span> ntext,<span class="keyword">int</span> *nontriv);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getstructureitemcount(<span class="keyword">wchar_t</span> *name,ulong *size);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Findstructureitembyoffset(<span class="keyword">wchar_t</span> *name,ulong offset);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Decodestructure(<span class="keyword">wchar_t</span> *name,ulong addr,<span class="keyword">int</span> item0,</span><br><span class="line">                   t_strdec *str,<span class="keyword">int</span> nstr);</span><br><span class="line">stdapi (ulong)   Getstructureitemvalue(uchar *code,ulong ncode,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *name,<span class="keyword">wchar_t</span> *itemname,<span class="keyword">void</span> *value,ulong nvalue);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////////// EXPRESSIONS, WATCHES AND INSPECTORS /////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NEXPR          16              <span class="comment">// Max. no. of expressions in EMOD_MULTI</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Mode of expression evaluation.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> EMOD_CHKEXTRA  0x00000001      <span class="comment">// Report extra characters on line</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> EMOD_NOVALUE   0x00000002      <span class="comment">// Don&#x27;t convert data to text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> EMOD_NOMEMORY  0x00000004      <span class="comment">// Don&#x27;t read debuggee&#x27;s memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> EMOD_MULTI     0x00000008      <span class="comment">// Allow multiple expressions</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> EXPR_TYPEMASK  0x0F            <span class="comment">// Mask to extract type of expression</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   EXPR_INVALID 0x00            <span class="comment">// Invalid or undefined expression</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   EXPR_BYTE    0x01            <span class="comment">// 8-bit integer byte</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   EXPR_WORD    0x02            <span class="comment">// 16-bit integer word</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   EXPR_DWORD   0x03            <span class="comment">// 32-bit integer doubleword</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   EXPR_FLOAT4  0x04            <span class="comment">// 32-bit floating-point number</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   EXPR_FLOAT8  0x05            <span class="comment">// 64-bit floating-point number</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   EXPR_FLOAT10 0x06            <span class="comment">// 80-bit floating-point number</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   EXPR_SEG     0x07            <span class="comment">// Segment</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   EXPR_ASCII   0x08            <span class="comment">// Pointer to ASCII string</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   EXPR_UNICODE 0x09            <span class="comment">// Pointer to UNICODE string</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   EXPR_TEXT    0x0A            <span class="comment">// Immediate UNICODE string</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> EXPR_REG       0x10            <span class="comment">// Origin is register</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> EXPR_SIGNED    0x20            <span class="comment">// Signed integer</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> EXPR_SIGDWORD  (EXPR_DWORD|EXPR_SIGNED)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_result</span> &#123;</span>              <span class="comment">// Result of expression&#x27;s evaluation</span></span><br><span class="line">  <span class="keyword">int</span>            lvaltype;             <span class="comment">// Type of expression, EXPR_xxx</span></span><br><span class="line">  ulong          lvaladdr;             <span class="comment">// Address of lvalue or NULL</span></span><br><span class="line">  <span class="keyword">int</span>            datatype;             <span class="comment">// Type of data, EXPR_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            repcount;             <span class="comment">// Repeat count (0..32, 0 means default)</span></span><br><span class="line">  <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">    uchar        data[<span class="number">10</span>];             <span class="comment">// Value as set of bytes</span></span><br><span class="line">    ulong        u;                    <span class="comment">// Value as address or unsigned integer</span></span><br><span class="line">    <span class="keyword">long</span>         l;                    <span class="comment">// Value as signed integer</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">double</span>  f; &#125;;                 <span class="comment">// Value as 80-bit float</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        value[TEXTLEN];       <span class="comment">// Value decoded to string</span></span><br><span class="line">&#125; t_result;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_watch</span> &#123;</span>               <span class="comment">// Watch descriptor</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// 0-based watch index</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Reserved, always 1</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Service information, TY_xxx</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        expr[TEXTLEN];        <span class="comment">// Watch expression</span></span><br><span class="line">&#125; t_watch;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">int</span>)     Cexpression(<span class="keyword">wchar_t</span> *expression,uchar *cexpr,<span class="keyword">int</span> nexpr,</span><br><span class="line">                   <span class="keyword">int</span> *explen,<span class="keyword">wchar_t</span> *err,ulong mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Exprcount(uchar *cexpr);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Eexpression(t_result *result,<span class="keyword">wchar_t</span> *expl,uchar *cexpr,</span><br><span class="line">                   <span class="keyword">int</span> index,uchar *data,ulong base,ulong size,ulong threadid,</span><br><span class="line">                   ulong a,ulong b,ulong mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Expression(t_result *result,<span class="keyword">wchar_t</span> *expression,uchar *data,</span><br><span class="line">                   ulong base,ulong size,ulong threadid,ulong a,ulong b,</span><br><span class="line">                   ulong mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Fastexpression(t_result *result,ulong addr,<span class="keyword">int</span> type,</span><br><span class="line">                   ulong threadid);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">///////////////////////////// DIALOGS AND OPTIONS //////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Mode bits in calls to dialog functions.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIA_SIZEMASK   0x0000001F      <span class="comment">// Mask to extract default data size</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_BYTE     0x00000001      <span class="comment">// Byte data size</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_WORD     0x00000002      <span class="comment">// Word data size</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_DWORD    0x00000004      <span class="comment">// Doubleword data size (default)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_QWORD    0x00000008      <span class="comment">// Quadword data size</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_TBYTE    0x0000000A      <span class="comment">// 10-byte data size</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_DQWORD   0x00000010      <span class="comment">// 16-byte data size</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIA_HEXONLY    0x00000020      <span class="comment">// Hexadecimal format only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIA_EXTENDED   0x00000040      <span class="comment">// Extended format</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIA_DATAVALID  0x00000080      <span class="comment">// Input data valid (edit mode)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIA_DEFMASK    0x00000F00      <span class="comment">// Mask to extract default data type</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_DEFHEX   0x00000100      <span class="comment">// On startup, cursor in hex control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_DEFSIG   0x00000200      <span class="comment">// On startup, cursor in signed control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_DEFUNSIG 0x00000300      <span class="comment">// On startup, cursor in unsigned control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_DEFASC   0x00000400      <span class="comment">// On startup, cursor in ASCII control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_DEFUNI   0x00000500      <span class="comment">// On startup, cursor in UNICODE control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_DEFCODE  0x00000600      <span class="comment">// Default is code breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_DEFFLOAT 0x00000700      <span class="comment">// Default selection is float</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIA_ISSEARCH   0x00001000      <span class="comment">// Is a search dialog</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIA_ASKCASE    0x00002000      <span class="comment">// Ask if case-insensitive</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIA_SEARCHDIR  0x00004000      <span class="comment">// Includes direction search buttons</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIA_HISTORY    0x00008000      <span class="comment">// Supports history</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIA_SELMASK    0x000F0000      <span class="comment">// Mask to extract selection offset</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_SEL0     0x00000000      <span class="comment">// Select least significant item</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_SEL4     0x00040000      <span class="comment">// Select item with offset 4</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_SEL8     0x00080000      <span class="comment">// Select item with offset 8</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_SEL12    0x000C0000      <span class="comment">// Select item with offset 12</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_SEL14    0x000E0000      <span class="comment">// Select item with offset 14</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIA_JMPMODE    0x00300000      <span class="comment">// Mask for jump/call/switch display</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_JMPFROM  0x00000000      <span class="comment">// Jumps/calls from specified location</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_JMPTO    0x00100000      <span class="comment">// Jumps/calls to specified location</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DIA_SWITCH   0x00200000      <span class="comment">// Switches</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIA_JMPGLOB    0x00400000      <span class="comment">// Show global jumps and calls</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIA_JMPLOC     0x00000000      <span class="comment">// Show local jumps and calls</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIA_UTF8       0x00800000      <span class="comment">// Support for UTF8</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIA_ABSXYPOS   0x10000000      <span class="comment">// Use X-Y dialog coordinates as is</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIA_RESTOREPOS 0x20000000      <span class="comment">// Restore X-Y dialog coordinates</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Types of controls that can be used in dialogs.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_END         0               <span class="comment">// End of control list with dialog size</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_COMMENT     1               <span class="comment">// Dummy entry in control list</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_TEXT        2               <span class="comment">// Simple left-aligned text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_TEXTC       4               <span class="comment">// Simple centered text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_TEXTR       5               <span class="comment">// Simple right-aligned text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_WARN        6               <span class="comment">// Multiline text, highlighted if differ</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_WTEXT       7               <span class="comment">// Text with white bg in sunken frame</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_TITLE       8               <span class="comment">// Fat centered text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_FRAME       9               <span class="comment">// Etched frame</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_SUNK        10              <span class="comment">// Sunken frame</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_GROUP       11              <span class="comment">// Group box (named frame)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_EDIT        12              <span class="comment">// Standard edit control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_NOEDIT      13              <span class="comment">// Read-only edit control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_EDITHEX     14              <span class="comment">// Standard edit control, hex uppercase</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_MULTI       15              <span class="comment">// Multiline edit control (DATALEN)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_NOMULTI     16              <span class="comment">// Multiline read-only edit (DATALEN)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BTN         17              <span class="comment">// Standard pushbutton</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_DEFBTN      18              <span class="comment">// Standard default pushbutton</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_COMBO       19              <span class="comment">// Combo box control, specified font</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_COMBOFIX    20              <span class="comment">// Combo box control, fixed width font</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_CEDIT       21              <span class="comment">// Combo edit control, specified font</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_CEDITFIX    22              <span class="comment">// Combo edit control, fixed width font</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_CESAV0      32              <span class="comment">// Combo edit 0 with autosave &amp; UNICODE</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_CESAV1      33              <span class="comment">// Combo edit 1 with autosave &amp; UNICODE</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_CESAV2      34              <span class="comment">// Combo edit 2 with autosave &amp; UNICODE</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_CESAV3      35              <span class="comment">// Combo edit 3 with autosave &amp; UNICODE</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_CESAV4      36              <span class="comment">// Combo edit 4 with autosave &amp; UNICODE</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_CESAV5      37              <span class="comment">// Combo edit 5 with autosave &amp; UNICODE</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_CESAV6      38              <span class="comment">// Combo edit 6 with autosave &amp; UNICODE</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_CESAV7      39              <span class="comment">// Combo edit 7 with autosave &amp; UNICODE</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_LIST        48              <span class="comment">// Simple list box</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_LISTFIX     49              <span class="comment">// Simple list box, fixed font</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_CHECK       62              <span class="comment">// Auto check box, left-aligned</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_CHECKR      63              <span class="comment">// Auto check box, right-aligned</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT0        64              <span class="comment">// Auto check box, bit 0</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT1        65              <span class="comment">// Auto check box, bit 1</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT2        66              <span class="comment">// Auto check box, bit 2</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT3        67              <span class="comment">// Auto check box, bit 3</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT4        68              <span class="comment">// Auto check box, bit 4</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT5        69              <span class="comment">// Auto check box, bit 5</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT6        70              <span class="comment">// Auto check box, bit 6</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT7        71              <span class="comment">// Auto check box, bit 7</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT8        72              <span class="comment">// Auto check box, bit 8</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT9        73              <span class="comment">// Auto check box, bit 9</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT10       74              <span class="comment">// Auto check box, bit 10</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT11       75              <span class="comment">// Auto check box, bit 11</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT12       76              <span class="comment">// Auto check box, bit 12</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT13       77              <span class="comment">// Auto check box, bit 13</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT14       78              <span class="comment">// Auto check box, bit 14</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT15       79              <span class="comment">// Auto check box, bit 15</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT16       80              <span class="comment">// Auto check box, bit 16</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT17       81              <span class="comment">// Auto check box, bit 17</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT18       82              <span class="comment">// Auto check box, bit 18</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT19       83              <span class="comment">// Auto check box, bit 19</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT20       84              <span class="comment">// Auto check box, bit 20</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT21       85              <span class="comment">// Auto check box, bit 21</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT22       86              <span class="comment">// Auto check box, bit 22</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT23       87              <span class="comment">// Auto check box, bit 23</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT24       88              <span class="comment">// Auto check box, bit 24</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT25       89              <span class="comment">// Auto check box, bit 25</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT26       90              <span class="comment">// Auto check box, bit 26</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT27       91              <span class="comment">// Auto check box, bit 27</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT28       92              <span class="comment">// Auto check box, bit 28</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT29       93              <span class="comment">// Auto check box, bit 29</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT30       94              <span class="comment">// Auto check box, bit 30</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BIT31       95              <span class="comment">// Auto check box, bit 31</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_RADIO0      96              <span class="comment">// Radio button, value 0</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_RADIO1      97              <span class="comment">// Radio button, value 1</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_RADIO2      98              <span class="comment">// Radio button, value 2</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_RADIO3      99              <span class="comment">// Radio button, value 3</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_RADIO4      100             <span class="comment">// Radio button, value 4</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_RADIO5      101             <span class="comment">// Radio button, value 5</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_RADIO6      102             <span class="comment">// Radio button, value 6</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_RADIO7      103             <span class="comment">// Radio button, value 7</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_RADIO8      104             <span class="comment">// Radio button, value 8</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_RADIO9      105             <span class="comment">// Radio button, value 9</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_RADIO10     106             <span class="comment">// Radio button, value 10</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_RADIO11     107             <span class="comment">// Radio button, value 11</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_RADIO12     108             <span class="comment">// Radio button, value 12</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_RADIO13     109             <span class="comment">// Radio button, value 13</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_RADIO14     110             <span class="comment">// Radio button, value 14</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_RADIO15     111             <span class="comment">// Radio button, value 15</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_CUSTOM      124             <span class="comment">// Custom control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_CUSTSF      125             <span class="comment">// Custom control with sunken frame</span></span></span><br><span class="line"><span class="comment">// Controls with special functions that work only in Options dialog.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_FILE        129             <span class="comment">// Edit file (autosave, MAXPATH chars)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BROWSE      130             <span class="comment">// Browse file name pushbutton</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_BRDIR       131             <span class="comment">// Browse directory pushbutton</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_LANGS       132             <span class="comment">// Combobox with list of languages</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_FONTS       133             <span class="comment">// Combobox with list of fonts</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_FHTOP       134             <span class="comment">// Combobox that adjusts top font height</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_FHBOT       135             <span class="comment">// Combobox that adjusts bottom font hgt</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_SCHEMES     136             <span class="comment">// Combobox with list of schemes</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_HILITE      137             <span class="comment">// Combobox with list of hilites</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CA_HILITE1     138             <span class="comment">// Combobox with nontrivial hilites</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Modes of font usage in dialog windows, if applies.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DFM_SYSTEM     0               <span class="comment">// Use system font</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DFM_PARENT     1               <span class="comment">// Use font of parent window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DFM_FIXED      2               <span class="comment">// Use dlgfontindex</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DFM_FIXALL     3               <span class="comment">// Use dlgfontindex for all controls</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HEXLEN         1024            <span class="comment">// Max length of hex edit string, bytes</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NSEARCHCMD     128             <span class="comment">// Max number of assembler search models</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_control</span> &#123;</span>             <span class="comment">// Descriptor of dialog control</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Type of control, CA_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            id;                   <span class="comment">// Control&#x27;s ID or -1 if unimportant</span></span><br><span class="line">  <span class="keyword">int</span>            x;                    <span class="comment">// X coordinate, chars/4</span></span><br><span class="line">  <span class="keyword">int</span>            y;                    <span class="comment">// Y coordinate, chars/8</span></span><br><span class="line">  <span class="keyword">int</span>            dx;                   <span class="comment">// X size, chars/4</span></span><br><span class="line">  <span class="keyword">int</span>            dy;                   <span class="comment">// Y size, chars/8</span></span><br><span class="line">  <span class="keyword">int</span>            *var;                 <span class="comment">// Pointer to control variable or NULL</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        *text;                <span class="comment">// Name or contents of the control</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        *help;                <span class="comment">// Tooltip or NULL</span></span><br><span class="line">  <span class="keyword">int</span>            oldvar;               <span class="comment">// Copy of control variable, internal</span></span><br><span class="line">&#125; t_control;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_dialog</span> &#123;</span>              <span class="comment">// Descriptor of OllyDbg dialog</span></span><br><span class="line">  t_control      *controls;            <span class="comment">// List of controls to place in dialog</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        *title;               <span class="comment">// Pointer to the dialog&#x27;s title</span></span><br><span class="line">  <span class="keyword">int</span>            focus;                <span class="comment">// ID of control with focus</span></span><br><span class="line">  <span class="keyword">int</span>            item;                 <span class="comment">// Index of processing item</span></span><br><span class="line">  ulong          u;                    <span class="comment">// Doubleword data</span></span><br><span class="line">  uchar          data[<span class="number">16</span>];             <span class="comment">// Data in other formats</span></span><br><span class="line">  ulong          addr0;                <span class="comment">// Address</span></span><br><span class="line">  ulong          addr1;                <span class="comment">// Address</span></span><br><span class="line">  <span class="keyword">int</span>            letter;               <span class="comment">// First character entered in dialog</span></span><br><span class="line">  <span class="keyword">int</span>            x;                    <span class="comment">// X reference screen coordinate</span></span><br><span class="line">  <span class="keyword">int</span>            y;                    <span class="comment">// Y reference screen coordinate</span></span><br><span class="line">  <span class="keyword">int</span>            fi;                   <span class="comment">// Index of font to use in dialog</span></span><br><span class="line">  <span class="keyword">int</span>            mode;                 <span class="comment">// Dialog operation mode, set of DIA_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            cesav[<span class="number">8</span>];             <span class="comment">// NM_xxx of CA_CESAVn</span></span><br><span class="line">  HFONT          fixfont;              <span class="comment">// Fixed font used in dialog</span></span><br><span class="line">  <span class="keyword">int</span>            isfullunicode;        <span class="comment">// Whether fixfont UNICODE</span></span><br><span class="line">  <span class="keyword">int</span>            fixdx;                <span class="comment">// Width of dialog fixed font</span></span><br><span class="line">  <span class="keyword">int</span>            fixdy;                <span class="comment">// Height of dialog fixed font</span></span><br><span class="line">  HWND           htooltip;             <span class="comment">// Handle of tooltip window</span></span><br><span class="line">  HWND           hwwarn;               <span class="comment">// Handle of WARN control, if any</span></span><br><span class="line">  <span class="keyword">int</span>            initdone;             <span class="comment">// WM_INITDIALOG finished</span></span><br><span class="line">&#125; t_dialog;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ATTENTION, size of structure t_hexstr must not exceed DATALEN!</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_hexstr</span> &#123;</span>              <span class="comment">// Data for hex/text search</span></span><br><span class="line">  ulong          n;                    <span class="comment">// Data length, bytes</span></span><br><span class="line">  ulong          nmax;                 <span class="comment">// Maximal data length, bytes</span></span><br><span class="line">  uchar          data[HEXLEN];         <span class="comment">// Data</span></span><br><span class="line">  uchar          mask[HEXLEN];         <span class="comment">// Mask, 0 bits are masked</span></span><br><span class="line">&#125; t_hexstr;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="keyword">int</span>  <span class="title">BROWSECODEFUNC</span><span class="params">(<span class="keyword">int</span>,<span class="keyword">void</span> *,ulong *,<span class="keyword">wchar_t</span> *)</span></span>;</span><br><span class="line"></span><br><span class="line">stdapi (t_control *) Findcontrol(HWND hw);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Defaultactions(HWND hparent,t_control *pctr,</span><br><span class="line">                   WPARAM wp,LPARAM lp);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Addstringtocombolist(HWND hc,<span class="keyword">wchar_t</span> *s);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Preparedialog(HWND hw,t_dialog *pdlg);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Endotdialog(HWND hw,<span class="keyword">int</span> result);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getregister(HWND hparent,<span class="keyword">int</span> reg,ulong *data,<span class="keyword">int</span> letter,</span><br><span class="line">                   <span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getinteger(HWND hparent,<span class="keyword">wchar_t</span> *title,ulong *data,<span class="keyword">int</span> letter,</span><br><span class="line">                   <span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getdword(HWND hparent,<span class="keyword">wchar_t</span> *title,ulong *data,<span class="keyword">int</span> letter,</span><br><span class="line">                   <span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getlasterrorcode(HWND hparent,<span class="keyword">wchar_t</span> *title,ulong *data,</span><br><span class="line">                   <span class="keyword">int</span> letter,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getaddressrange(HWND hparent,<span class="keyword">wchar_t</span> *title,</span><br><span class="line">                   ulong *rmin,ulong *rmax,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getexceptionrange(HWND hparent,<span class="keyword">wchar_t</span> *title,</span><br><span class="line">                   ulong *rmin,ulong *rmax,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getstructuretype(HWND hparent,<span class="keyword">wchar_t</span> *title,<span class="keyword">wchar_t</span> *text,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *strname,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getfpureg(HWND hparent,<span class="keyword">int</span> reg,<span class="keyword">void</span> *data,<span class="keyword">int</span> letter,</span><br><span class="line">                   <span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Get3dnow(HWND hparent,<span class="keyword">wchar_t</span> *title,<span class="keyword">void</span> *data,<span class="keyword">int</span> letter,</span><br><span class="line">                   <span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getfloat(HWND hparent,<span class="keyword">wchar_t</span> *title,<span class="keyword">void</span> *data,<span class="keyword">int</span> letter,</span><br><span class="line">                   <span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getmmx(HWND hparent,<span class="keyword">wchar_t</span> *title,<span class="keyword">void</span> *data,<span class="keyword">int</span> letter,</span><br><span class="line">                   <span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getsse(HWND hparent,<span class="keyword">wchar_t</span> *title,<span class="keyword">void</span> *data,<span class="keyword">int</span> letter,</span><br><span class="line">                   <span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getstring(HWND hparent,<span class="keyword">wchar_t</span> *title,<span class="keyword">wchar_t</span> *s,<span class="keyword">int</span> length,</span><br><span class="line">                   <span class="keyword">int</span> savetype,<span class="keyword">int</span> letter,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getdwordexpression(HWND hparent,<span class="keyword">wchar_t</span> *title,ulong *u,</span><br><span class="line">                   ulong threadid,<span class="keyword">int</span> savetype,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getgotoexpression(HWND hparent,<span class="keyword">wchar_t</span> *title,ulong *u,</span><br><span class="line">                   ulong threadid,<span class="keyword">int</span> savetype,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Asmindump(HWND hparent,<span class="keyword">wchar_t</span> *title,struct t_dump *pd,</span><br><span class="line">                   <span class="keyword">int</span> letter,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getasmsearchmodel(HWND hparent,<span class="keyword">wchar_t</span> *title,t_asmmod *model,</span><br><span class="line">                   <span class="keyword">int</span> nmodel,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getseqsearchmodel(HWND hparent,<span class="keyword">wchar_t</span> *title,t_asmmod *model,</span><br><span class="line">                   <span class="keyword">int</span> nmodel,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Binaryedit(HWND hparent,<span class="keyword">wchar_t</span> *title,t_hexstr *hstr,</span><br><span class="line">                   <span class="keyword">int</span> letter,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getpredefinedtypebyindex(<span class="keyword">int</span> fnindex,<span class="keyword">wchar_t</span> *type);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getindexbypredefinedtype(<span class="keyword">wchar_t</span> *type);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Condbreakpoint(HWND hparent,ulong *addr,<span class="keyword">int</span> naddr,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *title,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Condlogbreakpoint(HWND hparent,ulong *addr,<span class="keyword">int</span> naddr,</span><br><span class="line">                   <span class="keyword">int</span> fnindex,<span class="keyword">wchar_t</span> *title,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Membreakpoint(HWND hparent,ulong addr,ulong size,</span><br><span class="line">                   <span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Memlogbreakpoint(HWND hparent,ulong addr,ulong size,</span><br><span class="line">                   <span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Hardbreakpoint(HWND hparent,ulong addr,</span><br><span class="line">                   <span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Hardlogbreakpoint(HWND hparent,ulong addr,<span class="keyword">int</span> fnindex,</span><br><span class="line">                   <span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Setrtcond(HWND hparent,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Setrtprot(HWND hparent,<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> fi);</span><br><span class="line">stdapi (ulong)   Browsecodelocations(HWND hparent,<span class="keyword">wchar_t</span> *title,</span><br><span class="line">                   BROWSECODEFUNC *bccallback,<span class="keyword">void</span> *data);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Fillcombowithcodepages(HWND hw,<span class="keyword">int</span> select);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//////////////////////////////// PLUGIN OPTIONS ////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_TITLE      9001            <span class="comment">// Pane title</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_1          9011            <span class="comment">// First automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_2          9012            <span class="comment">// Second automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_3          9013            <span class="comment">// Third automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_4          9014            <span class="comment">// Fourth automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_5          9015            <span class="comment">// Fifth automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_6          9016            <span class="comment">// Sixth automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_7          9017            <span class="comment">// Seventh automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_8          9018            <span class="comment">// Eighth automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_9          9019            <span class="comment">// Ninth automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_10         9020            <span class="comment">// Tenth automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_11         9021            <span class="comment">// Eleventh automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_12         9022            <span class="comment">// Twelfth automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_13         9023            <span class="comment">// Thirteen automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_14         9024            <span class="comment">// Fourteen automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_15         9025            <span class="comment">// Fifteen automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_16         9026            <span class="comment">// Sixteen automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_17         9027            <span class="comment">// Seventeen automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_18         9028            <span class="comment">// Eighteen automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_19         9029            <span class="comment">// Nineteen automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_20         9030            <span class="comment">// Twentieth automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_21         9031            <span class="comment">// Twenty-first automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_22         9032            <span class="comment">// Twenty-second automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_23         9033            <span class="comment">// Twenty-third automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_24         9034            <span class="comment">// Twenty-fourth automatical control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_W1         9101            <span class="comment">// First automatical autowarn control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_W2         9102            <span class="comment">// Second automatical autowarn control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_W3         9103            <span class="comment">// Third automatical autowarn control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_W4         9104            <span class="comment">// Fourth automatical autowarn control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_W5         9105            <span class="comment">// Fifth automatical autowarn control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_W6         9106            <span class="comment">// Sixth automatical autowarn control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_W7         9107            <span class="comment">// Seventh automatical autowarn control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_W8         9108            <span class="comment">// Eighth automatical autowarn control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_W9         9109            <span class="comment">// Ninth automatical autowarn control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_W10        9110            <span class="comment">// Tenth automatical autowarn control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_W11        9111            <span class="comment">// Eleventh automatical autowarn control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_W12        9112            <span class="comment">// Twelfth automatical autowarn control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_S1         9121            <span class="comment">// First autowarn-if-turned-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_S2         9122            <span class="comment">// Second autowarn-if-turned-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_S3         9123            <span class="comment">// Third autowarn-if-turned-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_S4         9124            <span class="comment">// Fourth autowarn-if-turned-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_S5         9125            <span class="comment">// Fifth autowarn-if-turned-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_S6         9126            <span class="comment">// Sixth autowarn-if-turned-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_S7         9127            <span class="comment">// Seventh autowarn-if-turned-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_S8         9128            <span class="comment">// Eighth autowarn-if-turned-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_S9         9129            <span class="comment">// Ninth autowarn-if-turned-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_S10        9130            <span class="comment">// Tenth autowarn-if-turned-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_S11        9131            <span class="comment">// Eleventh autowarn-if-turned-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_S12        9132            <span class="comment">// Twelfth autowarn-if-turned-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_X1         9141            <span class="comment">// First autowarn-if-all-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_X2         9142            <span class="comment">// Second autowarn-if-all-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_X3         9143            <span class="comment">// Third autowarn-if-all-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_X4         9144            <span class="comment">// Fourth autowarn-if-all-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_X5         9145            <span class="comment">// Fifth autowarn-if-all-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_X6         9146            <span class="comment">// Sixth autowarn-if-all-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_X7         9147            <span class="comment">// Seventh autowarn-if-all-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_X8         9148            <span class="comment">// Eighth autowarn-if-all-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_X9         9149            <span class="comment">// Ninth autowarn-if-all-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_X10        9150            <span class="comment">// Tenth autowarn-if-all-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_X11        9151            <span class="comment">// Eleventh autowarn-if-all-on control</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_X12        9152            <span class="comment">// Twelfth autowarn-if-all-on control</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_CUSTMIN    9500            <span class="comment">// Custom controls by plugins</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OPT_CUSTMAX    9999            <span class="comment">// End of custom area</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">/////////////////////////////////// COMMENTS ///////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Comments types used by Commentaddress().</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> COMM_USER      0x00000001      <span class="comment">// Add user-defined comment</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> COMM_MARK      0x00000002      <span class="comment">// Add important arguments</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> COMM_PROC      0x00000004      <span class="comment">// Add procedure description</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> COMM_ALL       0xFFFFFFFF      <span class="comment">// Add all possible comments</span></span></span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">int</span>)     Stringtotext(<span class="keyword">wchar_t</span> *data,<span class="keyword">int</span> ndata,<span class="keyword">wchar_t</span> *text,<span class="keyword">int</span> ntext,</span><br><span class="line">                   <span class="keyword">int</span> stopatzero);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Isstring(ulong addr,<span class="keyword">int</span> isstatic,<span class="keyword">wchar_t</span> *symb,<span class="keyword">int</span> nsymb);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Squeezename(<span class="keyword">wchar_t</span> *dest,<span class="keyword">int</span> ndest,<span class="keyword">wchar_t</span> *src,<span class="keyword">int</span> nsrc);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Uncapitalize(<span class="keyword">wchar_t</span> *s);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Decoderelativeoffset(ulong addr,<span class="keyword">int</span> addrmode,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *symb,<span class="keyword">int</span> nsymb);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Decodeaddress(ulong addr,ulong amod,<span class="keyword">int</span> mode,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *symb,<span class="keyword">int</span> nsymb,<span class="keyword">wchar_t</span> *comment);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Decodearglocal(ulong ip,ulong offs,ulong datasize,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *name,<span class="keyword">int</span> len);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getanalysercomment(struct t_module *pmod,ulong addr,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *comment,<span class="keyword">int</span> len);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getswitchcomment(ulong addr,<span class="keyword">wchar_t</span> *comment,<span class="keyword">int</span> len);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getloopcomment(struct t_module *pmod,ulong addr,<span class="keyword">int</span> level,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *comment,<span class="keyword">int</span> len);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getproccomment(ulong addr,ulong acall,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *comment,<span class="keyword">int</span> len,<span class="keyword">int</span> argonly);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Commentaddress(ulong addr,<span class="keyword">int</span> typelist,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *comment,<span class="keyword">int</span> len);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////////////////////// LOG WINDOW //////////////////////////////////</span></span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">void</span>)    Redrawlist(<span class="keyword">void</span>);</span><br><span class="line">varapi (<span class="keyword">void</span>)    Addtolist(ulong addr,<span class="keyword">int</span> color,<span class="keyword">wchar_t</span> *format,...);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">///////////////////////////////////// DUMP /////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DU_STACK       0x80000000      <span class="comment">// Used for internal purposes</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DU_NOSMALL     0x40000000      <span class="comment">// Used for internal purposes</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DU_MODEMASK    0x3C000000      <span class="comment">// Mask for mode bits</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_SMALL     0x20000000      <span class="comment">// Small-size dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_FIXADDR   0x10000000      <span class="comment">// Fix first visible address</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_BACKUP    0x08000000      <span class="comment">// Display backup instead of actual data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_USEDEC    0x04000000      <span class="comment">// Show contents using decoding data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DU_COMMMASK    0x03000000      <span class="comment">// Mask for disassembly comments</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_COMMENT   0x00000000      <span class="comment">// Show comments</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_SOURCE    0x01000000      <span class="comment">// Show source</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DU_DISCARD     0x00800000      <span class="comment">// Discardable by Esc</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DU_PROFILE     0x00400000      <span class="comment">// Show profile</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DU_TYPEMASK    0x003F0000      <span class="comment">// Mask for dump type</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_HEXTEXT   0x00010000      <span class="comment">// Hexadecimal dump with ASCII text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_HEXUNI    0x00020000      <span class="comment">// Hexadecimal dump with UNICODE text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_TEXT      0x00030000      <span class="comment">// Character dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_UNICODE   0x00040000      <span class="comment">// Unicode dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_INT       0x00050000      <span class="comment">// Integer signed dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_UINT      0x00060000      <span class="comment">// Integer unsigned dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_IHEX      0x00070000      <span class="comment">// Integer hexadecimal dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_FLOAT     0x00080000      <span class="comment">// Floating-point dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_ADDR      0x00090000      <span class="comment">// Address dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_ADRASC    0x000A0000      <span class="comment">// Address dump with ASCII text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_ADRUNI    0x000B0000      <span class="comment">// Address dump with UNICODE text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_DISASM    0x000C0000      <span class="comment">// Disassembly</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DU_DECODE    0x000D0000      <span class="comment">// Same as DU_DISASM but for decoded data</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DU_COUNTMASK   0x0000FF00      <span class="comment">// Mask for number of items/line</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DU_SIZEMASK    0x000000FF      <span class="comment">// Mask for size of single item</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DU_MAINPART    (DU_TYPEMASK|DU_COUNTMASK|DU_SIZEMASK)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_HEXA8     0x00010801      <span class="comment">// Hex/ASCII dump, 8 bytes per line</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_HEXA16    0x00011001      <span class="comment">// Hex/ASCII dump, 16 bytes per line</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_HEXU8     0x00020801      <span class="comment">// Hex/UNICODE dump, 8 bytes per line</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_HEXU16    0x00021001      <span class="comment">// Hex/UNICODE dump, 16 bytes per line</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_ASC32     0x00032001      <span class="comment">// ASCII dump, 32 characters per line</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_ASC64     0x00034001      <span class="comment">// ASCII dump, 64 characters per line</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_UNI16     0x00041002      <span class="comment">// UNICODE dump, 16 characters per line</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_UNI32     0x00042002      <span class="comment">// UNICODE dump, 32 characters per line</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_UNI64     0x00044002      <span class="comment">// UNICODE dump, 64 characters per line</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_INT16     0x00050802      <span class="comment">// 16-bit signed integer dump, 8 items</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_INT16S    0x00050402      <span class="comment">// 16-bit signed integer dump, 4 items</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_INT32     0x00050404      <span class="comment">// 32-bit signed integer dump, 4 items</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_INT32S    0x00050204      <span class="comment">// 32-bit signed integer dump, 2 items</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_UINT16    0x00060802      <span class="comment">// 16-bit unsigned integer dump, 8 items</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_UINT16S   0x00060402      <span class="comment">// 16-bit unsigned integer dump, 4 items</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_UINT32    0x00060404      <span class="comment">// 32-bit unsigned integer dump, 4 items</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_UINT32S   0x00060204      <span class="comment">// 32-bit unsigned integer dump, 2 items</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_IHEX16    0x00070802      <span class="comment">// 16-bit hex integer dump, 8 items</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_IHEX16S   0x00070402      <span class="comment">// 16-bit hex integer dump, 4 items</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_IHEX32    0x00070404      <span class="comment">// 32-bit hex integer dump, 4 items</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_IHEX32S   0x00070204      <span class="comment">// 32-bit hex integer dump, 2 items</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_FLOAT32   0x00080404      <span class="comment">// 32-bit floats, 4 items</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_FLOAT32S  0x00080104      <span class="comment">// 32-bit floats, 1 item</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_FLOAT64   0x00080208      <span class="comment">// 64-bit floats, 2 items</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_FLOAT64S  0x00080108      <span class="comment">// 64-bit floats, 1 item</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_FLOAT80   0x0008010A      <span class="comment">// 80-bit floats</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_ADDR      0x00090104      <span class="comment">// Address dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_ADDRASC   0x000A0104      <span class="comment">// Address dump with ASCII text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_ADDRUNI   0x000B0104      <span class="comment">// Address dump with UNICODE text</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_DISASM    0x000C0110      <span class="comment">// Disassembly (max. 16 bytes per cmd)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DUMP_DECODE    0x000D0110      <span class="comment">// Decoded data (max. 16 bytes per line)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Types of dump menu in t_dump.menutype.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DMT_FIXTYPE    0x00000001      <span class="comment">// Fixed dump type, no change</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DMT_STRUCT     0x00000002      <span class="comment">// Dump of the structure</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DMT_CPUMASK    0x00070000      <span class="comment">// Dump belongs to CPU window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DMT_CPUDASM  0x00010000      <span class="comment">// This is CPU Disassembler pane</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DMT_CPUDUMP  0x00020000      <span class="comment">// This is CPU Dump pane</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DMT_CPUSTACK 0x00040000      <span class="comment">// This is CPU Stack pane</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Modes of Scrolldumpwindow().</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SD_REALIGN     0x01            <span class="comment">// Realign on specified address</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SD_CENTERY     0x02            <span class="comment">// Center destination vertically</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Modes of t_dump.dumpselfunc() and Reportdumpselection().</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCH_SEL0       0x01            <span class="comment">// t_dump.sel0 changed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SCH_SEL1       0x02            <span class="comment">// t_dump.sel1 changed</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Modes of Copydumpselection().</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CDS_TITLES     0x00000001      <span class="comment">// Prepend window name and column titles</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CDS_NOGRAPH    0x00000002      <span class="comment">// Replace graphical symbols by spaces</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="keyword">void</span> <span class="title">DUMPSELFUNC</span><span class="params">(struct t_dump *,<span class="keyword">int</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_dump</span> &#123;</span>                <span class="comment">// Descriptor of dump data and window</span></span><br><span class="line">  ulong          base;                 <span class="comment">// Start of memory block or file</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Size of memory block or file</span></span><br><span class="line">  ulong          dumptype;             <span class="comment">// Dump type, DU_xxx+count+size=DUMP_xxx</span></span><br><span class="line">  ulong          menutype;             <span class="comment">// Menu type, set of DMT_xxx</span></span><br><span class="line">  ulong          itemwidth;            <span class="comment">// Width of one item, characters</span></span><br><span class="line">  ulong          threadid;             <span class="comment">// Use decoding and registers if not 0</span></span><br><span class="line">  t_table        table;                <span class="comment">// Dump window is a custom table</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Address of first visible byte</span></span><br><span class="line">  ulong          sel0;                 <span class="comment">// Address of first selected byte</span></span><br><span class="line">  ulong          sel1;                 <span class="comment">// Last selected byte (not included!)</span></span><br><span class="line">  ulong          selstart;             <span class="comment">// Addr of first byte of selection start</span></span><br><span class="line">  ulong          selend;               <span class="comment">// Addr of first byte of selection end</span></span><br><span class="line">  uchar          *filecopy;            <span class="comment">// Copy of the file or NULL</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        path[MAXPATH];        <span class="comment">// Name of displayed file</span></span><br><span class="line">  uchar          *backup;              <span class="comment">// Old backup of memory/file or NULL</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        strname[SHORTNAME];   <span class="comment">// Name of the structure to decode</span></span><br><span class="line">  uchar          *decode;              <span class="comment">// Local decoding information or NULL</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        bkpath[MAXPATH];      <span class="comment">// Name of last used backup file</span></span><br><span class="line">  <span class="keyword">int</span>            relreg;               <span class="comment">// Addresses relative to register</span></span><br><span class="line">  ulong          reladdr;              <span class="comment">// Addresses relative to this address</span></span><br><span class="line">  ulong          hilitereg;            <span class="comment">// One of OP_SOMEREG if reg highlighting</span></span><br><span class="line">  <span class="keyword">int</span>            hiregindex;           <span class="comment">// Index of register to highlight</span></span><br><span class="line">  ulong          graylimit;            <span class="comment">// Gray data below this address</span></span><br><span class="line">  DUMPSELFUNC    *dumpselfunc;         <span class="comment">// Callback indicating change of sel0</span></span><br><span class="line">&#125; t_dump;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">void</span>)    Setdumptype(t_dump *pd,ulong dumptype);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Ensurememorybackup(t_memory *pmem,<span class="keyword">int</span> makebackup);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Backupusercode(struct t_module *pm,<span class="keyword">int</span> force);</span><br><span class="line">stdapi (HGLOBAL) Copydumpselection(t_dump *pd,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (ulong)   Dumpback(t_dump *pd,ulong addr,<span class="keyword">int</span> n);</span><br><span class="line">stdapi (ulong)   Dumpforward(t_dump *pd,ulong addr,<span class="keyword">int</span> n);</span><br><span class="line">stdapi (ulong)   Scrolldumpwindow(t_dump *pd,ulong addr,<span class="keyword">int</span> mode);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Alignselection(t_dump *pd,ulong *sel0,ulong *sel1);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getproclimits(ulong addr,ulong *amin,ulong *amax);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getextproclimits(ulong addr,ulong *amin,ulong *amax);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Newdumpselection(t_dump *pd,ulong addr,ulong size);</span><br><span class="line">stdapi (t_dump *) Findfiledump(<span class="keyword">wchar_t</span> *path);</span><br><span class="line">stdapi (HWND)    Createdumpwindow(<span class="keyword">wchar_t</span> *title,ulong base,ulong size,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *path,ulong dumptype,ulong sel0,ulong sel1,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *strname);</span><br><span class="line">stdapi (HWND)    Embeddumpwindow(HWND hw,t_dump *pd,ulong dumptype);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//////////////////////////////////// SEARCH ////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Layouts of search panel.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SL_UNDEF       0               <span class="comment">// Undefined layout</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SL_DISASM      1               <span class="comment">// Commands or refs within one module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SL_SEQASM      2               <span class="comment">// Sequences within one module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SL_STRINGS     3               <span class="comment">// Referenced strings within one module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SL_GUIDS       4               <span class="comment">// Referenced GUIDs within one module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SL_COMMENTS    5               <span class="comment">// All user-defined comments</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SL_SWITCHES    6               <span class="comment">// Switches and cascaded IFs</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SL_FLOATS      7               <span class="comment">// Referenced floats within one module</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SL_CALLS       8               <span class="comment">// Intermodular calls</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SL_MOD         9               <span class="comment">// Modifications</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Search types.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEARCH_NONE    0               <span class="comment">// Type is not yet defined</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEARCH_CMD     1               <span class="comment">// Search for assembler commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEARCH_SEQ     2               <span class="comment">// Search for the sequence of commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEARCH_BINARY  3               <span class="comment">// Search for binary code</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEARCH_CONST   4               <span class="comment">// Search for referenced constant range</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SEARCH_MOD     5               <span class="comment">// Search for modifications</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Search directions.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SDIR_GLOBAL    0               <span class="comment">// Search forward from the beginning</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SDIR_FORWARD   1               <span class="comment">// Search forward from selection</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SDIR_BACKWARD  2               <span class="comment">// Search backward from selection</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Search modes.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SRCH_NEW       0               <span class="comment">// Ask for new search pattern</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SRCH_NEWMEM    1               <span class="comment">// Ask for new pattern, memory mode</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SRCH_SAMEDIR   2               <span class="comment">// Search in the specified direction</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SRCH_OPPDIR    3               <span class="comment">// Search in the opposite direction</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SRCH_MEM       4               <span class="comment">// Search forward, memory mode</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Mode bits in Comparesequence().</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CSEQ_IGNORECMD 0x00000001      <span class="comment">// Ignore non-influencing commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CSEQ_ALLOWJMP  0x00000002      <span class="comment">// Allow jumps from outside</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_found</span> &#123;</span>               <span class="comment">// Search result</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Address of found item</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Size of found item, or 0 on error</span></span><br><span class="line">&#125; t_found;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_search</span> &#123;</span>              <span class="comment">// Descriptor of found item</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Address of found item</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Must be 1</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Type of found item, TY_xxx+SE_xxx</span></span><br><span class="line">  ulong          data;                 <span class="comment">// Mode-related data</span></span><br><span class="line">  ulong          seqlen;               <span class="comment">// Length of command sequence</span></span><br><span class="line">&#125; t_search;</span><br><span class="line"></span><br><span class="line">stdapi (ulong)   Comparecommand(uchar *cmd,ulong cmdsize,ulong cmdip,</span><br><span class="line">                   t_asmmod *model,<span class="keyword">int</span> nmodel,<span class="keyword">int</span> *pa,<span class="keyword">int</span> *pb,t_disasm *da);</span><br><span class="line">stdapi (ulong)   Comparesequence(uchar *cmd,ulong cmdsize,ulong cmdip,</span><br><span class="line">                   uchar *decode,t_asmmod *model,<span class="keyword">int</span> nmodel,<span class="keyword">int</span> mode,</span><br><span class="line">                   <span class="keyword">int</span> *pa,<span class="keyword">int</span> *pb,t_disasm *da,ulong *amatch,<span class="keyword">int</span> namatch);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">/////////////////////////////////// PATCHES ////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PATCHSIZE      512             <span class="comment">// Maximal patch size, bytes</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_patch</span> &#123;</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Base address of patch in memory</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Size of patch, bytes</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Type of patch, set of TY_xxx</span></span><br><span class="line">  uchar          orig[PATCHSIZE];      <span class="comment">// Original code</span></span><br><span class="line">  uchar          mod[PATCHSIZE];       <span class="comment">// Patched code</span></span><br><span class="line">&#125; t_patch;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">///////////////////////////////// BREAKPOINTS //////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Actions that must be performed if breakpoint of type BP_ONESHOT or BP_TEMP</span></span><br><span class="line"><span class="comment">// is hit.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BA_PERMANENT   0x00000001      <span class="comment">// Permanent INT3 BP_TEMP on system call</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BA_PLUGIN      0x80000000      <span class="comment">// Pass notification to plugin</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_bpoint</span> &#123;</span>              <span class="comment">// INT3 breakpoints</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Address of breakpoint</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Must be 1</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Type of breakpoint, TY_xxx+BP_xxx</span></span><br><span class="line">  ushort         fnindex;              <span class="comment">// Index of predefined function</span></span><br><span class="line">  uchar          cmd;                  <span class="comment">// First byte of original command</span></span><br><span class="line">  uchar          patch;                <span class="comment">// Used only in .udd files</span></span><br><span class="line">  ulong          limit;                <span class="comment">// Original pass count (0 if not set)</span></span><br><span class="line">  ulong          count;                <span class="comment">// Actual pass count</span></span><br><span class="line">  ulong          actions;              <span class="comment">// Actions, set of BA_xxx</span></span><br><span class="line">&#125; t_bpoint;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_bpmem</span> &#123;</span>               <span class="comment">// Memory breakpoints</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Address of breakpoint</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Size of the breakpoint, bytes</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Type of breakpoint, TY_xxx+BP_xxx</span></span><br><span class="line">  ulong          limit;                <span class="comment">// Original pass count (0 if not set)</span></span><br><span class="line">  ulong          count;                <span class="comment">// Actual pass count</span></span><br><span class="line">&#125; t_bpmem;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_bppage</span> &#123;</span>              <span class="comment">// Pages with modified attributes</span></span><br><span class="line">  ulong          base;                 <span class="comment">// Base address of memory page</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Always PAGESIZE</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Set of TY_xxx+BP_ACCESSMASK</span></span><br><span class="line">  ulong          oldaccess;            <span class="comment">// Initial access</span></span><br><span class="line">  ulong          newaccess;            <span class="comment">// Modified (actual) access</span></span><br><span class="line">&#125; t_bppage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_bphard</span> &#123;</span>              <span class="comment">// Hardware breakpoints</span></span><br><span class="line">  ulong          index;                <span class="comment">// Index of the breakpoint (0..NHARD-1)</span></span><br><span class="line">  ulong          dummy;                <span class="comment">// Must be 1</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Type of the breakpoint, TY_xxx+BP_xxx</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Address of breakpoint</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Size of the breakpoint, bytes</span></span><br><span class="line">  <span class="keyword">int</span>            fnindex;              <span class="comment">// Index of predefined function</span></span><br><span class="line">  ulong          limit;                <span class="comment">// Original pass count (0 if not set)</span></span><br><span class="line">  ulong          count;                <span class="comment">// Actual pass count</span></span><br><span class="line">  ulong          actions;              <span class="comment">// Actions, set of BA_xxx</span></span><br><span class="line">  ulong          modbase;              <span class="comment">// Module base, used by .udd only</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        path[MAXPATH];        <span class="comment">// Full module name, used by .udd only</span></span><br><span class="line">&#125; t_bphard;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">int</span>)     Removeint3breakpoint(ulong addr,ulong type);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Setint3breakpoint(ulong addr,ulong type,<span class="keyword">int</span> fnindex,</span><br><span class="line">                   <span class="keyword">int</span> limit,<span class="keyword">int</span> count,ulong actions,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *condition,<span class="keyword">wchar_t</span> *expression,<span class="keyword">wchar_t</span> *exprtype);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Enableint3breakpoint(ulong addr,<span class="keyword">int</span> enable);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Confirmint3breakpoint(ulong addr);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Confirmhardwarebreakpoint(ulong addr);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Confirmint3breakpointlist(ulong *addr,<span class="keyword">int</span> naddr);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Wipebreakpointrange(ulong addr0,ulong addr1);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Removemembreakpoint(ulong addr);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Setmembreakpoint(ulong addr,ulong size,ulong type,</span><br><span class="line">                   <span class="keyword">int</span> limit,<span class="keyword">int</span> count,<span class="keyword">wchar_t</span> *condition,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *expression,<span class="keyword">wchar_t</span> *exprtype);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Enablemembreakpoint(ulong addr,<span class="keyword">int</span> enable);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Removehardbreakpoint(<span class="keyword">int</span> index);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Sethardbreakpoint(<span class="keyword">int</span> index,ulong size,ulong type,<span class="keyword">int</span> fnindex,</span><br><span class="line">                   ulong addr,<span class="keyword">int</span> limit,<span class="keyword">int</span> count,ulong actions,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *condition,<span class="keyword">wchar_t</span> *expression,<span class="keyword">wchar_t</span> *exprtype);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Enablehardbreakpoint(<span class="keyword">int</span> index,<span class="keyword">int</span> enable);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Findfreehardbreakslot(ulong type);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">///////////////////////////////////// CPU //////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Mode bits for Setcpu().</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CPU_ASMHIST    0x00000001      <span class="comment">// Add change to Disassembler history</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CPU_ASMCENTER  0x00000004      <span class="comment">// Make address in the middle of window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CPU_ASMFOCUS   0x00000008      <span class="comment">// Move focus to Disassembler</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CPU_DUMPHIST   0x00000010      <span class="comment">// Add change to Dump history</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CPU_DUMPFIRST  0x00000020      <span class="comment">// Make address the first byte in Dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CPU_DUMPFOCUS  0x00000080      <span class="comment">// Move focus to Dump</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CPU_STACKFOCUS 0x00000100      <span class="comment">// Move focus to Stack</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CPU_STACKCTR   0x00000200      <span class="comment">// Center stack instead moving to top</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CPU_REGAUTO    0x00001000      <span class="comment">// Automatically switch to FPU/MMX/3DNow!</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CPU_NOCREATE   0x00002000      <span class="comment">// Don&#x27;t create CPU window if absent</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CPU_REDRAW     0x00004000      <span class="comment">// Redraw CPU window immediately</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CPU_NOFOCUS    0x00008000      <span class="comment">// Don&#x27;t assign focus to main window</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CPU_RUNTRACE   0x00010000      <span class="comment">// asmaddr is run trace backstep</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CPU_NOTRACE    0x00020000      <span class="comment">// Stop run trace display</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Options for autoregtype.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ASR_OFF        0               <span class="comment">// No FPU/MMX/3DNow! autoselection</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ASR_EVENT      1               <span class="comment">// Autoselection on debug events</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ASR_ALWAYS     2               <span class="comment">// Autoselection when command selected</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NHISTORY       1024            <span class="comment">// Length of history buffer, records</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_histrec</span> &#123;</span>             <span class="comment">// Walk history record</span></span><br><span class="line">  ulong          threadid;             <span class="comment">// Thread ID, ignored by Dump pane</span></span><br><span class="line">  ulong          dumptype;             <span class="comment">// Dump type, ignored by Disasm pane</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Address of first visible line</span></span><br><span class="line">  ulong          sel0;                 <span class="comment">// Begin of selection</span></span><br><span class="line">  ulong          sel1;                 <span class="comment">// End of selection (not included)</span></span><br><span class="line">&#125; t_histrec;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Note that hnext points to the free record following the last written, and</span></span><br><span class="line"><span class="comment">// hcurr points record that follows currently selected one.</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_history</span> &#123;</span>             <span class="comment">// Walk history data</span></span><br><span class="line">  t_histrec      h[NHISTORY];          <span class="comment">// Circular buffer with history records</span></span><br><span class="line">  <span class="keyword">int</span>            holdest;              <span class="comment">// Index of oldest valid record in h</span></span><br><span class="line">  <span class="keyword">int</span>            hnext;                <span class="comment">// Index of first free record in h</span></span><br><span class="line">  <span class="keyword">int</span>            hcurr;                <span class="comment">// Index of record following actual in h</span></span><br><span class="line">&#125; t_history;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">void</span>)    Redrawcpudisasm(<span class="keyword">void</span>);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Redrawcpureg(<span class="keyword">void</span>);</span><br><span class="line">stdapi (ulong)   Getcputhreadid(<span class="keyword">void</span>);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getcpuruntracebackstep(<span class="keyword">void</span>);</span><br><span class="line">stdapi (t_dump *) Getcpudisasmdump(<span class="keyword">void</span>);</span><br><span class="line">stdapi (ulong)   Getcpudisasmselection(<span class="keyword">void</span>);</span><br><span class="line">stdapi (t_table *) Getcpudisasmtable(<span class="keyword">void</span>);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Addtohistory(t_history *ph,ulong threadid,ulong dumptype,</span><br><span class="line">                   ulong addr,ulong sel0,ulong sel1);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Walkhistory(t_history *ph,<span class="keyword">int</span> dir,ulong *threadid,</span><br><span class="line">                   ulong *dumptype,ulong *addr,ulong *sel0,ulong *sel1);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Checkhistory(t_history *ph,<span class="keyword">int</span> dir,<span class="keyword">int</span> *isnewest);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Setcpu(ulong threadid,ulong asmaddr,ulong dumpaddr,</span><br><span class="line">                   ulong selsize,ulong stackaddr,<span class="keyword">int</span> mode);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">/////////////////////// DEBUGGING AND TRACING FUNCTIONS ////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NIGNORE        32              <span class="comment">// Max. no. of ignored exception ranges</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NRTPROT        64              <span class="comment">// No. of protocolled address ranges</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FP_SYSBP       0               <span class="comment">// First pause on system breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FP_TLS         1               <span class="comment">// First pause on TLS callback, if any</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FP_ENTRY       2               <span class="comment">// First pause on program entry point</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FP_WINMAIN     3               <span class="comment">// First pause on WinMain, if known</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FP_NONE        4               <span class="comment">// Run program immediately</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AP_SYSBP       0               <span class="comment">// Attach pause on system breakpoint</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AP_CODE        1               <span class="comment">// Attach pause on program code</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AP_NONE        2               <span class="comment">// Run attached program immediately</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DP_LOADDLL     0               <span class="comment">// Loaddll pause on Loaddll entry point</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DP_ENTRY       1               <span class="comment">// Loaddll pause on DllEntryPoint()</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DP_LOADED      2               <span class="comment">// Loaddll pause after LoadLibrary()</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DP_NONE        3               <span class="comment">// Run Loaddll immediately</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DR6_SET        0xFFFF0FF0      <span class="comment">// DR6 bits specified as always 1</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DR6_TRAP       0x00004000      <span class="comment">// Single-step trap</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DR6_BD         0x00002000      <span class="comment">// Debug register access detected</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DR6_BHIT       0x0000000F      <span class="comment">// Some hardware breakpoint hit</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DR6_B3       0x00000008      <span class="comment">// Hardware breakpoint 3 hit</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DR6_B2       0x00000004      <span class="comment">// Hardware breakpoint 2 hit</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DR6_B1       0x00000002      <span class="comment">// Hardware breakpoint 1 hit</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span>   DR6_B0       0x00000001      <span class="comment">// Hardware breakpoint 0 hit</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DR7_GD         0x00002000      <span class="comment">// Enable debug register protection</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DR7_SET        0x00000400      <span class="comment">// DR7 bits specified as always 1</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DR7_EXACT      0x00000100      <span class="comment">// Local exact instruction detection</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DR7_G3         0x00000080      <span class="comment">// Enable breakpoint 3 globally</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DR7_L3         0x00000040      <span class="comment">// Enable breakpoint 3 locally</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DR7_G2         0x00000020      <span class="comment">// Enable breakpoint 2 globally</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DR7_L2         0x00000010      <span class="comment">// Enable breakpoint 2 locally</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DR7_G1         0x00000008      <span class="comment">// Enable breakpoint 1 globally</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DR7_L1         0x00000004      <span class="comment">// Enable breakpoint 1 locally</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DR7_G0         0x00000002      <span class="comment">// Enable breakpoint 0 globally</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DR7_L0         0x00000001      <span class="comment">// Enable breakpoint 0 locally</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DR7_IMPORTANT  (DR7_G3|DR7_L3|DR7_G2|DR7_L2|DR7_G1|DR7_L1|DR7_G0|DR7_L0)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NCOND          4               <span class="comment">// Number of run trace conditions</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NRANGE         2               <span class="comment">// Number of memory ranges</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NCMD           2               <span class="comment">// Number of commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NMODLIST       24              <span class="comment">// Number of modules in pause list</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Run trace condition bits.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RTC_COND1      0x00000001      <span class="comment">// Stop run trace if condition 1 is met</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RTC_COND2      0x00000002      <span class="comment">// Stop run trace if condition 2 is met</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RTC_COND3      0x00000004      <span class="comment">// Stop run trace if condition 3 is met</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RTC_COND4      0x00000008      <span class="comment">// Stop run trace if condition 4 is met</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RTC_CMD1       0x00000010      <span class="comment">// Stop run trace if command 1 matches</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RTC_CMD2       0x00000020      <span class="comment">// Stop run trace if command 2 matches</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RTC_INRANGE    0x00000100      <span class="comment">// Stop run trace if in range</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RTC_OUTRANGE   0x00000200      <span class="comment">// Stop run trace if out of range</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RTC_COUNT      0x00000400      <span class="comment">// Stop run trace if count is reached</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RTC_MEM1       0x00001000      <span class="comment">// Access to memory range 1</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RTC_MEM2       0x00002000      <span class="comment">// Access to memory range 2</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RTC_MODCMD     0x00008000      <span class="comment">// Attempt to execute modified command</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Run trace protocol types.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RTL_ALL        0               <span class="comment">// Log all commands</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RTL_JUMPS      1               <span class="comment">// Taken jmp/call/ret/int + destinations</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RTL_CDEST      2               <span class="comment">// Call destinations only</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RTL_MEM        3               <span class="comment">// Access to memory</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Hit trace outside the code section.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HTNC_RUN       0               <span class="comment">// Continue trace the same way as code</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HTNC_PAUSE     1               <span class="comment">// Pause hit trace if outside the code</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HTNC_TRACE     2               <span class="comment">// Trace command by command (run trace)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// SFX extraction mode.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SFM_RUNTRACE   0               <span class="comment">// Use run trace to extract SFX</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SFM_HITTRACE   1               <span class="comment">// Use hit trace to extract SFX</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_rtcond</span> &#123;</span>              <span class="comment">// Run trace break condition</span></span><br><span class="line">  <span class="comment">// These fields are saved to .udd data directly.</span></span><br><span class="line">  <span class="keyword">int</span>            options;              <span class="comment">// Set of RTC_xxx</span></span><br><span class="line">  ulong          inrange0;             <span class="comment">// Start of in range</span></span><br><span class="line">  ulong          inrange1;             <span class="comment">// End of in range (not included)</span></span><br><span class="line">  ulong          outrange0;            <span class="comment">// Start of out range</span></span><br><span class="line">  ulong          outrange1;            <span class="comment">// End of out range (not included)</span></span><br><span class="line">  ulong          count;                <span class="comment">// Stop count</span></span><br><span class="line">  ulong          currcount;            <span class="comment">// Actual command count</span></span><br><span class="line">  <span class="keyword">int</span>            memaccess[NRANGE];    <span class="comment">// Type of access (0:R, 1:W, 2:R/W)</span></span><br><span class="line">  ulong          memrange0[NRANGE];    <span class="comment">// Start of memory range</span></span><br><span class="line">  ulong          memrange1[NRANGE];    <span class="comment">// End of memory range</span></span><br><span class="line">  <span class="comment">// These fields are saved to .udd data truncated by first null.</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        cond[NCOND][TEXTLEN]; <span class="comment">// Conditions as text</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        cmd[NCMD][TEXTLEN];   <span class="comment">// Matching commands</span></span><br><span class="line">  <span class="comment">// These fields are not saved to .udd data.</span></span><br><span class="line">  uchar          ccomp[NCOND][TEXTLEN];<span class="comment">// Precompiled conditions</span></span><br><span class="line">  <span class="keyword">int</span>            validmodels;          <span class="comment">// Valid command models, RTC_xxx</span></span><br><span class="line">  t_asmmod       model[NCMD][NSEARCHCMD]; <span class="comment">// Command search models</span></span><br><span class="line">  <span class="keyword">int</span>            nmodel[NCMD];         <span class="comment">// Number of slots in each model</span></span><br><span class="line">&#125; t_rtcond;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_rtprot</span> &#123;</span>              <span class="comment">// Run trace protocol condition</span></span><br><span class="line">  <span class="keyword">int</span>            tracelogtype;         <span class="comment">// Commands to protocol, one of RTL_xxx</span></span><br><span class="line">  <span class="keyword">int</span>            memranges;            <span class="comment">// 0x1: range 1, 0x2: range 2 active</span></span><br><span class="line">  <span class="keyword">int</span>            memaccess[NRANGE];    <span class="comment">// Type of access (0:R, 1:W, 2:R/W)</span></span><br><span class="line">  ulong          memrange0[NRANGE];    <span class="comment">// Start of memory range</span></span><br><span class="line">  ulong          memrange1[NRANGE];    <span class="comment">// End of memory range</span></span><br><span class="line">  <span class="keyword">int</span>            rangeactive;          <span class="comment">// Log only commands in the range</span></span><br><span class="line">  t_range        range[NRTPROT];       <span class="comment">// Set of EIP ranges to protocol</span></span><br><span class="line">&#125; t_rtprot;</span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">void</span>)    Suspendallthreads(<span class="keyword">void</span>);</span><br><span class="line">stdapi (<span class="keyword">void</span>)    Resumeallthreads(<span class="keyword">void</span>);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Pauseprocess(<span class="keyword">void</span>);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Closeprocess(<span class="keyword">int</span> confirm);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Detachprocess(<span class="keyword">void</span>);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getlasterror(t_thread *pthr,ulong *error,<span class="keyword">wchar_t</span> *s);</span><br><span class="line">stdapi (ulong)   Followcall(ulong addr);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Run(t_status status,<span class="keyword">int</span> pass);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Checkfordebugevent(<span class="keyword">void</span>);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Addprotocolrange(ulong addr0,ulong addr1);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getruntrace(<span class="keyword">int</span> nback,t_reg *preg,uchar *cmd);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Findruntracerecord(ulong addr0,ulong addr1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//////////////////////////////// LIST OF GUIDS /////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GUIDSIZE       16              <span class="comment">// GUID size, bytes</span></span></span><br><span class="line"></span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getguidname(uchar *data,ulong ndata,<span class="keyword">wchar_t</span> *name);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Isguid(ulong addr,<span class="keyword">wchar_t</span> *name,<span class="keyword">int</span> nname);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">///////////////////////////////// SOURCE CODE //////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_srcline</span> &#123;</span>             <span class="comment">// Descriptor of source line</span></span><br><span class="line">  ulong          offset;               <span class="comment">// Offset in source text</span></span><br><span class="line">  <span class="keyword">int</span>            nextent;              <span class="comment">// Number of code extents (-1: unknown)</span></span><br><span class="line">  <span class="keyword">int</span>            extent;               <span class="comment">// Index of first extent (nextent&gt;0)</span></span><br><span class="line">&#125; t_srcline;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_srcext</span> &#123;</span>              <span class="comment">// Descriptor of code extent</span></span><br><span class="line">  ulong          amin;                 <span class="comment">// Address of the first command</span></span><br><span class="line">  ulong          amax;                 <span class="comment">// Address of last command, included</span></span><br><span class="line">&#125; t_srcext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_source</span> &#123;</span>              <span class="comment">// Descriptor of source file</span></span><br><span class="line">  ulong          addr;                 <span class="comment">// Module base plus file index</span></span><br><span class="line">  ulong          size;                 <span class="comment">// Dummy parameter, must be 1</span></span><br><span class="line">  ulong          type;                 <span class="comment">// Type, TY_xxx+SRC_xxx</span></span><br><span class="line">  <span class="keyword">wchar_t</span>        path[MAXPATH];        <span class="comment">// File path</span></span><br><span class="line">  <span class="keyword">int</span>            nameoffs;             <span class="comment">// Name offset in path, characters</span></span><br><span class="line">  <span class="keyword">char</span>           *text;                <span class="comment">// Source code in UTF-8 format or NULL</span></span><br><span class="line">  t_srcline      *line;                <span class="comment">// nline+1 line descriptors or NULL</span></span><br><span class="line">  <span class="keyword">int</span>            nline;                <span class="comment">// Number of lines (0: as yet unknown)</span></span><br><span class="line">  t_srcext       *extent;              <span class="comment">// List of code extents</span></span><br><span class="line">  <span class="keyword">int</span>            maxextent;            <span class="comment">// Capacity of extent table</span></span><br><span class="line">  <span class="keyword">int</span>            nextent;              <span class="comment">// Current number of extents</span></span><br><span class="line">  <span class="keyword">int</span>            lastline;             <span class="comment">// Last selected line</span></span><br><span class="line">  <span class="keyword">int</span>            lastoffset;           <span class="comment">// Last topmost visible line</span></span><br><span class="line">&#125; t_source;</span><br><span class="line"></span><br><span class="line">stdapi (t_source *) Findsource(ulong base,<span class="keyword">wchar_t</span> *path);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Getsourceline(ulong base,<span class="keyword">wchar_t</span> *path,<span class="keyword">int</span> line,<span class="keyword">int</span> skipspaces,</span><br><span class="line">                   <span class="keyword">wchar_t</span> *text,<span class="keyword">wchar_t</span> *fname,t_srcext **extent,<span class="keyword">int</span> *nextent);</span><br><span class="line">stdapi (<span class="keyword">int</span>)     Showsourcecode(ulong base,<span class="keyword">wchar_t</span> *path,<span class="keyword">int</span> line);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">/////////////////////////////////// DEBUGGEE ///////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Types of exception in application.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AE_NONE        0               <span class="comment">// No exception, or caused by OllyDbg</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AE_APP         1               <span class="comment">// Exception in the application</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> AE_SYS         2               <span class="comment">// System exception, don&#x27;t pass</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">t_run</span> &#123;</span>                 <span class="comment">// Run status of debugged application</span></span><br><span class="line">  t_status       status;               <span class="comment">// Operation mode, one of STAT_xxx</span></span><br><span class="line">  ulong          threadid;             <span class="comment">// ID of single running thread, 0 if all</span></span><br><span class="line">  ulong          tpausing;             <span class="comment">// Tick count when pausing was requested</span></span><br><span class="line">  <span class="keyword">int</span>            wakestep;             <span class="comment">// 0: wait, 1: waked, 2: warned</span></span><br><span class="line">  ulong          eip;                  <span class="comment">// EIP at last debugging event</span></span><br><span class="line">  ulong          ecx;                  <span class="comment">// ECX at last debugging event</span></span><br><span class="line">  ulong          restoreint3addr;      <span class="comment">// Address of temporarily removed INT3</span></span><br><span class="line">  ulong          stepoverdest;         <span class="comment">// Destination of STAT_STEPOVER</span></span><br><span class="line">  <span class="keyword">int</span>            updatebppage;         <span class="comment">// Update temporarily removed bppage&#x27;s</span></span><br><span class="line">  DEBUG_EVENT    de;                   <span class="comment">// Information from WaitForDebugEvent()</span></span><br><span class="line">  <span class="keyword">int</span>            indebugevent;         <span class="comment">// Paused on event, threads suspended</span></span><br><span class="line">  <span class="keyword">int</span>            netevent;             <span class="comment">// Event is from .NET debugger</span></span><br><span class="line">  <span class="keyword">int</span>            isappexception;       <span class="comment">// Exception in application, AE_xxx</span></span><br><span class="line">  ulong          lastexception;        <span class="comment">// Last exception in application or 0</span></span><br><span class="line">  <span class="keyword">int</span>            suspended;            <span class="comment">// Suspension counter</span></span><br><span class="line">  <span class="keyword">int</span>            suspendonpause;       <span class="comment">// Whether first suspension on pause</span></span><br><span class="line">  <span class="keyword">int</span>            updatedebugreg;       <span class="comment">// 1: set, -1: reset HW breakpoints</span></span><br><span class="line">  <span class="keyword">int</span>            dregmodified;         <span class="comment">// Debug regs modified by application</span></span><br><span class="line">&#125; t_run;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//////////// OLLYDBG VARIABLES AND STRUCTURES ACCESSIBLE BY PLUGINS ////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ATTENTION, never, ever change these variables directly! Either use plugin</span></span><br><span class="line"><span class="comment">// API or keep your hands off! Names of variables are preceded with underscore.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">///////////////////////////////// DISASSEMBLER /////////////////////////////////</span></span><br><span class="line"></span><br><span class="line">oddata (t_bincmd) bincmd[];            <span class="comment">// List of 80x86 commands</span></span><br><span class="line"></span><br><span class="line">oddata (<span class="keyword">wchar_t</span> *) regname[<span class="number">3</span>][NREG];   <span class="comment">// Names of 8/16/32-bit registers</span></span><br><span class="line">oddata (<span class="keyword">wchar_t</span> *) segname[NREG];      <span class="comment">// Names of segment registers</span></span><br><span class="line">oddata (<span class="keyword">wchar_t</span> *) fpuname[<span class="number">2</span>][NREG];   <span class="comment">// FPU regs (ST(n) and STn forms)</span></span><br><span class="line">oddata (<span class="keyword">wchar_t</span> *) mmxname[NREG];      <span class="comment">// Names of MMX/3DNow! registers</span></span><br><span class="line">oddata (<span class="keyword">wchar_t</span> *) ssename[NREG];      <span class="comment">// Names of SSE registers</span></span><br><span class="line">oddata (<span class="keyword">wchar_t</span> *) crname[NREG];       <span class="comment">// Names of control registers</span></span><br><span class="line">oddata (<span class="keyword">wchar_t</span> *) drname[NREG];       <span class="comment">// Names of debug registers</span></span><br><span class="line">oddata (<span class="keyword">wchar_t</span> *) sizename[<span class="number">17</span>];       <span class="comment">// Data size keywords</span></span><br><span class="line">oddata (<span class="keyword">wchar_t</span> *) sizekey[<span class="number">17</span>];        <span class="comment">// Keywords for immediate data</span></span><br><span class="line">oddata (<span class="keyword">wchar_t</span> *) sizeatt[<span class="number">17</span>];        <span class="comment">// Keywords for immediate data, AT&amp;T</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/////////////////////////////// OLLYDBG SETTINGS ///////////////////////////////</span></span><br><span class="line"></span><br><span class="line">oddata (<span class="keyword">wchar_t</span>) ollyfile[MAXPATH];    <span class="comment">// Path to OllyDbg</span></span><br><span class="line">oddata (<span class="keyword">wchar_t</span>) ollydir[MAXPATH];     <span class="comment">// OllyDbg directory w/o backslash</span></span><br><span class="line">oddata (<span class="keyword">wchar_t</span>) systemdir[MAXPATH];   <span class="comment">// Windows system directory</span></span><br><span class="line">oddata (<span class="keyword">wchar_t</span>) plugindir[MAXPATH];   <span class="comment">// Plugin data dir without backslash</span></span><br><span class="line"></span><br><span class="line">oddata (HINSTANCE) hollyinst;          <span class="comment">// Current OllyDbg instance</span></span><br><span class="line">oddata (HWND)    hwollymain;           <span class="comment">// Handle of the main OllyDbg window</span></span><br><span class="line">oddata (HWND)    hwclient;             <span class="comment">// Handle of MDI client or NULL</span></span><br><span class="line">oddata (<span class="keyword">wchar_t</span>) ottable[SHORTNAME];   <span class="comment">// Class of table windows</span></span><br><span class="line">oddata (ulong)   cpufeatures;          <span class="comment">// CPUID feature information</span></span><br><span class="line">oddata (<span class="keyword">int</span>)     ischild;              <span class="comment">// Whether child debugger</span></span><br><span class="line"></span><br><span class="line">oddata (<span class="keyword">int</span>)     asciicodepage;        <span class="comment">// Code page to display ASCII dumps</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> FILE                            <span class="comment">// Requires &lt;stdio.h&gt;</span></span></span><br><span class="line">oddata (FILE *)  tracefile;            <span class="comment">// System log file or NULL</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">oddata (<span class="keyword">int</span>)     restorewinpos;        <span class="comment">// Restore window position &amp; appearance</span></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////// OLLYDBG STRUCTURES //////////////////////////////</span></span><br><span class="line"></span><br><span class="line">oddata (t_font)  font[NFIXFONTS];      <span class="comment">// Fixed fonts used in table windows</span></span><br><span class="line">oddata (t_font)  sysfont;              <span class="comment">// Proportional system font</span></span><br><span class="line">oddata (t_font)  titlefont;            <span class="comment">// Proportional, 2x height of sysfont</span></span><br><span class="line">oddata (t_font)  fixfont;              <span class="comment">// Fixed system font</span></span><br><span class="line">oddata (COLORREF) color[NCOLORS];      <span class="comment">// Colours used by OllyDbg</span></span><br><span class="line">oddata (t_scheme) scheme[NSCHEMES];    <span class="comment">// Colour schemes used in table windows</span></span><br><span class="line">oddata (t_scheme) hilite[NHILITE];     <span class="comment">// Colour schemes used for highlighting</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/////////////////////////////////// DEBUGGEE ///////////////////////////////////</span></span><br><span class="line"></span><br><span class="line">oddata (<span class="keyword">wchar_t</span>) executable[MAXPATH];  <span class="comment">// Path to main (.exe) file</span></span><br><span class="line">oddata (<span class="keyword">wchar_t</span>) arguments[ARGLEN];    <span class="comment">// Command line passed to debuggee</span></span><br><span class="line"></span><br><span class="line">oddata (<span class="keyword">int</span>)     netdbg;               <span class="comment">// .NET debugging active</span></span><br><span class="line">oddata (<span class="keyword">int</span>)     rundll;               <span class="comment">// Debugged file is a DLL</span></span><br><span class="line">oddata (HANDLE)  process;              <span class="comment">// Handle of Debuggee or NULL</span></span><br><span class="line">oddata (ulong)   processid;            <span class="comment">// Process ID of Debuggee or 0</span></span><br><span class="line">oddata (ulong)   mainthreadid;         <span class="comment">// Thread ID of main thread or 0</span></span><br><span class="line">oddata (t_run)   run;                  <span class="comment">// Run status of debugged application</span></span><br><span class="line">oddata (<span class="keyword">int</span>)     skipsystembp;         <span class="comment">// First system INT3 not yet hit</span></span><br><span class="line"></span><br><span class="line">oddata (ulong)   debugbreak;           <span class="comment">// Address of DebugBreak() in Debuggee</span></span><br><span class="line">oddata (ulong)   dbgbreakpoint;        <span class="comment">// Address of DbgBreakPoint() in Debuggee</span></span><br><span class="line">oddata (ulong)   kiuserexcept;         <span class="comment">// Address of KiUserExceptionDispatcher()</span></span><br><span class="line">oddata (ulong)   zwcontinue;           <span class="comment">// Address of ZwContinue() in Debuggee</span></span><br><span class="line">oddata (ulong)   uefilter;             <span class="comment">// Address of UnhandledExceptionFilter()</span></span><br><span class="line">oddata (ulong)   ntqueryinfo;          <span class="comment">// Address of NtQueryInformationProcess()</span></span><br><span class="line">oddata (ulong)   corexemain;           <span class="comment">// Address of MSCOREE:_CorExeMain()</span></span><br><span class="line">oddata (ulong)   peblock;              <span class="comment">// Address of PE block in Debuggee</span></span><br><span class="line">oddata (ulong)   kusershareddata;      <span class="comment">// Address of KUSER_SHARED_DATA</span></span><br><span class="line">oddata (ulong)   userspacelimit;       <span class="comment">// Size of virtual process memory</span></span><br><span class="line"></span><br><span class="line">oddata (t_rtcond) rtcond;              <span class="comment">// Run trace break condition</span></span><br><span class="line">oddata (t_rtprot) rtprot;              <span class="comment">// Run trace protocol condition</span></span><br><span class="line"></span><br><span class="line"><span class="comment">///////////////////////////////// DATA TABLES //////////////////////////////////</span></span><br><span class="line"></span><br><span class="line">oddata (t_table) <span class="built_in">list</span>;                 <span class="comment">// List descriptor</span></span><br><span class="line">oddata (t_sorted) premod;              <span class="comment">// Preliminary module data</span></span><br><span class="line">oddata (t_table) <span class="keyword">module</span>;               <span class="comment">// Loaded modules</span></span><br><span class="line">oddata (t_sorted) aqueue;              <span class="comment">// Modules that are not yet analysed</span></span><br><span class="line">oddata (t_table) thread;               <span class="comment">// Active threads</span></span><br><span class="line">oddata (t_table) memory;               <span class="comment">// Allocated memory blocks</span></span><br><span class="line">oddata (t_table) win;                  <span class="comment">// List of windows</span></span><br><span class="line">oddata (t_table) bpoint;               <span class="comment">// INT3 breakpoints</span></span><br><span class="line">oddata (t_table) bpmem;                <span class="comment">// Memory breakpoints</span></span><br><span class="line">oddata (t_sorted) bppage;              <span class="comment">// Memory pages with changed attributes</span></span><br><span class="line">oddata (t_table) bphard;               <span class="comment">// Hardware breakpoints</span></span><br><span class="line">oddata (t_table) watch;                <span class="comment">// Watch expressions</span></span><br><span class="line">oddata (t_table) patch;                <span class="comment">// List of patches from previous runs</span></span><br><span class="line">oddata (t_sorted) procdata;            <span class="comment">// Descriptions of analyzed procedures</span></span><br><span class="line">oddata (t_table) source;               <span class="comment">// List of source files</span></span><br><span class="line">oddata (t_table) srccode;              <span class="comment">// Source code</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//////////////////////////////// PLUGIN EXPORTS ////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Relatively infrequent events passed to ODBG2_Pluginnotify().</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PN_NEWPROC     1               <span class="comment">// New process is created</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PN_ENDPROC     2               <span class="comment">// Process is terminated</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PN_NEWTHR      3               <span class="comment">// New thread is created</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PN_ENDTHR      4               <span class="comment">// Thread is terminated</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PN_PREMOD      5               <span class="comment">// New module is reported by Windows</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PN_NEWMOD      6               <span class="comment">// New module is added to the table</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PN_ENDMOD      7               <span class="comment">// Module is removed from the memory</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PN_STATUS      8               <span class="comment">// Execution status has changed</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PN_REMOVE      16              <span class="comment">// OllyDbg removes analysis from range</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PN_RUN         24              <span class="comment">// User continues code execution</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Flags returned by ODBG2_Pluginexception().</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PE_IGNORED     0x00000000      <span class="comment">// Plugin does not process exception</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PE_CONTINUE    0x00000001      <span class="comment">// Exception by plugin, continue</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PE_STEP        0x00000002      <span class="comment">// Exception by plugin, execute command</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PE_PAUSE       0x00000004      <span class="comment">// Exception by plugin, pause program</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////////////////// OD导出函数原型 ///////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment">* \brief ODBG2_Pluginquery [OD插件必选导出函数]</span></span><br><span class="line"><span class="comment">* 用于让OD加载插件时识别插件的名字.版本号等信息.在此导出函数中可判断插件所需要的API版本，如果不能满足则卸载此插件</span></span><br><span class="line"><span class="comment">* \param int ollydbgversion	OD调用该函数时传入的OD的版本号.</span></span><br><span class="line"><span class="comment">* \param ulong * features 略</span></span><br><span class="line"><span class="comment">* \param wchar_t pluginname[SHORTNAME] 输出给OD的本插件的名字.</span></span><br><span class="line"><span class="comment">* \param wchar_t pluginversion[SHORTNAME] 输出给OD的本插件的版本号(版本号随意)</span></span><br><span class="line"><span class="comment">* \retutn 返回所需要的API的版本,一般就是OD的版本,如:PLUGIN_VERSION</span></span><br><span class="line"><span class="comment">* \sa ODBG2_Plugininit(),ODBG2_Pluginclose(),ODBG2_Pluginreset(),ODBG2_Plugindestroy()</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">pentry (<span class="keyword">int</span>)         ODBG2_Pluginquery(<span class="keyword">int</span> ollydbgversion,ulong *features,</span><br><span class="line">                       <span class="keyword">wchar_t</span> pluginname[SHORTNAME],</span><br><span class="line">                       <span class="keyword">wchar_t</span> pluginversion[SHORTNAME]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment">* \brief ODBG2_Plugininit [OD插件可选导出函数] </span></span><br><span class="line"><span class="comment">* 插件加载完毕后,OD会调用该函数,以让插件来初始化自身,当插件通过版本检测后准备加载时，OllyDBG会调用此函数.</span></span><br><span class="line"><span class="comment">* 在这个函数中,可以完成创建窗口等初始化工作.</span></span><br><span class="line"><span class="comment">* \sa ODBG2_Pluginquery(),ODBG2_Pluginclose(),ODBG2_Pluginreset(),ODBG2_Plugindestroy()</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">pentry (<span class="keyword">int</span>)         ODBG2_Plugininit(<span class="keyword">void</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment">* \brief ODBG2_Pluginreset [OD插件可选导出函数]</span></span><br><span class="line"><span class="comment">* 当重新加载程序或打开新程序时，OllyDBG会调用此函数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">pentry( <span class="keyword">void</span> )        ODBG2_Pluginreset( <span class="keyword">void</span> );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment">* \brief ODBG2_Pluginclose [OD插件可选导出函数]</span></span><br><span class="line"><span class="comment">* 当用户关闭调试时，OllyDBG在关闭前会调用此函数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">pentry( <span class="keyword">int</span> )         ODBG2_Pluginclose( <span class="keyword">void</span> );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment">* \brief ODBG2_Plugindestroy [OD插件可选导出函数]</span></span><br><span class="line"><span class="comment">* 当OllyDBG将要终止时，它会在退出前调用一次此函数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">pentry( <span class="keyword">void</span> )       ODBG2_Plugindestroy( <span class="keyword">void</span> );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment">* \brief ODBG2_Pluginanalyse [OD插件可选导出函数] </span></span><br><span class="line"><span class="comment">*分析模块时，在分析结束后OllyDBG会调用此函数，给插件以机会使之能做一些额外的分析操作</span></span><br><span class="line"><span class="comment">* \param t_module * pmod 分析完成的模块的信息</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">pentry (<span class="keyword">void</span>)        ODBG2_Pluginanalyse(t_module *pmod);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment">* \brief ODBG2_Pluginmainloop [OD可选导出函数]</span></span><br><span class="line"><span class="comment">* 有调试事件时,就会调用此函数</span></span><br><span class="line"><span class="comment">* \param DEBUG_EVENT * debugevent 正在发生的调试事件.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">pentry( <span class="keyword">void</span> )        ODBG2_Pluginmainloop( DEBUG_EVENT *debugevent );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment">* \brief ODBG2_Pluginexception [OD插件可选导出函数]</span></span><br><span class="line"><span class="comment">* 产生EXCEPTION_DEBUG_EVENT(异常事件)时就调用此函数.</span></span><br><span class="line"><span class="comment">* \param t_run * prun 运行时的一些信息</span></span><br><span class="line"><span class="comment">* \param const t_disasm * da 反汇编信息</span></span><br><span class="line"><span class="comment">* \param t_thread * pthr 产生异常事件的线程的信息</span></span><br><span class="line"><span class="comment">* \param t_reg * preg 寄存器信息</span></span><br><span class="line"><span class="comment">* \param wchar_t * message </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">pentry( <span class="keyword">int</span> )         ODBG2_Pluginexception( t_run *prun , <span class="keyword">const</span> t_disasm *da ,</span><br><span class="line">                       t_thread *pthr,t_reg *preg,<span class="keyword">wchar_t</span> *message);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment">* \brief ODBG2_Plugintempbreakpoint [OD插件可选导出函数]</span></span><br><span class="line"><span class="comment">* 插件请求设置的临时断点事件会调用此函数</span></span><br><span class="line"><span class="comment">* \param ulong addr 断点地址</span></span><br><span class="line"><span class="comment">* \param const t_disasm * da 反汇编信息</span></span><br><span class="line"><span class="comment">* \param t_thread * pthr 线程信息</span></span><br><span class="line"><span class="comment">* \param t_reg * preg 寄存器信息</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">pentry( <span class="keyword">void</span> )        ODBG2_Plugintempbreakpoint( ulong addr ,</span><br><span class="line">                       <span class="keyword">const</span> t_disasm *da,t_thread *pthr,t_reg *preg);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment">* \brief ODBG2_Pluginnotify [OD插件可选导出函数]</span></span><br><span class="line"><span class="comment">* 一些其他的重要事件发生时，OllyDBG会调用此函数</span></span><br><span class="line"><span class="comment">* \param int code 事件代码, 使用PN_xxx系列宏来表示:</span></span><br><span class="line"><span class="comment">* +----------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* | code		 | data			| parm1		 | parm2	 | 注释</span></span><br><span class="line"><span class="comment">* +--------------+--------------+------------+-----------+---------------------------------</span></span><br><span class="line"><span class="comment">* | PN_NEWPROC   | NULL			| Process ID | 0		 | OllyDbg starts new process. This notification is sent while processing CREATE_PROCESS_DEBUG_EVENT</span></span><br><span class="line"><span class="comment">* | PN_ENDPROC   | NULL			| Process ID | Exit code | Debugged process terminated but is still in the memory. This notification is sent while processing EXIT_PROCESS_DEBUG_EVENT</span></span><br><span class="line"><span class="comment">* | PN_NEWTHR	 | t_thread *	| Thread ID	 | 0		 | New thread is created and about to start. This notification is sent while processing CREATE_PROCESS_DEBUG_EVENT (main thread) or CREATE_THREAD_DEBUG_EVENT before thread begins to execute in user mode. Note that thread may be temporary (created by Windows to pause debugged application). Such threads have t_thread.ordinal set to 0</span></span><br><span class="line"><span class="comment">* | PN_ENDTHR	 | t_thread *	| Thread ID	 | Exit code | Thread terminated, but related data is still in the OllyDbg tables. This notification is never sent for the last thread that remains active when process terminates (PN_ENDPROC)</span></span><br><span class="line"><span class="comment">* | PN_PREMOD	 | t_premod *	| 0			 | 0		 | New module is reported by Windows (CREATE_PROCESS_DEBUG_EVENT, LOAD_DLL_DEBUG_EVENT), reported by .NET debugging API, or hidden module is detected by OllyDbg. Module may still be missing in the memory and OllyDbg may be unable to restore breakpoints or analyse code. Therefore it adds it to the table of preliminary modules (premod) and if necessary, sets single-step trap and postpones module processing till the next debug event. Most probably, notification PN_NEWMOD will follow</span></span><br><span class="line"><span class="comment">* | PN_NEWMOD	 | t_module *	| 0			 | 0		 | Module is already in the memory and OllyDbg has attempted to restore .udd data. (If module is self-extractable, restoration may be postponed till module is extracted). PN_NEWMOD may be missing if DLL fails to initialize</span></span><br><span class="line"><span class="comment">* | PN_ENDMOD	 | t_module *	| 0			 | 0		 | Module is removed from the memory or is about to be removed. Plugin receives this notification when module-related data is saved to the .udd file but is not yet removed from the OllyDbg tables. PN_ENDMOD may be missing if DLL fails to initialize</span></span><br><span class="line"><span class="comment">* | PN_STATUS	 | NULL	     	| Status	 | 0		 | Debuggee&#x27;s execution status has changed. parm1 contains new status (enumeration of type t_status). This notification comes when debugging engine is in the stable state and plugins are allowed to use all available API functions</span></span><br><span class="line"><span class="comment">* | PN_RUN	     | t_status *	| Pass flag	 | 0		 | User requests to continue execution. data points to the requested status (for example, STAT_RUNNING if all threads should run at full speed). Plugin can change this value. parm1 is the same as the parameter pass in the call to Run()</span></span><br><span class="line"><span class="comment">* | PN_REMOVE	 | NULL			| Address    | Size	     |OllyDbg removes analysis data from the memory range parm1 .. parm1+parm2 (the last byte is not included). This notification is sent, for example, when user modifies memory contents or starts new analysis, but not when module or memory block is removed from the memory</span></span><br><span class="line"><span class="comment">* +----------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* \param void * data 附加数据</span></span><br><span class="line"><span class="comment">* \param ulong parm1 附加参数1</span></span><br><span class="line"><span class="comment">* \param ulong parm2 附加参数2</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">pentry( <span class="keyword">void</span> )        ODBG2_Pluginnotify( <span class="keyword">int</span> code , <span class="keyword">void</span> *data ,</span><br><span class="line">                       ulong parm1,ulong parm2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment">* \brief ODBG2_Plugindump [OD插件可选导出函数]</span></span><br><span class="line"><span class="comment">* 当OllyDBG重绘其他转储窗口时会调用此函数，插件可以借此机会修改这些窗口的字体或外观</span></span><br><span class="line"><span class="comment">* \param t_dump * pd</span></span><br><span class="line"><span class="comment">* \param wchar_t * s</span></span><br><span class="line"><span class="comment">* \param uchar * mask</span></span><br><span class="line"><span class="comment">* \param int n</span></span><br><span class="line"><span class="comment">* \param int * select</span></span><br><span class="line"><span class="comment">* \param ulong addr</span></span><br><span class="line"><span class="comment">* \param int column</span></span><br><span class="line"><span class="comment">* \retutn</span></span><br><span class="line"><span class="comment">* \sa</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">pentry( <span class="keyword">int</span> )         ODBG2_Plugindump( t_dump *pd , <span class="keyword">wchar_t</span> *s , uchar *mask ,</span><br><span class="line">                       <span class="keyword">int</span> n,<span class="keyword">int</span> *select,ulong addr,<span class="keyword">int</span> column);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment">* \brief ODBG2_Pluginmenu [OD插件可选导出函数]</span></span><br><span class="line"><span class="comment">* 点击窗口主菜单或点击右键以期望弹出菜单时，OllyDBG将调用此函数，并将函数返回的数据添加到将要弹出的菜单中</span></span><br><span class="line"><span class="comment">* \param wchar_t * type 准备弹出菜单的窗口的名字,以PWM_xxx系列宏来表示</span></span><br><span class="line"><span class="comment">* \return 返回需要添加的菜单结构体数组, 数组必须以一个全0的元素为结尾.</span></span><br><span class="line"><span class="comment">* PWM_ATTACH -进程附加区</span></span><br><span class="line"><span class="comment">* PWM_BPHARD - 硬件断点区</span></span><br><span class="line"><span class="comment">* PWM_BPMEM - 内存断点区</span></span><br><span class="line"><span class="comment">* PWM_BPOINT - INT3 断点区</span></span><br><span class="line"><span class="comment">* PWM_DISASM - 反汇编窗口</span></span><br><span class="line"><span class="comment">* PWM_DUMP - 所有的dump区(除了反汇编去和栈区)</span></span><br><span class="line"><span class="comment">* PWM_INFO - 寄存器信息菜单</span></span><br><span class="line"><span class="comment">* PWM_LOG - 日志窗口</span></span><br><span class="line"><span class="comment">* PWM_MAIN - 主菜单</span></span><br><span class="line"><span class="comment">* PWM_MEMORY - 内存窗口</span></span><br><span class="line"><span class="comment">* PWM_MODULES - 模块窗口</span></span><br><span class="line"><span class="comment">* PWM_NAMELIST - 标签列表窗口</span></span><br><span class="line"><span class="comment">* PWM_PATCHES - 补丁列表窗口</span></span><br><span class="line"><span class="comment">* PWM_PROFILE - Profile window</span></span><br><span class="line"><span class="comment">* PWM_REGISTERS - 寄存器窗口</span></span><br><span class="line"><span class="comment">* PWM_SEARCH - 搜索控件</span></span><br><span class="line"><span class="comment">* PWM_SOURCE - 源代码窗口</span></span><br><span class="line"><span class="comment">* PWM_SRCLIST - 源代码列表窗口</span></span><br><span class="line"><span class="comment">* PWM_STACK - CPU栈信息面板</span></span><br><span class="line"><span class="comment">* PWM_THREADS - 线程窗口</span></span><br><span class="line"><span class="comment">* PWM_TRACE - Run跟踪窗口</span></span><br><span class="line"><span class="comment">* PWM_WATCH - 监视窗口</span></span><br><span class="line"><span class="comment">* PWM_WINDOWS - list of windows owned by the debugged application</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">pentry( t_menu * )    ODBG2_Pluginmenu( <span class="keyword">wchar_t</span> *type );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment">* \brief ODBG2_Pluginoptions [OD插件可选导出函数]</span></span><br><span class="line"><span class="comment">打开插件对话框时，OllyDBG调用此函数，并派发消息</span></span><br><span class="line"><span class="comment">* \param UINT msg 发送的消息</span></span><br><span class="line"><span class="comment">* \param WPARAM wp 附加参数1</span></span><br><span class="line"><span class="comment">* \param LPARAM lp附加参数2</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">pentry( t_control * ) ODBG2_Pluginoptions( UINT msg , WPARAM wp , LPARAM lp );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment">* \brief ODBG2_Pluginsaveudd [OD插件可选导出函数]</span></span><br><span class="line"><span class="comment">* 当Windows从内存中卸载模块时，OllyDBG会调用此函数，以便插件能将相关数据保存到UDD文件中</span></span><br><span class="line"><span class="comment">* \param t_uddsave * psave UDD文件信息</span></span><br><span class="line"><span class="comment">* \param t_module * pmod 被卸载的模块的信息</span></span><br><span class="line"><span class="comment">* \param int ismainmodule</span></span><br><span class="line"><span class="comment">* \retutn</span></span><br><span class="line"><span class="comment">* \sa</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">pentry( <span class="keyword">void</span> )        ODBG2_Pluginsaveudd( t_uddsave *psave , t_module *pmod ,</span><br><span class="line">                       <span class="keyword">int</span> ismainmodule);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment">* \brief ODBG2_Pluginuddrecord [OD插件可选导出函数]</span></span><br><span class="line"><span class="comment">* 当加载UDD文件或遇到插件预先保存的数据，OllyDBG会针对每条记录分别调用此函数</span></span><br><span class="line"><span class="comment">* \param t_module * pmod 模块你信息</span></span><br><span class="line"><span class="comment">* \param int ismainmodule 是否是主模块</span></span><br><span class="line"><span class="comment">* \param ulong tag </span></span><br><span class="line"><span class="comment">* \param ulong size</span></span><br><span class="line"><span class="comment">* \param void * data</span></span><br><span class="line"><span class="comment">* \retutn</span></span><br><span class="line"><span class="comment">* \sa</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">pentry( <span class="keyword">void</span> )        ODBG2_Pluginuddrecord( t_module *pmod , <span class="keyword">int</span> ismainmodule ,</span><br><span class="line">                       ulong tag,ulong size,<span class="keyword">void</span> *data);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span>                                 <span class="comment">// __ODBG_PLUGIN_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="cpp文件"><a href="#cpp文件" class="headerlink" title=".cpp文件"></a>.cpp文件</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;od_plugin.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">&quot;ollydbg.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;resource.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;winternl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib,<span class="meta-string">&quot;ntdll.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PLUGINNAME <span class="meta-string">L&quot;Hello,world&quot;</span>   <span class="comment">// 插件名称</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MY_VERSION <span class="meta-string">L&quot;0.00.01&quot;</span>       <span class="comment">// 插件版本</span></span></span><br><span class="line">t_table   g_stcHelloWorld = &#123; <span class="number">0</span> &#125;;  <span class="comment">// 菜单栏</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义全局变量</span></span><br><span class="line">HMODULE g_hModule = <span class="literal">NULL</span>;</span><br><span class="line">HWND g_hwnd; </span><br><span class="line">DWORD g_pid = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 菜单响应事件</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">MenuFun</span><span class="params">(t_table* pt, <span class="keyword">wchar_t</span>* name, ulong index, <span class="keyword">int</span> mode)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (mode == MENU_VERIFY)    <span class="comment">// 第一次调用（一般执行初始化操作）</span></span><br><span class="line">        <span class="keyword">return</span> MENU_NORMAL;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mode == MENU_EXECUTE) <span class="comment">// 第二次调用（一般执行菜单逻辑操作）</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 我们要处理菜单点击事件</span></span><br><span class="line">        ShowWindow(g_hwnd, SW_SHOW);</span><br><span class="line">       <span class="comment">// MessageBox(0, 0, 0, 0);</span></span><br><span class="line">    &#125;</span><br><span class="line">        <span class="keyword">return</span> MENU_NOREDRAW;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> MENU_ABSENT;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置主菜单数组 ,菜单以0结尾</span></span><br><span class="line"><span class="keyword">static</span> t_menu g_stcMainMenu[] = &#123;</span><br><span class="line">        &#123; <span class="string">L&quot;主菜单测试1&quot;</span>,</span><br><span class="line">        <span class="string">L&quot;提示：……1。&quot;</span>,</span><br><span class="line">        K_NONE, MenuFun, <span class="literal">NULL</span>, <span class="number">0</span> &#125;,</span><br><span class="line">        &#123; <span class="literal">NULL</span>, <span class="literal">NULL</span>, K_NONE, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="number">0</span> &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 设置右键单数组</span></span><br><span class="line"><span class="keyword">static</span> t_menu g_stcDISASMMenu[] = &#123;</span><br><span class="line">        &#123; <span class="string">L&quot;右键菜单测试&quot;</span>,</span><br><span class="line">        <span class="string">L&quot;提示：……1。&quot;</span>,</span><br><span class="line">        KK_DIRECT | KK_CTRL | <span class="string">&#x27;A&#x27;</span>, MenuFun, <span class="literal">NULL</span>, <span class="number">0</span> &#125;,</span><br><span class="line">        &#123; <span class="string">L&quot;右键菜单测试&quot;</span>,</span><br><span class="line">        <span class="string">L&quot;提示：……2。&quot;</span>,</span><br><span class="line">        KK_DIRECT | KK_CTRL | <span class="string">&#x27;1&#x27;</span>, MenuFun, <span class="literal">NULL</span>, <span class="number">1</span> &#125;,</span><br><span class="line">        &#123; <span class="literal">NULL</span>, <span class="literal">NULL</span>, K_NONE, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="number">0</span> &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当响应菜单事件是调用</span></span><br><span class="line"><span class="function">extc t_menu* __cdecl <span class="title">ODBG2_Pluginmenu</span><span class="params">(<span class="keyword">wchar_t</span>* type)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 1. 判断是否为主菜单弹出请求，是则弹出主菜单</span></span><br><span class="line">    <span class="keyword">if</span> (!wcscmp(type, PWM_MAIN))</span><br><span class="line">        <span class="keyword">return</span> g_stcMainMenu;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. 判断是否为CPU窗口右键菜单弹出请求，是则弹出右键菜单</span></span><br><span class="line">    <span class="keyword">if</span> (!wcscmp(type, PWM_DISASM))</span><br><span class="line">        <span class="keyword">return</span> g_stcDISASMMenu;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. 返回空</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 通知消息</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ODBG2_Pluginnotify</span><span class="params">(<span class="keyword">int</span> code, <span class="keyword">void</span>* data, ulong parm1, ulong parm2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//处理进程创建时消息</span></span><br><span class="line">    <span class="keyword">if</span> (code == PN_NEWPROC)</span><br><span class="line">        g_pid = parm1;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**********************************************************/</span></span><br><span class="line"><span class="comment">/* 函数名：插件信息查询函数【回调函数】</span></span><br><span class="line"><span class="comment">/* 说  明：    此函数是必须存在的函数，也是OllyDBG第1个调用的函数。此函数负</span></span><br><span class="line"><span class="comment">/*         责检查当前的OllyDBG版本是否可以运行此插件，如果不能运行则需要返</span></span><br><span class="line"><span class="comment">/*         回0 。</span></span><br><span class="line"><span class="comment">/* 参  数：</span></span><br><span class="line"><span class="comment">/*   int           ollydbgversion                       : [ IN] OllyDBG的版本</span></span><br><span class="line"><span class="comment">/*   ulong      *features                                : [ IN] 包含一些额外的版本相关信息</span></span><br><span class="line"><span class="comment">/*   wchar_t  pluginname[SHORTNAME]    : [OUT] 插件名称</span></span><br><span class="line"><span class="comment">/*   wchar_t  pluginversion[SHORTNAME] : [OUT] 插件版本</span></span><br><span class="line"><span class="comment">/* 返回值：</span></span><br><span class="line"><span class="comment">/*   int : 返回所需要的API版本，如不匹配则返回0</span></span><br><span class="line"><span class="comment">/**********************************************************/</span></span><br><span class="line"><span class="function">extc <span class="keyword">int</span> __cdecl <span class="title">ODBG2_Pluginquery</span><span class="params">(<span class="keyword">int</span> ollydbgversion, ulong* features,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">wchar_t</span> pluginname[SHORTNAME], <span class="keyword">wchar_t</span> pluginversion[SHORTNAME])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 1. 检查OllyDBG的兼容版本</span></span><br><span class="line">    <span class="comment">/*if (ollydbgversion &lt; 201)</span></span><br><span class="line"><span class="comment">        return 0;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. 设置OllyDBG插件的名称与版本</span></span><br><span class="line">    wcscpy_s(pluginname, SHORTNAME, PLUGINNAME); <span class="comment">// 设置插件名称</span></span><br><span class="line">    wcscpy_s(pluginversion, SHORTNAME, MY_VERSION); <span class="comment">// 设置插件版本</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. 返回需要的API版本</span></span><br><span class="line">    <span class="keyword">return</span> PLUGIN_VERSION;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 窗口回调函数</span></span><br><span class="line"><span class="function">INT_PTR CALLBACK  <span class="title">WndProc</span><span class="params">(HWND hwnd, UINT msg, WPARAM wparam, LPARAM lparma)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (msg == WM_COMMAND)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 点击反调试</span></span><br><span class="line">        <span class="keyword">if</span> (LOWORD(wparam) == IDOK)</span><br><span class="line">        &#123;</span><br><span class="line">         </span><br><span class="line">            <span class="comment">// 反调试插件</span></span><br><span class="line">            <span class="comment">// 打开目标进程</span></span><br><span class="line">           HANDLE hprocess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, g_pid);</span><br><span class="line">            <span class="comment">// 获取目标PEB地址</span></span><br><span class="line">            PROCESS_BASIC_INFORMATION  stcProcInfo;</span><br><span class="line">            DWORD dwSize;</span><br><span class="line">            NtQueryInformationProcess(</span><br><span class="line">                hprocess,</span><br><span class="line">                ProcessBasicInformation, <span class="comment">// 进程基本信息</span></span><br><span class="line">                &amp;stcProcInfo,</span><br><span class="line">                <span class="keyword">sizeof</span>(stcProcInfo),</span><br><span class="line">                <span class="literal">NULL</span>);</span><br><span class="line">           </span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将目标PEB.BeginDebugged写入0</span></span><br><span class="line">            WriteProcessMemory(</span><br><span class="line">                hprocess,                           <span class="comment">// 目标进程</span></span><br><span class="line">                (LPVOID)((DWORD)(stcProcInfo.PebBaseAddress) + <span class="number">0x2</span>),   <span class="comment">//PEB-&gt;BeginDebugged</span></span><br><span class="line">                <span class="string">&quot;\0&quot;</span>,                               <span class="comment">// 写入数据0</span></span><br><span class="line">                <span class="number">1</span>,</span><br><span class="line">                &amp;dwSize         </span><br><span class="line">            );</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 关闭句柄</span></span><br><span class="line">            CloseHandle(hprocess);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (msg == WM_CLOSE)</span><br><span class="line">    &#123;</span><br><span class="line">        ShowWindow(g_hwnd, SW_HIDE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> FALSE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数名：插件初始化函数【回调函数】</span></span><br><span class="line"><span class="comment">// 说   明：此函数是可选函数，也是OllyDBG第2个调用的函数。负责初始化插件的初始资源。</span></span><br><span class="line"><span class="comment">// 返回值：</span></span><br><span class="line"><span class="comment">//   int : 成功返回0，失败返回-1</span></span><br><span class="line"><span class="function">extc <span class="keyword">int</span> __cdecl <span class="title">ODBG2_Plugininit</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 创建对话框，但是不显示</span></span><br><span class="line">    HWND    hParent = GetActiveWindow();</span><br><span class="line">    LPCTSTR lpDlgID = MAKEINTRESOURCE(IDD_DIALOG1);</span><br><span class="line">    g_hwnd =  CreateDialog(g_hModule, lpDlgID, hParent, (DLGPROC)WndProc);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 函数名：插件重置函数【回调函数】</span></span><br><span class="line"><span class="comment">// 说   明：    此函数是可选函数，当O重新加载程序或打开新的程序时，这个函数将会被调用。</span></span><br><span class="line"><span class="function">extc <span class="keyword">void</span> __cdecl <span class="title">ODBG2_Pluginreset</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">Deletesorteddatarange(&amp;(g_stcHelloWorld.sorted), <span class="number">0</span>, <span class="number">0xFFFFFFFF</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 函数名：插件关闭函数【回调函数】</span></span><br><span class="line"><span class="comment">// 说   明：   此函数是可选函数，当用户关闭OllyDBG时，OllyDBG会调用这个函数。</span></span><br><span class="line"><span class="function">extc <span class="keyword">int</span> __cdecl <span class="title">ODBG2_Pluginclose</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    Writetoini(<span class="literal">NULL</span>, PLUGINNAME, <span class="string">L&quot;Restore&quot;</span>, <span class="string">L&quot;%i&quot;</span>, g_stcHelloWorld.hw != <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 函数名：插件销毁函数【回调函数】</span></span><br><span class="line"><span class="comment">// 说   明：    此函数是可选函数，当用户关闭OllyDBG时，OllyDBG会在退出前调用此函数</span></span><br><span class="line"><span class="comment">//           一次，此时由插件创建的所有MDI窗口都已经销毁（并获得WM_DESTROY消息）。</span></span><br><span class="line"><span class="function">extc <span class="keyword">void</span> __cdecl <span class="title">ODBG2_Plugindestroy</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">    Destroysorteddata(&amp;(g_stcHelloWorld.sorted));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// dll加载时调用</span></span><br><span class="line"><span class="function">BOOL WINAPI <span class="title">DllMain</span><span class="params">(HMODULE mod, DWORD type, PVOID)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// dll加载基址</span></span><br><span class="line">    g_hModule = mod;</span><br><span class="line">    <span class="keyword">return</span> TRUE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">胡先森</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2020/12/09/%E5%8F%8D%E8%B0%83%E8%AF%95%E4%B8%8E%E5%8F%8D%E5%8F%8D%E8%B0%83%E8%AF%95/">http://yoursite.com/2020/12/09/%E5%8F%8D%E8%B0%83%E8%AF%95%E4%B8%8E%E5%8F%8D%E5%8F%8D%E8%B0%83%E8%AF%95/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com" target="_blank">Mr.Hu</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/">反调试</a></div><div class="post_share"><div class="social-share" data-image="/img/Debug2.01.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" data-lazy-src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" data-lazy-src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/12/17/%E9%80%86%E5%90%91%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80/"><img class="prev-cover" data-lazy-src="/img/17.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">逆向开发————基础</div></div></a></div><div class="next-post pull-right"><a href="/2020/12/08/%E8%B0%83%E8%AF%95%E4%B8%8E%E5%BC%82%E5%B8%B8/"><img class="next-cover" data-lazy-src="/img/WindowsError.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">调试与异常</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer" style="background-image: url(/img/Debug2.01.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 胡先森</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    $.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js', function () {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script><script>function loadValine () {
  function initValine () {
    window.valine = new Valine({
      el: '#vcomment',
      appId: 'Eo4Vh3u0nKU2EUIpOMidpb6L-gzGzoHsz',
      appKey: 'RIFmwqkX4dT5EpJghF6o6DWE',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: 'https://eo4vh3u0.lc-cn-n1-shared.com',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    });
    if ('nick,mail') { valine.config.requiredFields= 'nick,mail'.split(',') }
  }

  if (typeof Valine === 'function') initValine() 
  else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(() => loadValine(), 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><style type="text/css">#toggle-sidebar {bottom: 80px}</style><div class="aplayer no-destroy" data-id="7322622901" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
document.body.addEventListener('input', POWERMODE);
</script><script src="/js/third-party/ClickShowText.js" async="async"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script></div></body></html><!-- 雪花特效 -->
<script type="text/javascript" src="\js\snow.js"></script>